var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,i,n)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n,r=(e,t)=>{for(var i in t||(t={}))a.call(t,i)&&s(e,i,t[i]);if(n)for(var i of n(t))o.call(t,i)&&s(e,i,t[i]);return e},d=(e,n)=>t(e,i(n));export function __vite_legacy_guard(){import("data:text/javascript,")}import"./modulepreload-polyfill.l9qzwofgcfa66ae6.js";/* empty css                                        */import{d as l,m as c,a as p,b as _,c as m,V as u,l as h,n as g,e as f,h as y,f as b,g as v,i as x,j as k}from"./vendor.l9qzwofgf5f8730e.js";import{w as C,o as T,P as I,u as S,s as E,C as A,a as R,b as j,g as B,c as N,d as D,e as P,f as L,h as M,i as q,r as O,j as z,R as W,k as $,l as H,m as U,n as F,p as V,q as J,t as K,v as X,x as G,M as Y,y as Q,z as Z,A as ee,B as te,D as ie,E as ne}from"./wxwork_hidden.l9qzwofga70cfd8a.js";import{n as ae,u as oe,e as se,w as re,j as de,A as le,a as ce,B as pe,o as _e,s as me,b as ue,c as we,E as he,d as ge,k as fe,f as ye,C as be,V as ve,g as xe,h as ke,i as Ce,l as Te,m as Ie,p as Se,q as Ee,K as Ae,t as Re,r as je}from"./weui_a11y.l9qzwofgf4e6922d.js";import{u as Be,A as Ne,$ as De,P as Pe,L as Le,j as Me,g as qe,r as Oe,a as ze}from"./comm_utils.l9qzwofge4ae1d87.js";import{A as We}from"./appmsgext.l9qzwofg5b83b017.js";import{D as $e,m as He,J as Ue}from"./event.l9qzwofg0e63f091.js";import{C as Fe,T as Ve}from"./class.l9qzwofga0d40e42.js";import{w as Je}from"./comm_report.l9qzwofg4cf2cd80.js";import{c as Ke,P as Xe,r as Ge,a as Ye,V as Qe,q as Ze,k as et}from"./voice_component.l9qzwofgc056202a.js";import{p as tt,I as it,V as nt,A as at}from"./page_utils.l9qzwofg4f503d08.js";import{O as ot}from"./outer_link.l9qzwofgb4e1b379.js";import{D as st,N as rt,I as dt}from"./dom.l9qzwofg6dfad82f.js";import{R as lt}from"./review_image.l9qzwofgf47042be.js";import{b as pt,s as _t}from"./set_article_read.l9qzwofg72327668.js";import{B as mt,l as ut,d as wt}from"./background_color.l9qzwofg72511e9e.js";import{A as ht,L as gt,B as ft}from"./bottom.l9qzwofg5979697b.js";import{n as yt}from"./vueComponentNormalizer.l9qzwofg860a5f85.js";import{R as bt,F as vt,V as xt,a as kt}from"./see_more.l9qzwofg969f4f7b.js";import{l as Ct,L as Tt,D as It,a as St}from"./like_and_share.l9qzwofgc6e135b3.js";import{V as Et,T as At}from"./controller.l9qzwofg9824557b.js";import"./modal.l9qzwofg490a2c85.js";/* empty css                      */import"./loadscript.l9qzwofg7736db86.js";const Rt=document.getElementById("js_tags_preview_toast");let jt=null;const Bt=(e,t)=>{Je.report(20158,{bizuin:window.biz,msgid:1*window.mid,itemidx:1*window.idx,Scene:1*window.source,Subscene:1*window.subscene,SessionId:window.sessionid+"",EnterId:1*window.enterid,Actiontype:1*e,PublicTagList:t+""})};let Nt=!1;var Dt={init(e){if(1===window.reprint_style||2===window.reprint_style||3===window.reprint_style||Nt||1*e.dataset.len==0)return;Nt=!0;const t=e=>{if(window.is_temp_url)Rt&&(Rt.style.display="",jt&&clearTimeout(jt),jt=setTimeout((()=>{Rt.style.display="none",jt=null}),3e3));else{const t={};let i=e.url;if(e.tag_id)Bt(2,e.tag_id),t.scene=window.source,t.subscene=window.subscene,t.sessionid=window.sessionid,t.enterid=window.enterid;else{let t=0;window.isPayTopic&&(t=0===window.isPaid?1:2),Ke({eventType:2,albumId:e.album_id,albumType:0,tagSrc:e.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:t})}tt.goUrl(i,Object.assign({},t,{scene:173,from_msgid:window.mid,from_itemidx:window.idx,count:3,nolastread:1}))}};if(Fe.hasClass(e,"js_single")){const i=e.querySelector(".js_tag").dataset;$e.on(e,"click",(()=>t(i)))}else $e.on(e,"click",(i=>{let n=i.target;n&&n!==e&&!Fe.hasClass(n,"js_tag")&&(n=n.parentNode),n&&Fe.hasClass(n,"js_tag")&&t(n.dataset)}));const i=t=>{const n=Be.getInnerHeight()+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);if(e.offsetTop<n){"function"!=typeof t&&$e.off(window,"scroll",i);let n="";Array.prototype.forEach.call(e.getElementsByClassName("js_tag"),(e=>{const t=e.dataset;if(t.tag_id)""!==n&&(n+="_"),n+=t.tag_id;else{let e=0;window.isPayTopic&&(e=0===window.isPaid?1:2),Ke({eventType:1,albumId:t.album_id,albumType:0,tagSrc:t.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:e})}})),n&&Bt(1,n)}else"function"==typeof t&&t()};i((()=>{$e.on(window,"scroll",i)}))}};const Pt=[];function Lt(){try{!function(){window.location.href.indexOf("clearStorage=1")>=0&&(localStorage.removeItem("max-age-storage-test"),console.log("clear localStorage"));var e=window.user_uin||0;if(0!==e&&Math.floor(e/100)%1e3<1&&(Ne({type:"GET",url:"/mp/reportcache?type=1&random="+Math.random()}),(new Image).src="/mp/reportcache?type=2&uin="+uin,localStorage&&null==localStorage.getItem("max-age-storage-test"))){console.log("localStorage empty");try{localStorage.setItem("max-age-storage-test",!0),console.log("localStorage set success")}catch(t){}Ne({type:"GET",url:"/mp/reportcache?type=3&random="+Math.random()})}}(),"undefined"==typeof getComputedStyle&&document.body.currentStyle&&(window.getComputedStyle=function(e){return e.currentStyle}),function(){let e=window.user_uin||0;if(!(0!==e&&Math.floor(e/100)%1e3<10))return;let t=document.getElementsByTagName("img"),i=t.length,n=document.getElementById("img-content"),a=n.offsetWidth,o=0,s=0,r=getComputedStyle(n);o=parseInt(r.paddingLeft)+parseInt(r.paddingRight),a-=o,a||(a=window.innerWidth-30);for(let d=0;d<i;++d){if(!t[d].getAttribute("data-src"))continue;let e=1*t[d].getAttribute("data-w")||a,i=1*t[d].getAttribute("data-ratio");i&&i>0&&e>a&&s++}s>0&&Pt.push({idkey:28307,order:22,num:s})}(),function(){let e="/mp/jsmonitor?idkey=",t=[];for(let i=0,n=Pt.length;i<n;++i){let e=Pt[i],n=e.idkey.toString()+"_"+e.order.toString()+"_"+e.num.toString();t.push(n)}e+=t.join(";"),Pt.length>0&&((new Image).src=e)}()}catch(e){console.error(e)}}let Mt=!1;const qt=navigator.userAgent.match(/MicroMessenger\/(\d+)\.(\d+)\.(\d+)/);if(qt){const e=Number(qt[1]),t=Number(qt[2]),i=Number(qt[3]);(e>6||6===e&&t>5||6===e&&5===t&&i>=3)&&(Mt=!0)}const Ot={tagName:"mp-wxaproduct",isWechat:(He.isAndroid||He.isIOS)&&He.isWechat&&!He.isWxWork,isPcWechat:He.isWindowsWechat||He.isMacWechat,screen_height:Be.getInnerHeight(),canJumpOnTap:Mt,commonReportData:{},minishopDom:[],appmsgType:1*window.appmsg_type||9},zt=(e={})=>{const t=e.dom,i=e.minishopInfo;$e.on(t,"tap",(function(e){e.stopPropagation(),e.preventDefault(),Je.report(22042,Object.assign({},Ot.commonReportData,{ActionType:2,toWxaAppId:i.appid,CardType:"large"===i.cardtype?1:0,ProductId:i.productId,isMassSend:Ot.appmsgType})),((e={})=>{Ot.isWechat||Ot.isPcWechat?Ot.canJumpOnTap?C.jumpUrl({options:{userName:e.username,scene:1058,sceneNote:encodeURIComponent(location.href),relativeURL:e.path},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){"openWeApp:ok"===e.err_msg||console.error(e.err_msg)}}):console.log("cant jumpOnTap"):new Xe({msg:"请使用微信打开。"})})(i)}),!0),$e.on(t,"click",(e=>{e.preventDefault(),e.stopPropagation()}),!0)},Wt=()=>{for(let e=0;e<Ot.minishopDom.length;e++){const t=Ot.minishopDom[e];if(1*t.getAttribute("data-hasreport")!=1){const e=document.documentElement.scrollTop||document.body.scrollTop,i=t.getAttribute("data-wxaproduct-productid")||"0",n=t.getAttribute("data-wxaproduct-appid")||"",a=t.getAttribute("data-wxaproduct-cardtype")||"mini";t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+Ot.screen_height&&(t.setAttribute("data-hasreport",1),Je.report(22042,Object.assign({},Ot.commonReportData,{ActionType:1,toWxaAppId:n,CardType:"large"===a?1:0,ProductId:i,isMassSend:Ot.appmsgType})))}}};$e.on(window,"scroll",Wt);const $t=(e={})=>{if(e.node&&e.data&&e.data.headimg){const t=function(e){let t=e.node,i=e.data;return function(){let e=document.createElement("div");e.innerHTML=Ve.tmpl('<# if(cardtype === \'mini\') {#>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_small js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>购买</button>\n    </div>\n  </div>\n</div>\n<#} else { #>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_large js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd weui-flex__item">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>购买</button>\n    </div>\n  </div>\n</div>\n<# } #>',i,!0).replace(/>\s*</g,"><").replace(/^\s+/,"").replace(/\s+$/,"");let n=e.firstChild;t.parentNode.insertBefore(n,t.nextSibling);let a=t.parentNode.querySelector('[data-preloadingid="'+i.productId+'"]');a&&a.parentNode.removeChild(a),zt({dom:n,minishopInfo:i}),Ot.minishopDom.push(n),Wt()}}(e),i=function(){this.onload=null,this.onerror=null,t()};let n=new Image;n.onload=i,n.onerror=i,n.src=e.data.headimg}},Ht=e=>{Ne({url:`/mp/wapwxaproduct?action=batch_get_product&product_ids=${JSON.stringify({list:e})}`,type:"GET",dataType:"json",success(e){e&&e.base_resp&&1*e.base_resp.ret==0&&"[object Array]"===Object.prototype.toString.call(e.product_list)&&((e=[])=>{const t=document.querySelectorAll(Ot.tagName);for(let i=0,n=t.length;i<n;i++){let n=t[i];const a=decodeURIComponent(n.getAttribute("data-wxaproduct-productid")||""),o=e.find((e=>e.product_id===a))||{},s={productId:a,title:n.getAttribute("data-wxaproduct-title")||"",price:decodeURIComponent(n.getAttribute("data-wxaproduct-price")||""),headimg:decodeURIComponent(n.getAttribute("data-wxaproduct-headimg")||""),cardtype:decodeURIComponent(n.getAttribute("data-wxaproduct-cardtype")||""),avatar:o.avatar||"",nickname:o.nickname||"",appid:o.appid||decodeURIComponent(n.getAttribute("data-wxaproduct-appid")||""),path:o.path||"",username:o.username||""};$t({data:s,node:n})}})(e.product_list)},error(e){console.error(e)}})};var Ut=(e={})=>{e.minishopCards&&(Ot.commonReportData={BizUin:1*l(e.biz),MsgId:window.parseInt(e.mid,10)||0,ItemIdx:window.parseInt(e.idx,10)||0,Scene:window.parseInt(e.source,10)||0,SubScene:window.parseInt(e.subscene,10)||0,EnterId:window.parseInt(e.enterid,10)||0},Ht(e.minishopCards.list),Wt())},Ft='<span class="qa__card js_qa_card_inner">\n  <# if (qaDeleted) { #>\n    <span class="qa__card-deleted">讨论内容已被删除</span>\n  <# } else { #>\n    <span>\n      <span class="qa__card-hd">\n        <span class="qa__hd-notice"><#=nickname#> 发起了一个读者讨论</span>\n        <span class="qa__hd-question"><#==title#></span>\n      </span>\n      <# if (!answerCount) { #>\n        <# if (isLogin) { #>\n          \x3c!-- <# if (disableAnswerWord) { #>\n            <span class="qa__list-answer qa__list-answer_desc"><#=disableAnswerWord#></span>\n          <# } else { #>\n            <span class="qa__list-answer js_qa_write_answer">参与讨论</span>\n          <# } #> --\x3e\n          <span class="qa__list-answer qa__list-answer_desc">讨论已结束</span>\n        <# } #>\n      <# } else { #>\n        <span>\n          <span class="qa__list-hd">\n            <span class="qa__list-hd-title js_qa_list_head_title">精选讨论内容</span>\n            \x3c!-- <# if (isLogin) { #>\n              <# if (disableAnswerWord) { #>\n                <span class="qa__list-hd-desc"><#=disableAnswerWord#></span>\n              <# } else { #>\n                <span class="qa__list-hd-action js_qa_write_answer">参与讨论</span>\n              <# } #>\n            <# } #> --\x3e\n          </span>\n          <span class="qa__list js_qa_qna_answer_list"><#==answerListStr#></span>\n          <# if (leftAnswerCnt) { #>\n            <p class="qa__list-more js_more_answer_entry" data-count="<#=answerCount#>"><#=leftAnswerCnt#></p>\n          <# } #>\n        </span>\n      <# } #>\n    </span>\n  <# } #>\n</span>';const Vt=screen.height/4*3+"px",Jt={top:De.os.pc?"20%":screen.height/4-(screen.height-window.innerHeight)+"px",btnText:"提交",hasHeader:!0,clickMask2Hide:!0,animationType:"bottom",scroll2Hide:!0};function Kt(e,t,i,n){i=n?`${i}px`:i,e.style[t]=i}class Xt{constructor(e,t={}){t=Object.assign({},Jt,t);const i=document.createElement("div");i.innerHTML=Ve.tmpl('<div class="wx_bottom_modal_wrp <#=extClass#>">\n  <div\n    class="weui-half-screen-dialog wx_bottom_modal js_bottom_modal_content"\n    role="dialog"\n    aria-modal="true"\n    aria-hidden="true"\n    tabindex="0"\n    <# if (!autoHeight) { #>\n      style="max-height: none;"\n    <# } else { #>\n      style="max-height: <#=maxHeight#>;"\n    <# } #>\n  >\n    <# if (hasHeader) { #>\n      <div class="weui-half-screen-dialog__hd__wrp">\n        <div class="weui-half-screen-dialog__hd js_bottom_modal_hd">\n          <div class="weui-half-screen-dialog__hd__side">\n            <button class="weui-btn_icon js_close_bottom_modal weui-wa-hotarea">关闭<i class="weui-icon-half-screen-close"></i></button>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__main">\n            <strong class="weui-half-screen-dialog__title js_bottom_modal_title">标题</strong>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__side">\n            <# if (hasBtn) { #>\n              <# if (btnSlot) { #>\n                <div role="button" class="js_submit_bottom_modal weui-wa-hotarea">\n                  <#==btnSlot#>\n                </div>\n              <# } else { #>\n                <button class="weui-btn weui-btn_primary weui-btn_xmini js_submit_bottom_modal weui-wa-hotarea"><#=btnText#></button>\n              <# } #>\n            <# } #>\n            <button class="weui-btn_icon" style="display:none;">更多<i class="weui-icon-more"></i></button>\n          </div>\n        </div>\n      </div>\n    <# } #>\n    <div class="weui-half-screen-dialog__bd js_bottom_modal_bd">\n      <div role="alert" class="wx_bottom_modal_msg_wrp js_modal_loading" style="display: none;">\n        <div class="wx_bottom_modal_msg">\n          <i class="weui-loading" role="img" aria-label="加载中"></i>\n        </div>\n      </div>\n      \x3c!-- 上下拉加载loading --\x3e\n      <div role="alert" class="weui-loadmore js_pull_loading" style="display: none;">\n        <i class="weui-loading"></i>\n        <span class="weui-loadmore__tips">正在加载</span>\n      </div>\n\n      \x3c!-- 加载完成的dom，插到js_bottom_modal_bd下 --\x3e\n      <div role="option" class="weui-loadmore weui-loadmore_line weui-loadmore_dot js_modal_end_line" style="display: none;">\n        <div class="weui-hidden_abs">已无更多数据</div>\n        <span class="weui-loadmore__tips"></span>\n      </div>\n    </div>\n    <# if (hasFooter) { #>\n      <div class="weui-half-screen-dialog__ft js_bottom_modal_ft"></div>\n    <# } #>\n  </div>\n  <# if (hasMask) { #>\n    \x3c!-- 透明mask，用于防止点透 --\x3e\n    <div class="wx_bottom_modal_mask_fixed js_bottom_modal_mask_not_click"></div>\n\n    \x3c!-- 有底色的mask --\x3e\n    <div class="weui-mask wx_bottom_modal_mask js_bottom_modal_mask"></div>\n  <# } #>\n</div>',{hasBtn:t.hasBtn,btnText:t.btnText,extClass:t.extClass||"",hasMask:!t.removeMask,isTopic:!!t.isTopic,hasHeader:t.hasHeader,hasFooter:!!t.footerEl,btnSlot:t.btnSlot,autoHeight:t.autoHeight,maxHeight:Vt});const n=i.firstChild;this.scrollLock=!1,this.curScrollTop=0,this.touches={startX:0,startY:0,curX:0,curY:0,isScreenLeft:!1,direction:"",times:0},this.opt=t,this.rootEle=n,this.contentEle=e,this.contentAreaWrp=n.getElementsByClassName("js_bottom_modal_bd")[0],this.contentAreaWrp.appendChild(e),this.contentArea=n.getElementsByClassName("js_bottom_modal_content")[0],this.loading=this.rootEle.getElementsByClassName("js_modal_loading")[0],this.pullLoading=this.rootEle.getElementsByClassName("js_pull_loading")[0],this.endLine=this.rootEle.getElementsByClassName("js_modal_end_line")[0],this.enableGesture=!1,this.triggerEl=null,this.isAutoFocus=!0,t.removeMask||(this.maskEle=n.getElementsByClassName("js_bottom_modal_mask")[0],this.maskNotClick=n.getElementsByClassName("js_bottom_modal_mask_not_click")[0],t.transparentMask&&Kt(this.maskEle,"opacity",0)),t.hasHeader&&(this.headAreaWrp=n.getElementsByClassName("js_bottom_modal_hd")[0],this.submitBtn=this.headAreaWrp.getElementsByClassName("js_submit_bottom_modal")[0],this.closeBtn=this.headAreaWrp.getElementsByClassName("js_close_bottom_modal")[0],this.setTitle(t.title)),t.footerEl&&(this.footAreaWrp=n.querySelector(".js_bottom_modal_ft"),this.footAreaWrp.appendChild(t.footerEl)),"right"===t.animationType&&this.rootEle.classList.add("wx_bottom_modal_right"),document.body.appendChild(n),t.cb&&t.cb(),this.bindEvent()}bindEvent(){this.maskEle&&(this.opt.clickMask2Hide&&$e.tap(this.maskEle,(()=>{this.hide()})),$e.on(this.contentArea,"transitionend",(e=>{e.target!==this.contentArea||"transform"!==e.propertyName&&"-ms-transform"!==e.propertyName||(""!==this.contentArea.style.transform?this.contentArea.style.removeProperty("transform"):this.getShowStatus()?"function"==typeof this.opt.onShowAfterAnimation&&this.opt.onShowAfterAnimation():(Kt(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&Kt(this.contentArea,"top",this.opt.top)))})),$e.tap(this.maskNotClick,(()=>setTimeout((()=>{this.hide(),Kt(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&Kt(this.contentArea,"top",this.opt.top)}),300))),$e.on(this.maskEle,"touchmove",(e=>{e.preventDefault()}))),this.headAreaWrp&&($e.on(this.headAreaWrp,"touchstart",(e=>this.onTouchStart(e))),$e.on(this.headAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),$e.on(this.headAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.footAreaWrp&&($e.on(this.footAreaWrp,"touchstart",(e=>this.onTouchStart(e))),$e.on(this.footAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),$e.on(this.footAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.closeBtn&&$e.on(this.closeBtn,"click",(()=>{this.hide()})),this.submitBtn&&$e.on(this.submitBtn,"click",(()=>{Fe.hasClass(this.submitBtn,"weui-btn_disabled")||this.opt.btnClickCb&&this.opt.btnClickCb()})),$e.on(this.contentAreaWrp,"scroll",(()=>{this.checkReachBoundary(),this.contentAreaWrp.scrollTop>0?Fe.addClass(this.contentArea,"weui-half-screen-dialog_headline"):Fe.removeClass(this.contentArea,"weui-half-screen-dialog_headline")})),this.headAreaWrp&&$e.tap(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0],(()=>{this.opt.titleClickCb&&this.opt.titleClickCb()})),$e.on(this.contentAreaWrp,"touchstart",(e=>this.onTouchStart(e))),$e.on(this.contentAreaWrp,"touchmove",(e=>{const t=e.changedTouches[0];if(this.getTouchDirection(t)){if("Y"===this.touches.direction){const n=this.contentAreaWrp,a=t.pageY,o=a-this.touches.startY,s=n.scrollTop<=0&&o>0,r=(i=n,Math.ceil(i.scrollTop+i.offsetHeight)>=i.scrollHeight&&o<0);s||r?(s&&!this.opt.onPullDownLoad&&this.move(a),e.preventDefault()):this.resetMovement(),this.touches.curY=a}else e.preventDefault(),this.moveByDirection(t)}var i})),$e.on(this.contentAreaWrp,"touchend",(e=>this.onTouchEnd(e))),$e.on(window,"unload",(()=>{this.opt.removeMask||ae.hide()}))}checkReachBoundary(e=!0,t=!0){this.scrollLock&&0!==this.contentAreaWrp.scrollTop||(this.scrollLock=!0,setTimeout((()=>{this.scrollLock=!1}),50),e&&!this.pullingDownLock&&this.contentAreaWrp.scrollTop<=0&&(this.opt.onPullDownLoad&&this.opt.onPullDownLoad(),this.pullingDownLock=!0),setTimeout((()=>{t&&!this.pullingUpLock&&this.contentAreaWrp.scrollTop+this.contentAreaWrp.offsetHeight+100>this.contentEle.offsetHeight&&(this.opt.onPullUpLoad&&this.opt.onPullUpLoad(),this.pullingUpLock=!0)}),100),this.opt.onScroll&&this.opt.onScroll(this.contentAreaWrp.scrollTop>this.curScrollTop?"up":"down"),this.curScrollTop=this.contentAreaWrp.scrollTop)}onTouchStart(e){const t=e.touches[0];this.touches={startX:t.pageX,startY:t.pageY,curX:t.pageX,curY:t.pageY,isScreenLeft:this.enableGesture&&t.pageX<=30,direction:"",times:0},this.contentArea.style.transition="none"}onTouchEnd(e){const t=this.touches.direction,i="X"===t?100:this.contentArea.offsetHeight/4,n=e.changedTouches[0][`page${t}`]-this.touches[`start${t}`],a=this.contentArea.dataset;this.contentArea.style.removeProperty("transition"),a.distance&&(n>i?this.hide():this.contentArea.style.transform="translateY(0)",delete a.distance)}getTouchDirection(e){if(this.touches.direction)return!0;if(!this.touches.isScreenLeft)return this.touches.direction="Y",!0;this.touches.times++;const t=Math.abs(e.pageX-this.touches.startX),i=Math.abs(e.pageY-this.touches.startY);return this.touches.times>=3?(this.touches.direction=t>=i?"X":"Y",!0):t>=5&&t>=i?(this.touches.direction="X",!0):i>=5&&(this.touches.direction="Y",!0)}moveByDirection(e){const t=this.touches.direction,i=e[`page${t}`];i-this.touches[`start${t}`]>0?this.move(i):this.resetMovement(),this.touches[`cur${t}`]=i}move(e){if(this.opt.sideslip2Hide&&"X"===this.touches.direction||this.opt.scroll2Hide&&"Y"===this.touches.direction){const t=this.contentArea.dataset;t.distance=1*(t.distance||0)+e-this.touches[`cur${this.touches.direction}`],this.contentArea.style.transform=`translateY(${t.distance}px)`}}resetMovement(){delete this.contentArea.dataset.distance,this.contentArea.style.removeProperty("transform")}show(e,t,i,n=!0){if(Fe.addClass(document.body,"page_no_scroll"),this.triggerEl=i||window.event&&window.event.target,this.isAutoFocus=n,this.getShowStatus())return;e||this.opt.autoHeight||(Kt(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight)),Kt(this.contentArea,"visibility","visible"),Fe.addClass(this.rootEle,"wx_bottom_modal_show");const a=document.getElementById("img-content");a&&a.setAttribute("aria-hidden","true"),this.setAriaHidden(!1),this.contentArea.focus(),this.maskEle&&this.opt.clickMask2Hide&&Kt(this.maskNotClick,"visibility","visible"),this.opt.removeMask||ae.show({alpha:this.opt.transparentMask?0:.6,callback:e=>{e&&"function"==typeof this.opt.onShowNavShadow&&this.opt.onShowNavShadow()},onClick:()=>{this.hide()}}),this.opt.sideslip2Hide&&(De.os.ios?Ue.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!0},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!0)})):oe.disable({onGoBack:()=>{this.hide()},onDisable:()=>{this.enableGesture=!0},onEnable:()=>{this.enableGesture=!1}})),e&&(Fe.addClass(this.rootEle,"wx_bottom_modal_form"),Kt(this.contentArea,"top","25px")),setTimeout((()=>{e||"right"===this.opt.animationType&&(Kt(this.contentArea,"-ms-transform","translateX(0)"),Kt(this.contentArea,"transform","translateX(0)"))})),e&&(setTimeout((()=>{"bottom"===this.opt.animationType?Kt(this.contentArea,"top","100%"):Kt(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight),Fe.removeClass(this.rootEle,"wx_bottom_modal_form"),setTimeout((()=>{Kt(this.contentArea,"top",this.opt.top),"right"===this.opt.animationType&&(Kt(this.contentArea,"-ms-transform","translateX(0)"),Kt(this.contentArea,"transform","translateX(0)"))}))}),50),De.os.ios?t.focus():(this.tmpInputEle||(this.tmpInputEle=t.cloneNode(!0)),this.tmpInputEle.style.opacity=0,this.tmpInputEle.style.position="fixed",this.tmpInputEle.style.top=0,this.tmpInputEle.style.zIndex="-1",document.body.appendChild(this.tmpInputEle),setTimeout((()=>{t.focus(),this.opt.makeInputEleBigger&&this.opt.makeInputEleBigger(),document.body.removeChild(this.tmpInputEle)}),300),this.tmpInputEle.focus()),De.os.ios&&!this.hasBindInputEvent&&this.opt.makeFakeInputEle&&this.opt.removeInputEle&&(this.hasBindInputEvent=!0,$e.on(t,"focus",(()=>{setTimeout((()=>{t.style.opacity=1,this.opt.removeInputEle()}),50)})),$e.on(t,"blur",(()=>{this.opt.makeFakeInputEle(),t.style.opacity=0})))),this.opt.onShow&&this.opt.onShow()}hide(e){if(Fe.removeClass(document.body,"page_no_scroll"),e&&Kt(this.maskNotClick,"visibility","hidden"),!this.getShowStatus())return;this.contentArea.style.removeProperty("-ms-transform"),this.contentArea.style.removeProperty("transform"),Fe.removeClass(this.rootEle,"wx_bottom_modal_show");const t=document.getElementById("img-content");t&&t.setAttribute("aria-hidden","false"),this.setAriaHidden(!0),this.isAutoFocus&&function(e){if(!(e&&e instanceof HTMLElement))return!1;const t=window.getComputedStyle(e);return 0!==t.width&&0!==t.height&&0!==t.opacity&&"none"!==t.display&&"hidden"!==t.visibility&&null!==e.offsetParent}(this.triggerEl)&&(this.triggerEl.setAttribute("tabindex","0"),this.triggerEl.focus()),this.opt.removeMask||ae.hide(),this.opt.sideslip2Hide&&(De.os.ios?Ue.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!1},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!1)})):oe.enable({onEnable:()=>{this.enableGesture=!1}})),this.opt.onHide&&this.opt.onHide()}disableBtn(){this.submitBtn&&Fe.addClass(this.submitBtn,"weui-btn_disabled")}enableBtn(){this.submitBtn&&Fe.removeClass(this.submitBtn,"weui-btn_disabled")}finishPullUpLoad(){this.pullingUpLock=!1}finishPullDownLoad(){this.pullingDownLock=!1}setTitle(e){this.headAreaWrp&&("string"==typeof e?this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e:"object"==typeof e&&e.innerHTML&&(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e.innerHTML))}scrollTo(...e){this.contentAreaWrp.scrollTo(...e)}getRootEle(){return this.rootEle}getBdEle(){return this.contentAreaWrp}getScrollEle(){return this.contentAreaWrp}setCloseBtnStyle(e){if(this.closeBtn){const t=this.closeBtn.getElementsByTagName("i")[0],i="weui-icon-close-thin",n="weui-icon-back-arrow-thin";"back"===e?(Fe.removeClass(t,i),Fe.addClass(t,n)):(Fe.removeClass(t,n),Fe.addClass(t,i))}}getShowStatus(){return Fe.hasClass(this.rootEle,"wx_bottom_modal_show")}showLoading(){Kt(this.loading,"display","block")}hideLoading(){Kt(this.loading,"display","none")}showPullUpLoading(){this.contentAreaWrp.appendChild(this.pullLoading),Kt(this.pullLoading,"display","block")}hidePullUpLoading(){Kt(this.pullLoading,"display","none")}showPullDownLoading(){this.contentAreaWrp.insertBefore(this.pullLoading,this.contentAreaWrp.firstChild),Kt(this.pullLoading,"display","block")}hidePullDownLoading(){Kt(this.pullLoading,"display","none")}showEndLine(){this.contentAreaWrp.appendChild(this.endLine),Kt(this.endLine,"display","block")}setAriaHidden(e){this.contentArea.setAttribute("aria-hidden",e.toString())}disablePullDownLoad(){this.opt.onPullDownLoad=null}}function Gt(e,t,i=0){return e.getElementsByClassName(t)[i]}const Yt=document.getElementsByTagName("mp-qa")[0];let Qt,Zt,ei,ti,ii,ni,ai,oi,si,ri,di={},li=0,ci=0,pi=0,_i="";const mi={__biz:Yt&&Yt.dataset.bizuin,question_id:Yt&&Yt.dataset.id,qna_sn:Yt&&function(e){let t;if(window.qnaCardData)try{t=JSON.parse(window.qnaCardData);const i=t.list;if(i&&i.length)for(let t=0;t<i.length;t++)if(e===i[t].question_id)return i[t].qna_sn}catch(i){console.error(i)}return""}(Yt.dataset.id)},ui={};function wi(e){e&&(e.style.display="none")}function hi(e){e&&(e.style.display="block")}function gi(e,t){re.jsmonitor({id:223326,key:e,value:t})}function fi(){window.weui.topTips("系统错误，请稍后再试")}function yi(e={}){Je.report(20883,Object.assign({Device:De.os.ios?1:De.os.android?2:-1,MsgId:1*mi.mid,ItemIdx:1*mi.idx,BizUin:di.biz,ItemShowType:1*di.itemShowType,SessionId:di.sessionId,EnterId:1*di.enterId,Scene:1*di.scene,SubScene:1*di.subScene,QaId:Yt.dataset.id},e))}function bi(e,t,i){const n={replyListHtml:"",replyList:document.createDocumentFragment()};return e&&e.reply_list&&e.reply_list.length&&(n.leftReplyCount=e.left_reply_cnt,n.leftReplyTips="余下#value#条回复".replace("#value#",e.left_reply_cnt),e.reply_list.forEach((e=>{e.canOp=i,e.content=e.content.htmlEncode(),e.content=se.encode(e.content),e.likeNumFormated=tt.formatReadNum(e.like_num),e.replyStatus=void 0===e.reply_status?1:e.reply_status,e.isLogin=Qt;const t=document.createElement("div");t.innerHTML=Ve.tmpl('<section class="qa__reply-item js_qa_reply_item<# if (is_my_reply) { #> js_qa_my_reply<# } #>">\n  <div class="qa__reply-hd">\n    <div class="qa__reply-nickname">\n      <# if (is_biz_reply) { #>\n        作者\n      <# } else { #>\n        <#=user_info.nickname#>\n      <# } #>\n    </div>\n    <div class="qa__item-action">\n      <# if (is_my_reply && canOp) { #>\n        <div class="qa__action js_delete_reply" data-id="<#=reply_id#>"><i class="icon_delete"></i></div>\n      <# } #>\n      \x3c!-- 精选之后的才能点赞 --\x3e\n      <# if (replyStatus && isLogin) { #>\n        <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="2" data-id="<#=reply_id#>">\n          <i class="icon_praise_gray"></i>\n          <span class="js_like_num" data-num="<#=like_num#>">\n            <#=likeNumFormated#>\n          </span>\n        </div>\n      <# } #>\n      <# if (!replyStatus) { #>\n        <div class="qa__action qa__action_normal">未精选</div>\n      <# } #>\n    </div>\n  </div>\n  <p class="qa__reply-content js_qa_reply_content"><#=content#></p>\n</section>',e,!1),n.replyListHtml+=t.innerHTML,n.replyList.appendChild(t.firstChild)}))),n}function vi(e,t,i=""){const n={answerListHtml:"",fragment:document.createDocumentFragment()};return e.forEach((e=>{e.likeNumFormated=tt.formatReadNum(e.like_num),e.canOp=t,e.answer_sn=e.answer_sn||"",e.content=e.content.htmlEncode(),e.oriContent=e.content,e.content=se.encode(e.content),e.isLogin=Qt;const i=bi(e.reply_info,e.answer_id,t);Object.assign(e,i);const a=document.createElement("div");a.innerHTML=Ve.tmpl('<div class="qa__list-item js_qa_list_item">\n  \x3c!-- 层主头像 --\x3e\n  <section class="qa__item-avatar">\n    <img src="<#=user_info.headimg#>">\n  </section>\n  <section class="qa__item-bd">\n    <div class="qa__item-info">\n      \x3c!-- 层主昵称 --\x3e\n      <div class="qa__item-nickname">\n        <#=user_info.nickname#>\n      </div>\n      \x3c!-- 点赞 --\x3e\n      <div class="qa__item-action">\n        \x3c!-- span加praised点赞 --\x3e\n        <# if (is_my_answer && canOp) { #>\n          <div class="qa__action js_delete_answer" data-id="<#=answer_id#>"><i class="icon_delete"></i></div>\n        <# } #>\n        \x3c!-- 精选之后的才能点赞 --\x3e\n        <# if (answer_status && isLogin) { #>\n          <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="1" data-id="<#=answer_id#>">\n            <i class="icon_praise_gray"></i>\n            <span class="js_like_num" data-num="<#=like_num#>">\n              <#=likeNumFormated#>\n            </span>\n          </div>\n        <# } #>\n        <# if (!answer_status) { #>\n          <div class="qa__action qa__action_normal">未精选</div>\n        <# } #>\n      </div>\n    </div>\n\n    \x3c!-- 回答内容 --\x3e\n    <p class="qa__item-content js_qa_item_content"><#=content#></p>\n    \x3c!-- <# if (is_my_answer && canOp) { #>\n    <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (replyListHtml) { #>style="display: none;"<# } #>><span>回复</span></div>\n    <# } #> --\x3e\n\n    \x3c!-- 回复 --\x3e\n    <section class="qa__reply">\n      <section class="js_qa_reply_list js_qa_reply_list_<#=answer_id#>">\n        <#=replyListHtml#>\n      </section>\n      <# if (replyListHtml && leftReplyCount) { #>\n        <p class="qa__reply-more js_get_more_reply js_get_more_reply_<#=answer_id#>" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>">\n          <#=leftReplyTips#>\n        </p>\n      <# } #>\n      \x3c!-- <# if (is_my_answer && canOp) { #>\n      <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (!replyListHtml) { #>style="display: none;"<# } #>><span>回复</span></div>\n      <# } #> --\x3e\n    </section>\n  </section>\n</div>',e,!1),n.answerListHtml+=a.innerHTML,n.fragment.appendChild(a.firstChild)})),"myAnswerList"===i?ci+=10:"answerList"===i&&(li+=10),n}function xi(e={}){const t=Object.assign({action:e.action,limit:10,offset:e.offset},mi);Ne({url:Pe.join("/mp/qna",t),dataType:"json",success(t){let i;t&&(i=t.qna_info?t.qna_info.answer_info:t.answer_info,e.successCb(i,t))},complete(){e.complete&&e.complete()}})}function ki(e,t){let i=0;for(;e.offsetParent&&e!==t;)i+=e.offsetTop,e=e.offsetParent;return i}function Ci(e,t,i){const n=e.dataset.answerid,a=i?ki(e,ei.getScrollEle()):0;Ne({url:Pe.join("/mp/qna",Object.assign({action:"get_more_reply",answer_id:n,answer_sn:e.dataset.answersn,limit:10},mi)),dataType:"json",success(t){if(t&&t.reply_info&&t.reply_info.reply_list&&t.reply_info.reply_list.length){const n=bi(t.reply_info,0,!0);n.replyListHtml?(Gt(e.parentNode,"js_qa_reply_list").appendChild(n.replyList),n.leftReplyCount?e.innerHTML=n.leftReplyTips:wi(e),i&&ei.scrollTo(0,a-48)):wi(e)}}})}function Ti(e){const t=Gt(ti,`js_get_more_reply_${e}`);t&&Ci(t,0,!0)}function Ii(){return Gt(ni,"js_qa_input")}function Si(){const e=Ii();return(e.value||e.innerHTML).trim()}function Ei(){Si()?ii.enableBtn():ii.disableBtn()}function Ai(e={}){xi({action:e.action,offset:e.offset,successCb(t,i){if(t&&t.answer_list&&t.answer_list.length){let i,n;"get_my_answer"===e.action?(i="myAnswerList",n=ni,hi(Gt(ni,"js_qa_write_head"))):(i="answerList",n=ti);Gt(n,"js_qa_qna_answer_list").appendChild(vi(t.answer_list,!0,i).fragment)}e.cb&&e.cb(t,i)}})}function Ri(){if(!ni)return;const e="回复: #value#".replace("#value#",se.encode(_i)),t=Gt(ni,"js_reply_top_content");ai?(t.innerHTML=e,hi(t)):wi(t)}function ji(e){Gt(ni,"js_alert_toast_word").innerHTML=e,hi(Gt(ni,"js_alert_toast")),setTimeout((()=>{wi(Gt(ni,"js_alert_toast"))}),800)}function Bi(){let e=0;const t=ti.getElementsByClassName("js_qa_list_item");for(let i=0;i<t.length&&t[i].getBoundingClientRect().y<Be.getInnerHeight();i++)e++;e>pi&&(pi=e)}function Ni(e,t){if(ei)return ei.show(),void(e&&t&&Ti(t));let i;ti=Yt.firstChild.cloneNode(!0);const n=Gt(ti,"qa__list-more"),a=Gt(ti,"js_qa_write_answer");n&&wi(n),a&&Fe.addClass(a,"modalWriteAnswerClass"),Gt(ti,"js_qa_qna_answer_list").innerHTML="",ei=new Xt(ti,{title:"读者讨论",extClass:"qa__card",onPullUpLoad(){i>0&&(ei.showPullUpLoading(),Ai({action:"get_more_answer",offset:li,cb(e,t){ei.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?ei.finishPullUpLoad():ei.showEndLine()}}))},cb(){Ai({action:"get_more_answer",offset:li,cb(n){if(e&&t)Ti(t);else{const e=Zt.dataset.count,t=ki(Gt(ti,"js_qa_list_item",e),ei.getScrollEle());ei.scrollTo(0,t-96)}i=n.left_answer_cnt,i||ei.showEndLine()}})},onScroll(){Bi()},onHide(){Bi(),yi({EventType:3,Exposure:pi}),pi=0}}),ei.show(),$e.on(ti,"tap",".js_get_more_reply",(e=>{Ci(e.delegatedTarget)}))}function Di(e){let t;const i=ai?"写回复":"参与讨论";if(ii)return Ri(),ii.setTitle(i),e?ii.setCloseBtnStyle("back"):ii.setCloseBtnStyle("close"),void ii.show(!0,Ii());ni=document.createElement("div"),ni.innerHTML=Ve.tmpl('<div class="qa__modal-reply">\n  <div class="qa__modal-reply-msg js_reply_top_content"></div>\n  <div class="frm_textarea_box_wrp">\n    <span class="frm_textarea_box" style="position: relative; display: block;">\n      <div style="position: relative; height: 9.6em; overflow: hidden; font-size: 17px;">\n        <textarea class="frm_textarea js_qa_input" placeholder="内容被公众号精选后，将对所有人可见。" style="height: 9.6em; width: 100%; border: none; outline: none;"></textarea>\n      </div>\n      <div class="emotion_tool">\n        <span class="emotion_switch" style="display:none;"></span>\n        <span id="js_qa_emotion_switch" class="pic_emotion_switch_wrp">\n          <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n          <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n          <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n          <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n        </span>\n      </div>\n    </span>\n  </div>\n  <div class="emotion_panel" id="js_qa_emotion_panel">\n    <span class="emotion_panel_arrow_wrp" id="js_qa_emotion_panel_arrow_wrp">\n      <i class="emotion_panel_arrow arrow_out"></i>\n      <i class="emotion_panel_arrow arrow_in"></i>\n    </span>\n    <div class="emotion_list_wrp" id="js_qa_emotion_slide_wrapper"></div>\n    <ul class="emotion_navs" id="js_qa_emotion_navbar"></ul>\n  </div>\n</div>\n<div class="qa__list-wrp">\n  <div class="qa__list-hd js_qa_write_head" style="display: none;">\n    <span class="qa__list-hd-title">我的讨论内容</span>\n  </div>\n  <div class="qa__list js_qa_qna_answer_list"></div>\n</div>\n\n<div class="js_loading_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-loading weui-icon_toast"></i>\n    <p class="weui-toast__content js_loading_content">正在加载</p>\n  </div>\n</div>\n\n<div class="js_sended_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n    <p class="weui-toast__content" id="js_toast_msg">已发送</p>\n  </div>\n</div>\n\n<div class="qa__toast-alert js_alert_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class=" qa__icon-alert"></i>\n    <p class="weui-toast__content js_alert_toast_word"></p>\n  </div>\n</div>',{}),ii=new Xt(ni,{title:i,top:"25px",extClass:"qa__card qa__card_write",hasBtn:!0,disableTransition:!0,onPullUpLoad(){t>0&&(ii.showPullUpLoading(),Ai({action:"get_my_answer",offset:ci,cb(e,t){ii.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?ii.finishPullUpLoad():ii.showEndLine()}}))},onHide(){Ii().blur()},onScroll(e){"up"===e&&Ii().blur()},cb(){Ai({action:"get_my_answer",offset:ci,cb(e){t=e.left_answer_cnt,t||ii.showEndLine()}})},btnClickCb(){ii.disableBtn();const e=ai?"add_reply":"add_answer";hi(Gt(ni,"js_loading_toast")),Ne({url:`/mp/qna?action=${e}`,type:"POST",dataType:"json",data:Object.assign({answer_id:si,answer_sn:ri,content:Si(),my_reply_cnt:oi+1,ignore_tips:1},mi),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){if(hi(Gt(ni,"js_sended_toast")),setTimeout((()=>{wi(Gt(ni,"js_sended_toast"))}),800),Ii().value="",ii.disableBtn(),ai&&e.reply_info&&e.reply_info.reply_list){const t=bi(e.reply_info,0,!0).replyList,i=Gt(ni,`js_qa_reply_list_${si}`);i.appendChild(t.cloneNode(!0)),hi(Gt(i.parentNode,"js_write_reply")),wi(Gt(i.parentNode.parentNode,"js_write_reply"))}else if(!ai&&e.answer_info&&e.answer_info.answer_list){const t=Gt(ni,"js_qa_qna_answer_list");t.insertBefore(vi(e.answer_info.answer_list,!0).fragment,t.firstChild),hi(Gt(ni,"js_qa_write_head"))}}else ii.enableBtn(),168003===e.base_resp.ret||168007===e.base_resp.ret?ji("内容涉嫌违反平台协议或法规政策"):168004===e.base_resp.ret?ji("关注该公众号才能参与讨论"):168005===e.base_resp.ret?ji("关注该公众号3天及以上才能参与讨论"):168008===e.base_resp.ret||168009===e.base_resp.ret?ji("字数不能多于"+(ai?140:600)):fi()},error(){fi(),ii.enableBtn()},complete(){wi(Gt(ni,"js_loading_toast")),Ii().blur()}})},makeFakeInputEle(){const e=Ii(),t=e.cloneNode();t.id="tmp_input",t.style.top=0,t.style.position="absolute",e.parentNode.insertBefore(t,e),t.value=e.value,t.scrollTop=e.scrollTop},removeInputEle(){const e=document.getElementById("tmp_input");e&&e.parentNode.removeChild(e)},makeInputEleBigger(){const e=Ii();e.style.borderTop="solid 1000px transparent",e.style.position="relative",e.style.top="-1000px"}}),Ri(),ii.disableBtn(),e?ii.setCloseBtnStyle("back"):ii.setCloseBtnStyle("close"),ii.show(!0,Ii()),function(){const e=Ii();$e.on(ni,"tap",".js_get_more_reply",(e=>{Ci(e.delegatedTarget)})),$e.on(e,"input",Ei),$e.on(e,"tap",(()=>{ii.scrollTo(0,0)}))}(),new se.Emotion({emotionPanel:de("#js_qa_emotion_panel"),inputArea:de(Ii()),emotionPanelArrowWrp:de("#js_qa_emotion_panel_arrow_wrp"),emotionSwitcher:de("#js_qa_emotion_switch"),emotionSlideWrapper:de("#js_qa_emotion_slide_wrapper"),emotionNavBar:de("#js_qa_emotion_navbar"),inputEmotion(){Ei()}})}var Pi={renderQaCard:function(e={}){Yt&&(mi.mid=e.mid,mi.idx=e.idx,di.userUin=e.userUin,di.biz=e.biz,di.itemShowType=e.itemShowType,di.enterId=e.enterId,di.scene=e.scene,di.subScene=e.subScene,di.sessionId=e.sessionId,Qt=e.isLogin,xi({action:"get_qna_info",successCb(e,t){let i,n,a,o;const s=t.base_resp.ret,r=168001===s,d=t.qna_info&&t.qna_info.question_info;r?Yt.innerHTML=Ve.tmpl(Ft,{qaDeleted:r}):0===s&&("1"===Pe.getQuery("js_my_answer")&&(Di(),gi(4)),e&&e.answer_list&&e.answer_list.length&&(a=vi(e.answer_list,!1).answerListHtml,n=e.answer_list.length,e.left_answer_cnt&&(i="余下#value#条讨论内容".replace("#value#",e.left_answer_cnt))),1===d.can_answer_type&&0===t.qna_info.is_fans?o="作者已设置关注后才可参与讨论":2===d.can_answer_type&&0===t.qna_info.is_fans_days&&(o="作者已设置关注7天后才可参与讨论"),Yt.innerHTML=Ve.tmpl(Ft,{qaDeleted:r,answerCount:n,leftAnswerCnt:i,answerListStr:a,disableAnswerWord:o,title:se.encode(d.question_title.htmlEncode()),nickname:d.biz_info.nickname,isLogin:Qt}),Zt=Gt(Yt,"js_more_answer_entry"),function(){let e;function t(){if(e)return;const t=Yt.firstChild,i=T.getOffset(t).offsetTop,n=Be.getScrollTop();n+Be.getInnerHeight()>=i&&n<=i+t.offsetHeight&&(yi({EventType:1}),gi("0"),e=!0)}$e.on(Yt,"tap",".js_get_more_reply",(e=>{const t=e.delegatedTarget.dataset.answerid;ui[t]?Ni():(Ni(!0,t),ui[t]=!0)})),$e.on(document.body,"click",".js_qa_write_answer",(e=>{ai=!1,Di(Fe.hasClass(e.delegatedTarget,"modalWriteAnswerClass")),gi(2)})),$e.on(document.body,"click",".js_write_reply",(e=>{const t=e.delegatedTarget,i=t.parentNode.parentNode;if(si=t.dataset.answerid,ri=t.dataset.answersn,i){const e=i.getElementsByClassName("js_qa_reply_content");oi=i.getElementsByClassName("js_qa_my_reply").length,_i=e.length?e[e.length-1].innerHTML:Gt(i,"js_qa_item_content").innerHTML}ai=si,ai&&(Di(!0),gi(3))})),$e.on(Zt,"click",(()=>{Ni(),yi({EventType:2}),gi(1)})),$e.on(document.body,"tap",".js_qa_like",(e=>{const t=e.delegatedTarget,i=Fe.hasClass(t,"praised");Fe.toggleClass(t,"praised");const n=Gt(t,"js_like_num");let a=(parseInt(n.dataset.num,10)||0)+(i?-1:1);a=a>=0?a:0,n.innerHTML=tt.formatReadNum(a),n.dataset.num=a,gi("2"===t.dataset.type?6:5),Ne({url:"/mp/qna?action=like",type:"POST",data:Object.assign({like_type:t.dataset.type,op:i?2:1,answer_id:t.dataset.id,reply_id:t.dataset.id},mi)})})),$e.on(document.body,"tap",".js_delete_answer",(e=>{const t=e.delegatedTarget;gi(7),setTimeout((()=>{window.weui.confirm("确定删除讨论内容吗？",{buttons:[{label:"取消",type:"default"},{label:"删除",type:"primary",onClick(){Ne({url:"/mp/qna?action=del_answer",type:"POST",dataType:"json",data:Object.assign({answer_id:t.dataset.id},mi),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode.parentNode;e&&Fe.hasClass(e,"js_qa_list_item")&&e.parentNode.removeChild(e)}else fi()}})}}]})}),50)})),$e.on(document.body,"tap",".js_delete_reply",(e=>{const t=e.delegatedTarget;gi(8),setTimeout((()=>{window.weui.confirm("确定删除回复吗？",{buttons:[{label:"取消",type:"default"},{label:"删除",type:"primary",onClick(){Ne({url:"/mp/qna?action=del_reply",type:"POST",dataType:"json",data:Object.assign({reply_id:t.dataset.id},mi),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode;if(e&&Fe.hasClass(e,"js_qa_reply_item")){const t=e.parentNode;t.removeChild(e),t.children.length||(wi(t.parentNode),wi(Gt(t.parentNode,"js_write_reply")),hi(Gt(t.parentNode.parentNode,"js_write_reply")))}}else fi()}})}}]})}),50)})),Be.bindDebounceScrollEvent(t),t()}())}}))}};let Li=[],Mi=0;const qi=2;function Oi(e,t){const i="object"==typeof e?e:Li[e];if(i.dataset.hasBanner)return;const n=document.createElement("div");n.dataset.hasBanner=1,n.style="background-color: var(--weui-BG-1);font-size: 14px;color: var(--weui-FG-2);text-align: left;margin-top: 20px;margin-bottom: 4px;padding: 4px 8px 6px 8px;border-radius:4px;";const a=document.createElement("span");a.style="color: var(--weui-FG-0);padding: 2px;display: inline-block;vertical-align: middle; width: 20px;height: 20px;margin-right: 4px; background-size: cover;background-position: center center;-webkit-mask: url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20'%3E  %3Cpath fill-opacity='.3' fill-rule='evenodd' d='M10 1.667a8.333 8.333 0 1 1 0 16.666 8.333 8.333 0 0 1 0-16.666zm-.004 11.115a.732.732 0 0 0-.746.735c0 .416.33.735.746.735a.73.73 0 0 0 .752-.735.73.73 0 0 0-.752-.735zm.638-7.669h-1.27l.091 6.33h1.088l.091-6.33z'/%3E%3C/svg%3E\") no-repeat 50% 50%;mask: url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20'%3E  %3Cpath fill-opacity='.3' fill-rule='evenodd' d='M10 1.667a8.333 8.333 0 1 1 0 16.666 8.333 8.333 0 0 1 0-16.666zm-.004 11.115a.732.732 0 0 0-.746.735c0 .416.33.735.746.735a.73.73 0 0 0 .752-.735.73.73 0 0 0-.752-.735zm.638-7.669h-1.27l.091 6.33h1.088l.091-6.33z'/%3E%3C/svg%3E\") no-repeat 50% 50%;background-color: currentColor;";const o=document.createElement("span");o.style="display: inline-block;line-height: 14px;vertical-align: middle;",o.innerHTML=t,n.appendChild(a),n.appendChild(o),i.parentNode.insertBefore(n,i,null),i.dataset.hasBanner=1}function zi(e,t,i){const n=e.length,a=[...Array(n)].map((()=>"〇")).join(""),{childNodes:o}=t;let s=i;for(let r=0;r<o.length;r++){const e=o[r];3===e.nodeType?s>e.data.length?s-=e.data.length:e.data=e.data.slice(0,s).concat(a).concat(e.data.slice(s+n)):1===e.nodeText&&(s-=e.innerText&&e.innerText.length||0)}}function Wi(e,t,i){const n=e.length,{$node:a,realOffset:o}=st.findChildIndex(t,i);try{a.splitText(o)}catch(d){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","splitText Error",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{type:"disputeText textNode",data:e,cursor:i}})}const s=a.nextSibling;try{s.splitText(n)}catch(d){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","splitText Error",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{type:"disputeText nextSibling",data:e,cursor:i}})}const r=document.createElement("span");r.style="background-color: rgba(0,0,0,0.10);",r.appendChild(s.cloneNode(!0)),s.parentNode.replaceChild(r,s)}function $i(e,t){const i=document.createElement("span");i.style="position:relative;display: inline-block;";const n=document.createElement("span");n.style="\n            position: absolute;\n            top: 4px;\n            left: 4px;\n            display: inline-block;\n            vertical-align: middle;\n            width: 24px;\n            height: 24px;\n            background-size: cover;\n            background-image: url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23FFF' fill-rule='evenodd' d='M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2zm-.004 13.339a.878.878 0 0 0-.896.882c0 .499.396.882.896.882.512 0 .902-.383.902-.882 0-.5-.39-.882-.902-.882zm.765-9.203h-1.524l.11 7.596h1.305l.11-7.596z'/%3E%3C/svg%3E\");\n    ";const a=t.parentNode;i.appendChild(t.cloneNode(!1)),a.replaceChild(i,t),i.appendChild(n)}function Hi(e,t){t.style.filter="blur(10px)",t.style["-webkit-filter"]="blur(10px)"}function Ui(e,t){const{data:i,meta:n,index:a,idx:o}=e,s=t.data,r=(n||"")+i;if(-1===s.indexOf(r))return{hit:!1};const d=st.getNodeByIndex(Li[o],a);d?Mi++:"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","text node cannot find",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{anchor:e,wholeText:s}});const l=d&&d.innerText.indexOf(r)+(n||"").length;return{hit:!!d,$hitDom:d,cursor:l}}function Fi(e,t){const{index:i,idx:n,data:a}=e,o=Li[n].querySelectorAll("img")[i];return(o&&(o.getAttribute("data-src")||o.getAttribute("src")))===a?(Mi++,{hit:!0,$hitDom:t,cursor:0}):{hit:!1}}function Vi(e,t){return(i,n,a)=>{const{hit:o,$hitDom:s,cursor:r}=i(e,t);o&&(n(e.data,s,r),a())}}function Ji(e,t){if(!e)return null;const{type:i,data:n,meta:a}=t;if(i===rt.text){const t=e.innerText||"",i=(a||"")+n;if(-1!==t.indexOf(i)){return{cursor:t.indexOf(i)+(a||"").length,node:e}}}if(i===rt.img){if((e&&(e.getAttribute("data-src")||e.getAttribute("src")))===n.replace(/&amp;/g,"&"))return{cursor:0,node:e}}return null}function Ki(e,t){Li=st.getParaList(e,{getNestedStructure:!0,removeIgoreEle:!1});const i=(n="idx",t.reduce(((e,t)=>(void 0===t[n]||(e[t[n]]||(e[t[n]]=[]),e[t[n]].push(t)),e)),{}));var n;Li&&((Li||[]).forEach(((e,t)=>{const n=i[t];n&&n.length>0&&(Oi(t,(n[0],'以下内容存在争议 <a style="color: var(--weui-LINK);" target="_blank" href="https://mp.weixin.qq.com/s/_2kC-fXw7UjneZSrsC9CVQ">了解更多</a>')),function(e,t){const i=[],n=[...e];i.push(t);let a=null;const o=()=>{a=n.shift()};for(o();i.length>0&&n.length>=0&&a;){const e=i.pop();if(!e)continue;if(!a)continue;const{nodeType:t,tagName:n}=e,s=Vi(a,e);if(3===t){a.type===rt.text&&s(Ui,a.status===qi?zi:Wi,o);continue}if(1===t&&n===dt){a.type===rt.img&&s(Fi,a.status===qi?Hi:$i,o);continue}const r=e.childNodes;for(let a=r.length-1;a>=0;a--)i.push(r[a])}}(n,e))})),t&&t.length!==Mi&&"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","totalHit",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{totalHit:Mi,anchors:t}}))}function Xi(e,t){const i=[],n=[],a=[],o={};t.forEach(((t,s)=>{const{selector:l,index:c,total:p}=function(e){if(!e)return{};const[t,i]=e.split("|"),[n,a]=i.split(" ");return{selector:t.replace(/&gt;/g,">"),total:1*n,index:1*a}}(t.selector);let _=o[l]||[];if(0===_.length)try{_=e.querySelectorAll(l),o[l]=_}catch(y){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","splitText Error",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{anchor:t}})}let m=c,u=c;const w=[];let h=null,g=0,f=0;for(w.push(_[c]);w.length;){const e=Ji(w.pop(),t);if(f++,e&&e.node){h=e.node,g=e.cursor;break}m-1>=0&&_[m-1]&&(w.push(_[m-1]),m-=1),u+1<_.length&&_[u+1]&&(w.push(_[u+1]),u+=1)}h?(a.push({anchor:t,node:h,cursor:g}),function(e,t){const i=st.getPureBlockNode(e);i&&Oi(i,'以下内容存在争议 <a style="color: var(--weui-LINK);" target="_blank" href="https://mp.weixin.qq.com/s/_2kC-fXw7UjneZSrsC9CVQ">了解更多</a>')}(h)):l&&-1!==l.lastIndexOf(">")&&i.push(d(r({},t),{selector:l&&l.slice(0,l.lastIndexOf(">"))+`|${p} ${c}`})),n[s]=f})),a.forEach((e=>{!function(e,t,i){const{type:n,data:a,status:o}=e;o===qi&&(n===rt.text&&zi(a,t,i),n===rt.img&&Hi(0,t))}(e.anchor,e.node,e.cursor)})),i.length&&(Xi(e,i),"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","missNodes",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{missNodes:i}})),"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Info","querycount",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{countList:n}})}var Gi={init:function(e,t){let i=[],n=[];t.forEach((e=>{e.selector?n.push(e):i.push(e)})),function(e,t){Xi(e,t)}(e,n),i.length>0&&Ki(e,i)}};const Yi=function(e,t){let i=!1,n=e;if(e===t)i=!0;else for(;n.parentNode&&(n=n.parentNode,1!==n.nodeType||"body"!==n.tagName.toLowerCase());)if(n===t){i=!0;break}return i},Qi=function(e){this.biz=e.biz,this.logid=e.logid,this.baseData=e.baseData,this.isPaySubscribe=e.isPaySubscribe,this.container=e.container,this.totalLength=this.container.innerText.length,this.initEvent()};Qi.prototype.initEvent=function(){$e.on(document,"copy",(()=>{const e=[].concat(this.baseData),t=this.getContentData().trim();t.length&&(e.push(this.totalLength),e.push(""),e.push(t.length),e.push(this.isPaySubscribe),this.report(e.join(",")))}))},Qi.prototype.getContentData=function(){const e=document.getSelection(),t=this.container;let i="";if(e&&e.rangeCount){const n=e.getRangeAt(0);if(!n.collapsed){const a=n.startContainer,o=n.startOffset,s=n.endContainer,r=n.endOffset,d=Yi(a,t),l=Yi(s,t);if(d&&l)i=n.toString();else if(d||l){const e=document.createRange();e.setStart(a,o),e.setEnd(s,r),!l&&e.setEndAfter(t),!d&&e.setStartBefore(t),i=e.toString()}else if(e.containsNode&&e.containsNode(t,!0)){const e=document.createRange();e.setEndAfter(t),e.setStartBefore(t),i=e.toString()}}}return i},Qi.prototype.report=function(e){const t=this.biz,i=this.logid;Ne({url:"/mp/webcommreport?action=report&report_useruin=1&__biz="+t,type:"POST",data:{logid:i,buffer:e},async:!1,timeout:2e3})};let Zi=null;if(window.parent!==window){let e=function(e){let t;console.log("[IFRAME RECEIVE MESSAGE]: ",e),e.origin?t=e.origin:e.originalEvent&&(t=e.originalEvent.origin),/^http(s)?\:\/\/finance\.qq\.com$/.test(t)&&/^http(s)?\:\/\/gu\.qq\.com$/.test(t)&&/^http(s)?\:\/\/wzq\.tenpay\.com$/.test(t)&&e.source&&(e.data,document.getElementsByTagName("body")[0],document.getElementById("activity-name"),document.getElementById("meta_content"),document.getElementById("page-content"))};document.getElementsByTagName("html")[0].style.width="1px",document.getElementsByTagName("html")[0].style.minWidth="100%",document.getElementById("js_content"),document.getElementById("img-content");let t=document.getElementById("page-content");document.getElementsByClassName("rich_media_area_extra")[0].style.display="none",Zi=function(e){console.info("postPageHeightMessage");let i=getComputedStyle(t);window.parent.postMessage({name:e,data:parseFloat(i.height)},"http://finance.qq.com"),window.parent.postMessage({name:e,data:parseFloat(i.height)},"http://gu.qq.com"),window.parent.postMessage({name:e,data:parseFloat(i.height)},"https://gu.qq.com"),window.parent.postMessage({name:e,data:parseFloat(i.height)},"https://wzq.tenpay.com")},Zi("pageHeight"),window.addEventListener("message",e,!1)}var en=Zi;const tn={copyright_top:0};function nn(e){let t=["/mp/copyrightreport?action=report&biz=",biz,"&scene=",e.scene,"&user_uin=",user_uin,"&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&mid=",window.mid,"&idx=",window.idx,"&source_biz=",window.source_biz,"&source_mid=",window.source_mid,"&source_idx=",window.source_idx,"&card_version=2","&show_appmsg_scene=",window.source,"&session_id=",window.sessionid,"&has_recommend_msg=",window.hasRecommendMsg,"&reprint_type=",window.reprint_type,"&t=",Math.random()].join("");window.isSg&&(t+="&from=sougou"),(new Image).src=t.substr(0,1024)}function an(){(window.pageYOffset||document.documentElement.scrollTop)+Be.getInnerHeight()>tn.copyright_top&&(nn({scene:"1",card_pos:"0"}),$e.off(window,"scroll",an),an=tn.copyright_top=null)}function on(e){return document.getElementById(e)}var rn={card_click_report:nn,card_pv_report:function(){if("2"==__appmsgCgiData.copyright_stat){let e=on("copyright_info"),t=on("js_article");for(;e&&t!==e;)tn.copyright_top+=e.offsetTop,e=e.offsetParent;$e.on(window,"scroll",an),an()}}};var dn='<#if(!isUpdate){#>\n<section class="js_wap_redpacketcover red_package_cover_wrp" data-coveruri="<#=data.cover_uri#>">\n<#}#>\n    \x3c!--不可操作，这里加className point_event_no--\x3e\n    \x3c!--todo 加载中加className red_package_cover__inner__loading--\x3e\n    <section class="red_package_cover__inner">\n        <section class="red_package_cover__inner__main">\n            <section class="red_package_cover__body">\n                \x3c!--图片没加载处理，这里加className red_package_cover_img_loading--\x3e\n                <span class="red_package_cover_img <#if(data.is_synthetic * 1===1){#>synthetic_cover_img<#}#>" style="background-image: url(\'<#=data.receive_image#>\');"></span>\n            </section>\n            <section class="red_package_cover__foot">\n                <#if(data.status * 1===0){#>\n                <span class="red_package_cover__access-link">领取<#=data.name#>红包封面</span>\n                <#}else if(data.status * 1===1){#>\n                <span class="red_package_cover__access-link disabled">已领取红包封面</span>\n                <#}else if(data.status * 1===2){#>\n                <span class="red_package_cover__access-link disabled">红包封面已领取完</span>\n                <#}else{#>\n                <span class="red_package_cover__access-link disabled">红包封面不可领取</span>\n                <#}#>\n            </section>\n        </section>\n        <section class="red_package_cover__extend">\n            <span class="red_package_cover__extend_icon"></span>\n            <span class="red_package_cover__extend_info">微信红包封面</span>\n        </section>\n    </section>\n<#if(!isUpdate){#>\n</section>\n<#}#>';const ln={tagName:"redpacketcover",isWechat:He.isWechat,domMap:{},dataMap:{},startTime:window.page_begintime||0,screen_height:Be.getInnerHeight(),screen_num:0,pvData:[],request_id:encodeURIComponent(window.biz+";"+window.mid+";"+window.idx+";"+window.page_begintime||0),hasBindVisibility:!1,hasBindScroll:!1,needReportNum:0,reportedNum:0},cn=(e={})=>{const t=window.pageYOffset||document.documentElement.scrollTop,i=(window.logs.read_height||t)+ln.screen_height,n={BizUin:window.biz,MsgId:1*window.mid,Idx:1*window.idx,CoverUri:e.coverUri,Scene:1*window.source,Subscene:1*window.subscene,CoverStatus:1*e.coverStatus,EventType:1*e.eventType,EventScreenNum:Math.ceil(i/ln.screen_height)||1,ScreenNum:ln.screen_num,StartTimeMs:ln.startTime};Je.report(19119,n)};let pn=()=>{const e=(window.pageYOffset||document.documentElement.scrollTop)+ln.screen_height;for(let t=0;t<ln.pvData.length;t++){let i=ln.pvData[t];e>=i.start&&e<=i.end&&(ln.reportedNum++,ln.dataMap&&ln.dataMap[i.coverUri]&&(ln.dataMap[i.coverUri].reported=!0),cn({eventType:2,coverUri:i.coverUri,coverStatus:ln.dataMap[i.coverUri].status}),ln.pvData.splice(t,1),t--)}ln.reportedNum>=ln.needReportNum&&($e.off(window,"scroll",pn),ln.pvData=[],pn=null)};const _n=(e={})=>{if(!ln.isWechat)return;ln.scroll_height=document.body.scrollHeight||document.body.offsetHeight,ln.screen_num=Math.ceil(ln.scroll_height/ln.screen_height);let t=e.node;if(ln.dataMap[e.coveruri]&&1*ln.dataMap[e.coveruri].status!=-1&&!ln.dataMap[e.coveruri].reported){let i=t.getBoundingClientRect();ln.pvData.push({start:i.top+i.height/2,end:i.top+i.height/2+ln.screen_height,coverUri:e.coveruri})}ln.pvData.length>0&&(!ln.hasBindScroll&&pn&&(ln.hasBindScroll=!0,$e.on(window,"scroll",pn)),pn())};let mn=null;mn=(e={})=>{if(e.node&&e.data&&e.data.cover_uri)if(e.isUpdate)e.node.innerHTML=Ve.tmpl(dn,{data:e.data,isUpdate:!0},!1).replace(/>\s*</g,"><").replace(/^\s+/,"").replace(/\s+$/,"");else if(e.data.receive_image){const t=function(e){let t=e.node,i=e.data;return function(){let e=document.createElement("div");e.innerHTML=Ve.tmpl(dn,{data:i,isUpdate:!1},!1).replace(/>\s*</g,"><").replace(/^\s+/,"").replace(/\s+$/,"");let n=e.firstChild;t.parentNode.insertBefore(n,t.nextSibling);let a=t.parentNode.querySelector('[data-preloadingid="'+i.cover_uri+'"]');a&&a.parentNode.removeChild(a),ln.domMap[i.cover_uri]=n,((e={})=>{ln.dataMap[e.coveruri]&&$e.on(e.dom,"click",(function(){if(window.is_temp_url)new Xe({msg:"预览时不支持领取红包封面"});else if(ln.isWechat){let t=e.dom.getAttribute("data-coveruri")||"",i=t&&ln.dataMap[t]?ln.dataMap[t].redirect_url:"";i&&(cn({eventType:1,coverUri:t,coverStatus:ln.dataMap[t].status}),Ue.invoke("openUrlWithExtraWebview",{url:i,openType:1},(function(e){-1===e.err_msg.indexOf("ok")&&(location.href=i)})))}else new Xe({msg:"请在微信客户端打开"})})),!ln.hasBindVisibility&&ln.isWechat&&(ln.hasBindVisibility=!0,Be.listenStateChange({cb:function(e){"onResume"!==e.state_change&&"onResume"!==e.state||Ne({type:"GET",dataType:"json",url:"/mp/wapredpacketcover?action=get_red_packet_cover_data&__biz="+window.biz+"&mid="+window.mid+"&idx="+window.idx+"&sn="+window.sn+"&send_time="+window.send_time,timeout:1e4,success:e=>{if(e&&e.base_resp&&1*e.base_resp.ret==0&&e.red_packet_cover_data&&e.red_packet_cover_data.cover_uri_data&&e.red_packet_cover_data.cover_uri_data.length>0){const t=e.red_packet_cover_data.cover_uri_data;for(let e=0,i=t.length;e<i;e++){let i=t[e],n=ln.domMap[i.cover_uri],a=ln.dataMap[i.cover_uri];if(a&&n){let e=1*a.status,t=1*i.status;-1!==t&&e!==t&&(a.status=t,mn({data:a,node:n,isUpdate:!0}))}}}}})}}))})({dom:n,coveruri:i.cover_uri}),_n({coveruri:i.cover_uri,node:n})}}(e),i=function(){this.onload=null,this.onerror=null,t()};let n=new Image;n.onload=i,n.onerror=i,n.src=e.data.receive_image}};var un=()=>{const e=document.querySelectorAll(ln.tagName);if(window.__appmsgCgiData&&1*window.__appmsgCgiData.has_red_packet_cover==1){if(!ln.isWechat)for(let t=0,i=e.length;t<i;t++){let i=e[t],n=i.getAttribute("data-coveruri")||"",a=decodeURIComponent(n),o=decodeURIComponent(i.getAttribute("data-receiveimg")||""),s=decodeURIComponent(i.getAttribute("data-synthetic")||"");if(a=a.replace("http:","https:"),o=o.replace("http:","https:"),a&&o&&/^http(s)?:\/\/mmcomm\.qpic\.cn([\/?].*)*$/i.test(o)){let e={cover_uri:a,status:0,name:"",redirect_url:"",receive_image:o,is_synthetic:s};ln.dataMap[a]=e,mn({data:e,node:i,isUpdate:!1})}}}else e.length>0&&window.__addIdKeyReport&&window.__addIdKeyReport("27613","51",1)},wn=(e={})=>{if(!e.list||0===e.list.length)return;for(let i=0,n=e.list.length;i<n;i++){let t=e.list[i];ln.dataMap[t.cover_uri]=t}const t=document.querySelectorAll(ln.tagName);e.list.length!==t.length&&window.__addIdKeyReport&&window.__addIdKeyReport("27613","51",1),ln.needReportNum=t.length;for(let i=0,n=t.length;i<n;i++){let e=t[i],n=e.getAttribute("data-coveruri")||"",a=decodeURIComponent(n),o=ln.dataMap[a];if(o&&1*o.status!=-1){if(o.redirect_url){let e=o.redirect_url.html(!1);e=Pe.addParam(e,"request_id",ln.request_id,!0);let t=Pe.parseUrl(e);t.hash?-1===t.hash.indexOf("wechat_redirect")&&(e+="&wechat_redirect"):e+="#wechat_redirect",o.redirect_url=e}o.synthetic_widget_url?(o.is_synthetic=1,o.receive_image=o.synthetic_widget_url):o.is_synthetic=0,mn({data:o,node:e,isUpdate:!1})}}};const hn=(e,t,i,n)=>{e||(e="");const a=document.createElement("span");if(t<=i){const o=e.slice(t,i+1);n&&(a.className="js_search_highlight wx_search_highlight"),a.innerText=o}return a},gn=(e,t,i,n)=>{if(!e||!t)return;if(i>n)return;let a=t.textContent,o=a.length;i>0&&e.insertBefore(hn(a,0,i-1,!1),t),n<o-1&&e.appendChild(hn(a,n+1,o-1,!1)),e.replaceChild(hn(a,i,n,!0),t)};function fn(e,t,i){let n,a=t,o=i;const s=e=>{const t=e.childNodes.length;for(let i=0;i<t&&!(a>o);i++){let r=e.childNodes[i];if(!r)break;if(1===r.nodeType&&s(r),3===r.nodeType){let i=r.textContent,s=i.length,d=e;if(t>1&&(d=hn(i,0,s-1,!1),e.replaceChild(d,r),r=d.childNodes[0]),a>=0&&o<=s-1){gn(d,r,a,o),a=0,o=-1,n=d;break}o>s-1&&(gn(d,r,a,s-1),a<=s?(o-=s,a=0):(o-=s,a-=s))}}};return s(e),n}var yn=function(){var e=this,t=e.$createElement;return(e._self._c||t)("mp-ad-frame",{attrs:{"pos-type":e.posType},on:{"ad-frame-message":e.handleAdFrameMessage}})},bn=[];const vn={name:"mp-sponsor-ad",components:{[ht.name]:ht},data:()=>({posType:le.AD_POS.POS_SPONSOR}),methods:{handleAdFrameMessage(e){e===le.FRAME_READY&&ce.report115849(63)}}},xn={};var kn=yt(vn,yn,bn,!1,Cn,null,null,null);function Cn(e){for(let t in xn)this[t]=xn[t]}var Tn=function(){return kn.exports}(),In=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt?i("div",{staticClass:"pay__detail-wrp pay__detail-wrp_inner pay__detail-wrp_v2",attrs:{id:"js_pay_wall_wrap"}},[i("div",{staticClass:"pay__detail"},[i("div",{staticClass:"pay__detail-content"},[i("div",{staticClass:"pay__detail-summary"},[i("span",[i("a",{attrs:{id:"js_pay_num","aria-labelledby":"js_pay_num js_pay_num_txt",href:"javascript:;"},on:{click:e.onPayNumClick}},[e._v(e._s(e._f("formatNum")(e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt)))]),e._v(" 人付费")]),e.extRes.reward_total_count?i("span",[e._v("，"),i("a",{attrs:{"aria-labelledby":"js_pay_reward_num js_pay_reward_num_txt",id:"js_pay_reward_num",href:"javascript:;"},on:{click:e.onRewardNumClick}},[e._v(e._s(e._f("formatNum")(e.extRes.reward_total_count)))]),e._v(" 人赞赏")]):e._e()]),i("div",{staticClass:"pay__detail-wall-wrp",style:{width:e.wrapWidth+"px"}},[i("div",{staticClass:"pay__detail-wall",attrs:{id:"js_pay_wall"}},e._l(e.avatarList,(function(e){return i("div",{key:e.head_img_url,class:"pay__avatar-wrp "+(e.hide_status>0?"pay__avatar-mask":"")},[i("img",{attrs:{alt:"",src:e.head_img_url}})])})),0)])])])]):e._e()},Sn=[];const En={name:"mp-pay-wall",filters:{formatNum:e=>e>=1e4?"en"===window.LANG?"10k+":"1万+":e},data:()=>({perLine:I.getCountPerLine()}),computed:d(r(r({},c(["cgiData","extRes"])),c("mp-pay-read",["paySubscribeInfo"])),{total(){return 3*this.perLine},wrapWidth(){return 40*this.perLine-8},avatarList(){var e,t,i,n;return this.paySubscribeInfo?this.cgiData.isPaid&&!this.cgiData.payFreeGift?[null==(e=this.paySubscribeInfo)?void 0:e.my_head_img_info,...((null==(t=this.paySubscribeInfo)?void 0:t.pay_head_img_infos)||[]).slice(0,this.total-1)]:(null==(n=null==(i=this.paySubscribeInfo)?void 0:i.pay_head_img_infos)?void 0:n.slice(0,this.total))||[]:[]}}),methods:{onPayNumClick(){I.goUrl(`/mp/paysub?action=evaluate_show_page&__biz=${this.cgiData.biz}&product_type=${this.cgiData.productPayPackage.product_type}&product_id=${this.cgiData.productPayPackage.product_id}&sn=${this.cgiData.sn}&link=${encodeURIComponent(this.cgiData.msg_link)}&from_scene=${this.cgiData.source}&from_subscene=${this.cgiData.subscene}&is_fans=${this.cgiData.isFans}`)},onRewardNumClick(){const e=(Math.ceil((Be.getInnerHeight()-188)/42)+1)*Math.floor((innerWidth-15)/42);I.goUrl(`/mp/reward?act=getrewardheads&__biz=${this.cgiData.biz}&appmsgid=${this.cgiData.mid}&idx=${this.cgiData.idx}&sn=${this.cgiData.sn}&offset=0&count=${e}&source=1`)}}},An={};var Rn=yt(En,In,Sn,!1,jn,null,null,null);function jn(e){for(let t in An)this[t]=An[t]}var Bn=function(){return Rn.exports}(),Nn=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("button",{ref:"payPanelBtn",staticClass:"js_pay_btn js_article_bottom weui-btn weui-btn_loading",class:{btn_disabled:e.isInMiniProgram},on:{click:e.payFunc}},[e.loading?i("div",{staticClass:"js_button_loading"},[e._m(0),e._v(" 加载中 ")]):i("div",[i("i",{staticClass:"pay__icon-wecoin"}),i("span",{staticClass:"price js_pay_fee",attrs:{id:"js_pay_fee_normal"}},[e._v(e._s(e.cgiData.wecoin_amount))]),e._v(" 微信豆购买 ")])])},Dn=[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"weui-primary-loading weui-primary-loading_transparent"},[t("i",{staticClass:"weui-primary-loading__dot"})])}];const Pn={name:"mp-pay-btn",computed:r(r({},c(["cgiData"])),c("mp-pay-read",["loading","isInMiniProgram"])),methods:r({},p("mp-pay-read",["payFunc"]))},Ln={};var Mn=yt(Pn,Nn,Dn,!1,qn,null,null,null);function qn(e){for(let t in Ln)this[t]=Ln[t]}var On=function(){return Mn.exports}(),zn=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"giftBar",staticClass:"pay__gift-send_static pay__gift-send",attrs:{id:"js_pay_gift_bar"}},[i("div",{staticClass:"pay__gift-send-content"},[i("div",{staticClass:"pay__gift-send-title",attrs:{id:"js_pay_gift_bar_title"}},[e._v(" "+e._s(e.giftBarTitleText)+" ")])]),i("div",{staticClass:"pay__gift-send-btn",attrs:{id:"js_send_pay_gift"},on:{click:e.present}},[e._v("去赠送")])])},Wn=[];const $n=8+window.parseInt(window.getComputedStyle(document.documentElement).getPropertyValue("--sab"));let Hn=0,Un=0,Fn=!1,Vn=0;const Jn=window.scrollY,Kn=window.innerHeight/3,Xn={name:"mp-pay-gift",data:()=>({giftBarTitleText:"可赠送给一位朋友免费阅读"}),computed:r(r({},c(["cgiData"])),c("mp-pay-read",["paySubscribeInfo"])),mounted(){const e=window.localStorage.getItem("paySuc"),t=this.$refs.giftBar.getBoundingClientRect().top;"1"===e&&t>window.innerHeight?(window.localStorage.setItem("paySuc","0"),this.$refs.giftBar.className="pay__gift-send show",this.giftBarTitleText="已购买，可赠送给一位朋友",I.reportSend(2),$e.on(window,"scroll",this.scrollHandler),$e.on(this.$refs.giftBar,"touchstart",this.touchStartHandler),$e.on(this.$refs.giftBar,"touchmove",this.touchMoveHandler),$e.on(this.$refs.giftBar,"touchend",this.touchEndHandler)):!Fe.hasClass(this.$refs.giftBar,"show")&&t<=window.innerHeight&&(this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",I.reportSend(4))},beforeDestroy(){$e.off(window,"scroll",this.scrollHandler)},methods:{present(){if(De.os.iphone||De.os.ipad||De.os.android){let e=this.paySubscribeInfo.gift_url.html(),t="";const i=e.indexOf("#");-1!==i&&(t=e.substring(i),e=e.substring(0,i)),Fe.hasClass(this.$refs.giftBar,"pay__gift-send_static")?I.reportSend(5):I.reportSend(3),I.goUrl(`${e}&sessionid=${this.cgiData.sessionid}&enterid=${this.cgiData.enterid}&scene=${this.cgiData.source}&subscene=${this.cgiData.subscene}&biz=${this.cgiData.biz}&mid=${this.cgiData.mid}&idx=${this.cgiData.idx}${t}`)}else window.weui.alert("请使用移动端微信打开")},touchStartHandler(e){Fe.hasClass(this.$refs.giftBar,"show")&&(Fn=!0,Vn=e.touches[0].clientY,Hn=Un)},touchMoveHandler(e){e.preventDefault();const t=e.touches[0].clientY-Vn;Fe.hasClass(this.$refs.giftBar,"show")&&Fn&&(t+Hn>=0&&t+Hn<=$n?(this.$refs.giftBar.style.transform=`translate3d(0, ${t+Hn}px, 0)`,Un=t+Hn):t+Hn>$n?(this.$refs.giftBar.style.transform=`translate3d(0, ${$n}px, 0)`,Un=$n):t+Hn<0&&(this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",Un=0))},touchEndHandler(){Fn=!1,Fe.hasClass(this.$refs.giftBar,"show")&&Un===$n&&(this.$refs.giftBar.className="pay__gift-send",$e.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),$e.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),$e.off(this.$refs.giftBar,"touchend",this.touchEndHandler))},scrollHandler(){const e=document.getElementById("js_pay_wall_wrap").getBoundingClientRect();e.top+e.height-48<=window.innerHeight?(this.giftBarTitleText="可赠送给一位朋友免费阅读",this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",$e.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),$e.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),$e.off(this.$refs.giftBar,"touchend",this.touchEndHandler),$e.off(window,"scroll",this.scrollHandler),I.reportSend(4)):window.scrollY-Jn>Kn&&(this.$refs.giftBar.className="pay__gift-send")}}},Gn={};var Yn=yt(Xn,zn,Wn,!1,Qn,null,null,null);function Qn(e){for(let t in Gn)this[t]=Gn[t]}var Zn=function(){return Yn.exports}();const ea={};var ta=yt({name:"mp-pay-read-qrcode",computed:{src(){if(He.isWindows||He.isMac&&!He.isIOS){return`/mp/paysubqrcode?action=get_article_qrcode&__biz=${window.biz}&mid=${window.mid}&idx=${window.idx}&sn=${window.sn}#wechat_redirect`}return""}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pay__notice-qrcode js_pay_qrcode_wrap js_pay_fee_display"},[i("div",{staticClass:"pay__qrcode-wrp"},[i("img",{staticClass:"js_pay_qrcode",attrs:{src:e.src}})]),i("div",{staticClass:"pay__qrcode-title"},[e._v("微信扫一扫付费阅读本文")])])}),[],!1,ia,null,null,null);function ia(e){for(let t in ea)this[t]=ea[t]}var na=function(){return ta.exports}(),aa=function(){var e=this,t=e.$createElement,i=e._self._c||t;return 1!==e.cgiData.isPayTopic?i("div",{staticClass:"pay pay__notice",class:{pay__notice_largeFont:e.addLargeFontStyle},attrs:{id:"js_pay_panel_bottom"}},[i("div",{staticClass:"pay__notice-intro"},[i("div",{ref:"content",staticClass:"pay__intro-content"},[i("p",{staticClass:"pay__notice-title"},[e._v(" 可试读"+e._s(e.cgiData.preview_percent)+"% ")]),i("div",{staticClass:"pay__notice-desc",attrs:{id:"js_pay_panel_bottom_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")])]),i("div",{staticClass:"pay__notice-btn-wrp"},[i("mp-pay-btn",{ref:"button"}),i("mp-pay-read-qrcode")],1)])]):i("div",{staticClass:"pay pay__notice pay__topic-notice",attrs:{id:"js_pay_topic_panel_bottom"}},[i("div",{staticClass:"pay__notice-intro"},[i("div",{staticClass:"pay__intro-content"},[i("div",{staticClass:"pay__notice-desc"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),i("p",{staticClass:"pay__notice-title"},[e._v(e._s(e.cgiData.payTopicTitle))])]),i("div",{staticClass:"pay__notice-btn-wrp"},[i("button",{staticClass:"js_pay_topic_btn weui-btn",class:{btn_disabled:e.cgiData.payTopicRemoveFlag>0},attrs:{"data-url":e.topicLink},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")]),i("mp-pay-read-qrcode")],1)])])},oa=[];const sa={name:"mp-pay-read-bottom",components:{[na.name]:na,[On.name]:On},props:{payTopicNoticeText:{type:String,default:""},visible:{type:Boolean}},data:()=>({addLargeFontStyle:!1}),computed:r(r(r({},c(["cgiData"])),c("mp-pay-read",["wecoinText","loading"])),_("mp-pay-read",["topicLink"])),created(){this.unwatchVisible=this.$watch("visible",(e=>{if(e){const e=this.$refs.button.$el.getBoundingClientRect().height,t=this.$refs.content.getBoundingClientRect().height;this.addLargeFontStyle=t/e>108/52,this.unwatchVisible()}}))},methods:r({},p("mp-pay-read",["payFunc","goBuyTopic"]))},ra={};var da=yt(sa,aa,oa,!1,la,null,null,null);function la(e){for(let t in ra)this[t]=ra[t]}var ca=function(){return da.exports}(),pa=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pay__wecoin-entry"},[i("i",{staticClass:"pay__icon-wecoin"}),i("span",{staticClass:"price",attrs:{id:"js_wecoin_remain"}},[e._v(e._s(e.wecoinRemain))])])},_a=[];const ma={name:"mp-buy-wecoin-btn",computed:r({},c("mp-pay-read",["wecoinRemain"]))},ua={};var wa=yt(ma,pa,_a,!1,ha,null,null,null);function ha(e){for(let t in ua)this[t]=ua[t]}var ga=function(){return wa.exports}(),fa=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__edu-modal","has-header":!1,top:e.top+"px"},on:{hide:e.hideEduTipsCb},scopedSlots:e._u([{key:"footer",fn:function(){return[i("a",{staticClass:"weui-btn weui-btn_default",on:{click:e.hideEduTipsCb}},[e._v("我知道了")])]},proxy:!0}])},[i("div",{staticClass:"pay__wecoin-edu-profile"},[i("div",{staticClass:"pay__wecoin-edu-title"},[e._v(" 可在「我>个人信息>微信豆」页面，查看微信豆消费明细。 ")]),i("div",{staticClass:"pay__wecoin-edu-pic"},[i("div",{staticClass:"pay__wecoin-edu-avatar"},[i("img",{attrs:{src:e.payEduTips&&e.payEduTips.userImgUrl}})]),i("div",{staticClass:"pay__wecoin-edu-nic"},[e._v(" "+e._s(e.payEduTips&&e.payEduTips.userNickname)+" ")])])])])},ya=[];const ba={name:"mp-pay-edu-tips",components:{[pe.name]:pe},computed:d(r(r({},c(["cgiData"])),c("mp-pay-read",["payEduTips"])),{top:()=>window.innerHeight-467}),methods:d(r({},m("mp-pay-read",["setWecoinRemain","setPayLock","setPayEduTips"])),{hideEduTipsCb(){this.$refs.bottomModal.hide(),Ct.show(),Ue.invoke("getWCCoinBalance",{},(e=>{Ct.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1?(this.setWecoinRemain(e.balance),this.$emit("show-confirm")):this.setPayLock(!1)})),this.setPayEduTips(d(r({},this.payEduTips),{firstWecoinRecharge:0}))},show(){this.$refs.bottomModal.show()}})},va={};var xa=yt(ba,fa,ya,!1,ka,null,null,null);function ka(e){for(let t in va)this[t]=va[t]}var Ca=function(){return xa.exports}(),Ta=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__bottom-modal","has-btn":"","auto-height":""},on:{submit:e.buyWecoin,hide:function(t){return e.setPayLock(!1)}},scopedSlots:e._u([{key:"btn",fn:function(){return[i("mp-buy-wecoin-btn")]},proxy:!0},{key:"footer",fn:function(){return[i("div",[e.needTopup?i("div",{ref:"footerTerm",staticClass:"pay__wecoin-term weui-cells_checkbox",attrs:{id:"js_wecoin_term"},on:{click:e.onTermClick}},[i("label",{attrs:{for:"js_wecoin_term_check"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.agreeStat,expression:"agreeStat"}],ref:"wecoinCheck",staticClass:"weui-check",attrs:{id:"js_wecoin_term_check",type:"checkbox"},domProps:{checked:Array.isArray(e.agreeStat)?e._i(e.agreeStat,null)>-1:e.agreeStat},on:{change:function(t){var i=e.agreeStat,n=t.target,a=!!n.checked;if(Array.isArray(i)){var o=e._i(i,null);n.checked?o<0&&(e.agreeStat=i.concat([null])):o>-1&&(e.agreeStat=i.slice(0,o).concat(i.slice(o+1)))}else e.agreeStat=a}}}),i("i",{staticClass:"weui-icon-checked"}),e._v("同意"),i("a",{attrs:{href:"javascript:;"}},[e._v("《微信豆充值协议》")])])]):e._e(),i("div",{staticClass:"weui-half-screen-dialog__btn-area"},[i("a",{ref:"footerBtn",staticClass:"weui-btn weui-btn_primary",attrs:{disabled:e.btnDisabled},on:{click:e.onFooterBtnClick}},[e._v(e._s(e.needTopup?"去充值":"支付"))])]),i("div",{staticClass:"weui-half-screen-dialog__attachment-wrp",on:{click:e.onLinkClick}},[i("a",{staticClass:"weui-half-screen-dialog__attachment-link",attrs:{href:"javascript:;"}},[e._v("常见问题")])])])]},proxy:!0}])},[i("div",{staticClass:"pay__wecoin"},[i("div",{staticClass:"pay__wecoin-title",staticStyle:{"font-weight":"normal"},attrs:{id:"js_wecoin_title"}},[e._v(" "+e._s(e.wecoinTitle)+" ")]),i("div",{staticClass:"pay__wecoin-content pay__wecoin-content-price"},[i("i",{staticClass:"pay__icon-wecoin"}),i("span",{staticClass:"price",attrs:{id:"js_wecoin_price"}},[e._v(e._s(e.wecoinPrice))])]),i("div",{ref:"wecoinTipsDom",staticClass:"pay__wecoin-tips",attrs:{id:"js_wecoin_tips"}},[e._v(" "+e._s(e.wecoinTips)+" ")])])]),i("mp-pay-edu-tips",{ref:"eduTipsModal",on:{"show-confirm":function(t){return e.$refs.bottomModal.show()}}})],1)},Ia=[];const Sa={name:"mp-pay-confirm",components:{[pe.name]:pe,[Ca.name]:Ca,[ga.name]:ga},props:{title:{type:String,default:""}},data:()=>({agreeStat:!1}),computed:d(r(r({},c(["cgiData"])),c("mp-pay-read",["wecoinRemain","payEduTips","encodeRespBuff"])),{needTopup(){return this.wecoinRemain<this.cgiData.wecoin_amount},btnDisabled(){return this.needTopup&&!1===this.agreeStat},wecoinTitle(){return this.needTopup?"微信豆不足，购买全文还需支付":"购买全文"},wecoinPrice(){return this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:this.cgiData.wecoin_amount},wecoinTips(){return`售价 ${this.wecoinPrice/10}元`}}),methods:d(r(r({},m("mp-pay-read",["setPayLock","setWecoinRemain"])),p("mp-pay-read",["paySuc","pollCheck"])),{onLinkClick(e){e&&e.preventDefault(),S.reportPayAppmsg(17),Ue.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1})},onTermClick(e){"A"===e.target.tagName&&Ue.invoke("openUrlWithExtraWebview",{url:this.cgiData.paySubscribeInfo.agreement_url.htmlDecode(),openType:1})},onTermCheckboxToggle(e){const{footerBtn:t}=this.$refs;e.target.checked?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")},show(){this.$refs.bottomModal.show()},hide(){this.$refs.bottomModal.hide()},onFooterBtnClick(){if(this.$refs.footerBtn.getAttribute("disabled"))return;const{wecoin_amount:e}=this.cgiData;Le.log(`[Appmsg] pay process 5 wecoinAmountRemain=${this.wecoinRemain} wecoin_amount=${e}`),this.needTopup?(this.hide(),setTimeout((()=>{S.reportPayAppmsg(19),Le.log("[Appmsg] pay process 6.1 buyWCCoin");const e=e=>{Ct.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.needTopup?this.show():this.consumeWCCoin())},t={businessId:2,scene:4,panelShowType:"present",diffWecoinCount:this.cgiData.wecoin_amount>this.wecoinRemain?this.cgiData.wecoin_amount-this.wecoinRemain:0};He.isAndroid&&He.gtVersion("8.0.18",!0)&&(t.mode=2,t.agreementVersion=this.cgiData.paySubscribeInfo.agreement_version,t.customCount=this.cgiData.wecoin_amount-this.wecoinRemain,t.productId=this.cgiData.paySubscribeInfo.recharge_product_id),Ue.invoke("buyWCCoin",t,(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?He.isIOS&&He.ltVersion("8.0.17")||He.isAndroid&&He.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(Ct.show(),Ue.invoke("getWCCoinBalance",{},e)):Ue.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{Ct.show(),Ue.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)):(this.hide(),this.consumeWCCoin())},consumeWCCoin(){const{encodeRespBuff:e}=this;Le.log(`[Appmsg] pay process 3 can_use_wecoin=${this.cgiData.can_use_wecoin}`),Le.log("[Appmsg] pay process 4 on payBtn tap"),Ct.show();const t=Math.round(new Date/1e3);Ue.invoke("consumeWCCoin",{buff:e,businessId:2},(i=>{console.log("consumeWCCoin res",i),this.setPayLock(!1),i&&i.err_msg&&i.err_msg.indexOf("ok")>-1?(S.reportPay(t,1,e),this.pollCheck()):i&&i.err_msg&&i.err_msg.indexOf("fail")>-1&&(S.reportPay(t,3,e,i.err_msg,i.err_code,i.err_domain),weui.alert("支付失败，请稍后再试"))}))},buyWecoin(){this.hide();const e=e=>{Ct.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.show())};setTimeout((()=>{S.reportPayAppmsg(14);const t=this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:0;Ue.invoke("buyWCCoin",{businessId:2,scene:3,panelShowType:"present",diffWecoinCount:t},(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?He.isIOS&&He.ltVersion("8.0.17")||He.isAndroid&&He.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(Ct.show(),Ue.invoke("getWCCoinBalance",{},e)):Ue.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{Ct.show(),Ue.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)}})},Ea={};var Aa=yt(Sa,Ta,Ia,!1,Ra,null,null,null);function Ra(e){for(let t in Ea)this[t]=Ea[t]}var ja=function(){return Aa.exports}(),Ba=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__wecoin-edu-modal",top:e.top+"px"},scopedSlots:e._u([{key:"footer",fn:function(){return[i("a",{staticClass:"pay__wecoin-edu-link",on:{click:e.onQuestionClick}},[e._v("常见问题")])]},proxy:!0}])},[i("div",{staticClass:"pay__wecoin-edu"},[i("div",{staticClass:"pay__wecoin-title"},[i("div",{staticClass:"pay__icon-wecoin"}),i("div",[e._v("付费内容需用微信豆支付")])]),i("div",{staticClass:"pay__wecoin-edu-desc"},[e._v(" 微信豆是用于购买微信内虚拟物品和服务的道具。 "),i("span",[e._v(e._s(e.wecoinText))]),e._v(" 微信豆还可用于购买直播间的虚拟礼物等。 ")])])])},Na=[];const Da={name:"mp-wecoin-tips",components:{[pe.name]:pe},computed:d(r({},c("mp-pay-read",["wecoinText"])),{top:()=>innerHeight-375}),methods:{onQuestionClick(e){e&&e.preventDefault(),S.reportPayAppmsg(17),Ue.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1}),this.$refs.bottomModal.hide()},show(){this.$refs.bottomModal.show()}}},Pa={};var La=yt(Da,Ba,Na,!1,Ma,null,null,null);function Ma(e){for(let t in Pa)this[t]=Pa[t]}var qa=function(){return La.exports}(),Oa=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isPaid?[i("mp-pay-wall"),e.canGift?i("mp-pay-gift"):e._e()]:[e.previewPercent>0?i("div",{staticClass:"pay__mask_static"}):e._e(),i("div",{staticClass:"pay pay__static",attrs:{id:"js_pay_panel"}},[1===e.cgiData.isPayTopic&&e.cgiData.payTopicRemoveFlag>0?i("div",{staticClass:"pay__topic-tips"},[e._v(" "+e._s(1===e.cgiData.payTopicRemoveFlag?"此内容已从合集中移除，不支持付费":"付费合集已被作者删除，不支持付费")+" ")]):e._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:!(1!==e.cgiData.isPayTopic||2===e.cgiData.payTopicRemoveFlag),expression:"!(cgiData.isPayTopic !== 1 || cgiData.payTopicRemoveFlag === 2)"}],staticClass:"pay__topic"},[i("div",{staticClass:"pay__topic-hd"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),i("div",{staticClass:"pay__topic-bd"},[i("div",{staticClass:"pay__topic-main"},[i("div",{staticClass:"pay__topic-main-wrp"},[i("div",{staticClass:"pay__topic-title"},[e._v(e._s(e.cgiData.payTopicTitle))]),i("div",{staticClass:"pay__topic-meta"},[i("span",{attrs:{id:"js_pay_topic_freq"}},[e._v(" "+e._s(e.payTopicFreqText)+" ")])])]),i("a",{class:"weui-btn weui-btn_mini "+(e.cgiData.payTopicRemoveFlag>0&&!e.isPaid?"weui-btn_disabled":"weui-btn_primary")+" weui-wa-hotarea pay__topic-btn",attrs:{id:"js_pay_topic_btn","data-url":e.topicLink,href:"javascript:;"},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")])]),i("ul",{staticClass:"pay__topic-list"},e._l(e.payTopicList,(function(t,n){return i("li",{key:t},[e._v(e._s(n+1)+". "+e._s(t))])})),0)])]),i("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.cgiData.isPayTopic,expression:"cgiData.isPayTopic !== 1"}],staticClass:"pay__main"},[e.cgiData.payDesc&&0===e.previewPercent?i("div",{staticClass:"pay__head-notice"},[e._v(" 正文需付费后才可阅读 ")]):e._e(),i("div",{staticClass:"pay__notice-btn-wrp"},[i("mp-pay-btn",{ref:"payBtn"}),0!==e.cgiData.payGiftsCount?i("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_preview_tips"}},[e._v(" "+e._s(e.previewTipsText)+" ")]):i("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")]),e.tempkey?i("div",{staticClass:"pay__preview-tips js_pay_fee_display"},[e._v(" 预览状态下不会扣费 ")]):e._e(),i("mp-pay-read-qrcode")],1)]),i("mp-pay-wall")],1),i("transition",{attrs:{name:"fade"}},[i("mp-pay-read-bottom",{directives:[{name:"show",rawName:"v-show",value:e.payReadBottomVisible,expression:"payReadBottomVisible"}],ref:"payReadBottom",attrs:{visible:e.payReadBottomVisible,"pay-topic-notice-text":e.payTopicNoticeText}})],1),i("mp-pay-confirm",{ref:"payConfirm"})],i("mp-wecoin-tips",{ref:"wecoinTipsModal"})],2)},za=[];const Wa={name:"mp-pay-read",components:{[Bn.name]:Bn,[ca.name]:ca,[na.name]:na,[ja.name]:ja,[On.name]:On,[qa.name]:qa,[Zn.name]:Zn},data:()=>({iapPriceInfo:null,payReadBottomVisible:!1}),computed:d(r(r(r({},c(["cgiData","extRes"])),c("mp-pay-read",["wecoinText","payLock","wecoinRemain","loading","isInMiniProgram","paySubscribeInfo"])),_("mp-pay-read",["isPaidLSKey","topicLink"])),{contentTextLen(){var e;return 1*(null==(e=this.cgiData.payforread_info)?void 0:e.content_plain_text_len)},canGift(){return!!this.paySubscribeInfo&&this.cgiData.payGiftsCount-this.paySubscribeInfo.gifted_count>0},payFee(){var e;return(1*(null==(e=this.cgiData.payforread_info)?void 0:e.fee)/100).toFixed(2)},isPaid(){return this.cgiData.isPaid},previewPercent(){return this.cgiData.preview_percent},payTopicNoticeText(){return 0===this.previewPercent?"_('购买合集后可阅读全文')":`购买合集后可阅读剩余${100-this.previewPercent}%`},payTopicFreqText(){const e=this.cgiData.payTopicCount,t=this.cgiData.payTopicTotalCount;return e<t?`已发表${e}个 计划发表${t}个`:`已完结 共${e}个`},payTopicList(){return this.cgiData.payTopicArticleTitles?this.cgiData.payTopicArticleTitles.slice(0,4):[]},previewTipsText:()=>/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"付费后可赠送给一位朋友免费阅读 (1元 = 7微信豆)":"付费后可赠送给一位朋友免费阅读 (1元 = 10微信豆)",tempkey(){return this.cgiData.tempkey},payFeeNormalText(){const{wecoin_amount:e,fee:t}=this.cgiData;return e>0?e:t/10}}),watch:{extRes(e){e.pay_subscribe_info&&(this.setPayEduTips({firstWecoinRecharge:1*e.pay_subscribe_info.first_wecoin_recharge,userImgUrl:e.pay_subscribe_info.user_img_url,userNickname:e.pay_subscribe_info.user_nick_name}),this.setPayGlobal({enable_custom_recharge:e.pay_subscribe_info.enable_custom_recharge,agreement_url:e.pay_subscribe_info.agreement_url,agreement_version:e.pay_subscribe_info.agreement_version,agreement_status:e.pay_subscribe_info.agreement_status,recharge_product_id:e.pay_subscribe_info.recharge_product_id,price:e.pay_subscribe_info.price}),e.pay_subscribe_info.wecoin_tips&&(He.isIOS||He.isAndroid)&&!He.isWxWork&&this.$refs.wecoinTipsModal.show())}},created(){this.iapPriceInfo=this.cgiData.iapPriceInfo},mounted(){Ue.on("onScreenShot",(()=>{Me.setSum(114217,15,1)})),Le.log(`[Appmsg] pay process 1 isPaySubscribe=${this.cgiData.isPaySubscribe}`),Ue.on("onScreenShot",(()=>{S.reportPayAppmsg(6)}));const e=He.isWindows||He.isMac&&!He.isIOS,t=document.getElementById("js_content"),i=e=>{"IMG"===e.target.tagName&&e.preventDefault()};e&&(t.addEventListener("dragstart",i),He.isWechat||t.addEventListener("contextmenu",i)),Le.log(`[Appmsg] pay process 2 isPaid=${this.isPaid}`),this.isPaid||this.initPay()},beforeDestroy(){$e.off(this.cgiData,"scroll",this.togglePayPanelBottom)},methods:d(r(r({},m("mp-pay-read",["setPayEduTips","setPayGlobal","setConfirmModal"])),p("mp-pay-read",["payFunc","goBuyTopic"])),{initPay(){const e=document.getElementById("js_pay_panel");He.isAndroid&&"1"===localStorage.getItem(this.isPaidLSKey)&&S.report110809(30),this.cgiData.jump2pay&&$e.on(window,"load",(()=>{window.scrollTo(0,e.getBoundingClientRect().top-Be.getInnerHeight()/3)})),this.setConfirmModal(this.$refs.payConfirm),this.togglePayPanelBottom(),$e.on(window,"scroll",this.togglePayPanelBottom)},togglePayPanelBottom(){const e=this.$refs.payReadBottom.$el,t=this.cgiData.isPayTopic?document.getElementById("js_pay_topic_btn"):this.$refs.payBtn.$el,{top:i}=t.getBoundingClientRect(),n=window.getComputedStyle(e);if(i+(40+parseInt(n.paddingTop,10)+parseInt(n.paddingBottom,10))>this.cgiData.innerHeight){if(1*this.cgiData.previewPercent==0)return;if(this.cgiData.isRemovedFromPayTopic&&!this.cgiData.isPaid)return;this.payReadBottomVisible=!0,this.$nextTick((()=>{Array.from(document.getElementsByClassName("js_pay_btn")).forEach((e=>{e.style.width=`${e.getBoundingClientRect().width}px`}))}))}else this.payReadBottomVisible=!1,window.is_finished_preview=1}})},$a={};var Ha=yt(Wa,Oa,za,!1,Ua,"e773a390",null,null);function Ua(e){for(let t in $a)this[t]=$a[t]}var Fa=function(){return Ha.exports}();const Va="album_read_directory_item",Ja=window.appmsg_album_info.id,Ka=10;let Xa;const Ga=`&cur_album_id=${Ja}`;function Ya(){const e=document.createElement("div"),t=document.createElement("span");return t.setAttribute("role","option"),t.innerHTML=`<span aria-label="合集：">#</span>${window.appmsg_album_info.title}`,e.appendChild(t),e.innerHTML}function Qa(){const e=document.createElement("div");e.style.position="relative",e.setAttribute("role","listbox");let t,i,n,a,o,s=[],r=!0,d=!0,l=1;function c(e,s=!1,r=!0){const d=document.createDocumentFragment();if(i)if(s){l=1;for(let t=0;t<e.length;t++)if(e[t].msgid.toString()===window.msgid.toString()&&e[t].itemidx.toString()===window.idx.toString()){l=t;break}e.forEach(((e,i)=>{e.index=n?t-(i-l):t+(i-l)}))}else r?e.forEach(((e,t)=>{e.index=n?o.index-t-1:o.index+t+1})):e.forEach(((t,i)=>{t.index=n?a.index+(e.length-i):a.index-(e.length-i)}));return e.forEach((e=>{const t=document.createElement("div");if(Fe.addClass(t,Va),e.msgid.toString()===window.mid.toString()&&e.itemidx.toString()===window.idx.toString()?Fe.addClass(t,"album_read_directory_current"):1===e.user_read_status&&(Fe.addClass(t,"album_read_directory_disabled"),Fe.addClass(t,"js_wx_tap_highlight"),Fe.addClass(t,"wx_tap_cell")),i){const i=document.createElement("span");i.className="album_read_directory_item_index",i.innerText=`${e.index}.`,t.appendChild(i)}const n=document.createElement("span");n.className="album_read_directory_title_wrp";const a=document.createElement("span");a.className="album_read_directory_title_wrp",a.innerText=e.title,n.appendChild(a),t.setAttribute("data-url",e.url),t.setAttribute("role","option");const o=document.createElement("span");if(e.is_paid){const e="已付费";Fe.addClass(o,"wx_icon_pay_tag"),Fe.addClass(o,"wx_icon_pay_tag_paid"),o.innerText=e,n.appendChild(o)}else if(e.is_pay_subscribe){const e="付费";Fe.addClass(o,"wx_icon_pay_tag"),o.innerText=e,n.appendChild(o)}t.appendChild(n),d.appendChild(t)})),d}function p(e){1*e.reverse_continue_flag||(r=!1,Xa.disablePullDownLoad()),1*e.continue_flag||(d=!1)}const _={extClass:"album_read_directory weui-half-screen-dialog_fold",hasBtn:!0,btnSlot:'<div id="js_topic_detail" class="weui-btn__word-wrp">\n                  <span class="weui-btn__word">详情</span>\n                  <i class="weui_right_arrow"></i>\n                </div>',title:Ya(),btnClickCb(){Ge({ActionType:6}),Ye(15),function(){const e=window.appmsg_album_info;if(e.link){const t=e.link.replace("#wechat_redirect",`&subscene=159&subscene=${window.source}&scenenote=${encodeURIComponent(window.location.href)}&nolastread=1#wechat_redirect`);_e.openUrlWithExtraWebview(t.htmlDecode())}}()},cb(){var s;s=s=>{Xa.hideLoading(),n=s.base_info.is_reverse,t=s.base_info.cur_article_num,i=t?1:0,e.appendChild(c(s.article_list,!0)),a=s.article_list[0],o=s.article_list[s.article_list.length-1],p(s),d||Xa.showEndLine();const r=e.childNodes[l];setTimeout((()=>{r.offsetTop+r.clientHeight>Xa.contentAreaWrp.clientHeight&&Xa.scrollTo(0,e.offsetHeight)}),200)},Ne({type:"GET",url:`/mp/appmsgalbum?action=paging&__biz=${window.biz}&album_id=${Ja}&cur_msgid=${window.msgid}&cur_itemidx=${window.idx}&count=${Ka}`,timeout:5e3,dataType:"json",success:function(e){e.base_resp&&0===e.base_resp.ret&&s(e.getalbum_resp)},error(){console.log("[error]")}})},onShow(){Ge({ActionType:4}),Ye(14)},onPullUpLoad(){d&&(Xa.showPullUpLoading(),Ne({type:"GET",url:`/mp/appmsgalbum?action=paging&__biz=${window.biz}&album_id=${Ja}&begin_msgid=${o.msgid}&begin_itemidx=${o.itemidx}&count=${Ka}`,timeout:5e3,dataType:"json",success:function(t){Xa.hidePullUpLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const i=t.getalbum_resp.article_list;p(t.getalbum_resp),e.appendChild(c(i,!1,!0)),s=s.concat(i),Xa.finishPullUpLoad(),o=s[s.length-1],1*t.getalbum_resp.continue_flag||Xa.showEndLine()}},error:function(){}}))},onPullDownLoad(){r&&(Xa.showPullDownLoading(),Ne({type:"GET",url:`/mp/appmsgalbum?action=paging&__biz=${window.biz}&album_id=${Ja}&begin_msgid=${a.msgid}&begin_itemidx=${a.itemidx}&count=${Ka}&isbackward=1`,timeout:5e3,dataType:"json",success:function(t){Xa.hidePullDownLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const i=t.getalbum_resp.article_list,n=t.getalbum_resp.continue_flag;t.getalbum_resp.continue_flag=t.getalbum_resp.reverse_continue_flag,t.getalbum_resp.reverse_continue_flag=n,p(t.getalbum_resp);const o=c(i,!1,!1),r=e.firstChild;e.insertBefore(o,r),s=i.concat(s),Xa.scrollTo(0,r.offsetTop-62),setTimeout((()=>{Xa.finishPullDownLoad()}),500),a=s[0]}},error:function(){}}))}};var m;window.appmsg_album_info.size<=4&&(_.top=screen.height/2-(screen.height-window.innerHeight)+"px"),Xa=new Xt(e,_),Xa.showLoading(),Xa.show(),(m=e)&&$e.on(m,"click",`.${Va}`,(e=>{const t=e.delegatedTarget;if(Fe.hasClass(t,"album_read_directory_current"))return;let i;i=t.dataset.url.includes("#")?t.dataset.url.replace("#",`${Ga}&scene=190#`):t.dataset.url+`${Ga}&scene=190`,Ge({ActionType:5,Url:i}),tt.jumpUrl(i,!0,{useFastLoad:!0}),Fe.addClass(t,"album_read_directory_disabled")}))}var Za=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.showCard,expression:"showCard"}],ref:"albumKeepRead",staticClass:"appmsg_card_context album_read_card"},[e.showCard?[i("div",{staticClass:"album_read_hd weui-flex",attrs:{role:"button"},on:{click:e.showBottomModal}},[i("div",{staticClass:"album_read_source"},[e._v("收录于合集 "),i("span",{staticClass:"weui-link wx_tap_link js_album_directory__name"},[e._v("#"),i("span",{domProps:{innerHTML:e._s(e.appmsgAlbumInfo.title)}})])]),i("span",{staticClass:"weui-btn__word-wrp wx_tap_link js_album_directory__size"},[e._v(" "+e._s(e.appmsgAlbumInfo.size)),i("span",{staticClass:"weui-hidden_abs"},[e._v("个")])])]),i("div",{staticClass:"album_read_bd weui-flex"},[e.appmsgAlbumExtInfo.pre_article_link?i("span",{staticClass:"album_read_nav_item album_read_nav_prev weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpPrev}},[i("span",{staticClass:"album_read_nav_inner"},[i("span",{staticClass:"album_read_nav_btn"},[e._v("上一篇")]),i("span",{staticClass:"album_read_nav_title"},[i("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.pre_article_title||""))])])])]):e._e(),e.appmsgAlbumExtInfo.next_article_link?i("span",{staticClass:"album_read_nav_item album_read_nav_next weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpNext}},[i("span",{staticClass:"album_read_nav_inner"},[i("span",{staticClass:"album_read_nav_btn"},[e._v("下一篇")]),i("span",{staticClass:"album_read_nav_title"},[i("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.next_article_title||""))])])])]):e._e()])]:e._e()],2)},eo=[];const to={name:"mp-keep-read",computed:d(r({},c({appmsgAlbumInfo:e=>e.cgiData.appmsg_album_info,appmsgAlbumExtInfo:e=>e.extRes.appmsg_album_extinfo})),{showCard(){return this.appmsgAlbumExtInfo&&(this.appmsgAlbumExtInfo.pre_article_link||this.appmsgAlbumExtInfo.next_article_link)}}),watch:{appmsgAlbumExtInfo:{handler(e){e&&(e.pre_article_link||e.next_article_link)&&this.initExposeReport()},immediate:!0}},methods:{showBottomModal(){Xa?Xa.show():Qa()},jumpPrev(){let e;Ge({ActionType:2,SubActionType:1}),Ye(12),e=this.appmsgAlbumExtInfo.pre_article_link.includes("#")?this.appmsgAlbumExtInfo.pre_article_link.replace("#",`${Ga}&scene=189#`):this.appmsgAlbumExtInfo.pre_article_link+`${Ga}&scene=189`,location.href=e.replace(/&amp;/g,"&")},jumpNext(){let e;Ge({ActionType:2,SubActionType:2}),Ye(13),e=this.appmsgAlbumExtInfo.next_article_link.includes("#")?this.appmsgAlbumExtInfo.next_article_link.replace("#",`${Ga}&scene=189#`):this.appmsgAlbumExtInfo.next_article_link+`${Ga}&scene=189`,location.href=e.replace(/&amp;/g,"&")},initExposeReport(){let e;const t=this.$refs.albumKeepRead,i=t&&t.offsetHeight/2||0;function n(){if(e)return;const n=T.getOffset(t).offsetTop||0,a=Be.getScrollTop();a+Be.getInnerHeight()>=n+i&&a<=n+i&&(Ge({ActionType:1}),Ye(11),e=!0)}Be.bindDebounceScrollEvent(n),n()}}},io={};var no=yt(to,Za,eo,!1,ao,null,null,null);function ao(e){for(let t in io)this[t]=io[t]}var oo=function(){return no.exports}(),so=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"content_bottom_area"}},[e.reprintStyle?e._e():[i("mp-sponsor-ad"),e.showReward?i("mp-reward",{attrs:{"show-author":""}}):e._e(),e.isPaySubscribe?i("mp-pay-read"):e._e()],i("mp-keep-read"),i("div",{staticClass:"rich_media_tool_area"},[i("mp-like-read-area")],1),i("mp-like-profile")],2)},ro=[];const lo={components:{[Tn.name]:Tn,[bt.name]:bt,[Fa.name]:Fa,[Tt.name]:Tt,[gt.name]:gt,[oo.name]:oo},computed:d(r({},c(["cgiData"])),{reprintStyle(){return this.cgiData.reprint_style},showReward(){return 0===this.cgiData.is_pay_subscribe||1===this.cgiData.isPaid},isPaySubscribe(){return 1*this.cgiData.is_pay_subscribe==1}})},co={};var po=yt(lo,so,ro,!1,_o,null,null,null);function _o(e){for(let t in co)this[t]=co[t]}var mo=function(){return po.exports}();const uo=(wo=["157","169"],1===window.show_related_article||wo.indexOf(window.source)>-1||wo.indexOf(window.subscene)>-1);var wo,ho=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"related_container"},[e.showList&&e.type?i("div",{ref:"jsRelatedArea",staticClass:"relate_mod_transition function_mod js_related_area",style:e.listStyle,on:{transitionend:e.transitionEndHandler}},[i("div",{ref:"jsRelatedMain",staticClass:"function_mod_index js_related_main"},["share"===e.type||"shared"===e.type?i("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v("分享此内容的人还喜欢")]):"favorite"===e.type||"favorited"===e.type?i("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v("收藏此内容的人还喜欢")]):i("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v("喜欢此内容的人还喜欢")]),i("div",{staticClass:"function_bd"},[e.list.length?i("div",{ref:"jsRelatedList",staticClass:"relate_article_index_list relate_article_list js_related_list",staticStyle:{height:"auto"}},e._l(e.list,(function(t,n){return i("div",{key:n,ref:"jsRelatedArticleItem",refInFor:!0,staticClass:"weui-media-box weui-media-box_appmsg js_related_item js_wx_tap_highlight wx_tap_cell",attrs:{"data-index":n,"data-url":t.url,"data-time":t.send_time,"data-recalltype":t.recall_type,"data-isreaded":t.is_readed,"data-bizuin":t.bizuin,"data-mid":t.mid,"data-idx":t.idx,"data-item_show_type":t.item_show_type,"data-exptype":t.exptype,"data-ext_info":t.ext_info,"data-report_info":e.reportInfo},on:{click:e.jumpArticle}},[i("div",{staticClass:"weui-media-box__bd"},[i("div",{class:["ellipsis_relate_title mask_ellipsis_wrp mask_ellipsis_auto_height",t.is_pay_subscribe?t.is_paid?"relate_article_paid":"relate_article_pay":"relate_article_default"],attrs:{role:"link",tabindex:"0","aria-labelledby":"relate_article_title_"+t.mid+"_"+t.idx+" js_a11y_comma relate_article_nickname_"+t.mid+"_"+t.idx+" js_a11y_comma relate_article_num_"+t.mid+"_"+t.idx}},[i("div",{staticClass:"mask_ellipsis_text",attrs:{"aria-hidden":"true"}},[e._v(" "+e._s(t.title)+" "),t.is_pay_subscribe&&t.is_paid?i("span",{staticClass:"pay__tag"},[e._v("已付费")]):t.is_pay_subscribe?i("span",{staticClass:"unpay__tag"},[e._v("付费")]):e._e()]),i("div",{staticClass:"mask_ellipsis",attrs:{"aria-hidden":"true"}},[i("div",{staticClass:"mask_ellipsis_text",attrs:{id:"relate_article_title_"+t.mid+"_"+t.idx}},[e._v(" "+e._s(t.title)+" "),t.is_pay_subscribe&&t.is_paid?i("span",{staticClass:"pay__tag"},[e._v("已付费")]):t.is_pay_subscribe?i("span",{staticClass:"unpay__tag"},[e._v("付费")]):e._e()]),i("div",{staticClass:"mask_ellipsis_placeholder"}),i("div",{staticClass:"mask_ellipsis_extra"},[e._v("   "),t.is_pay_subscribe&&t.is_paid?i("span",{staticClass:"pay__tag"},[e._v("已付费")]):t.is_pay_subscribe?i("span",{staticClass:"unpay__tag"},[e._v("付费")]):e._e()])])]),i("div",{staticClass:"weui-media-box__info weui-flex"},[i("div",{staticClass:"weui-media-box__info__inner weui-flex weui-flex__item"},[i("div",{staticClass:"js_profile relate_profile_nickname weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_nickname_"+t.mid+"_"+t.idx,"data-username":t.username}},[e._v(" "+e._s(t.nickname)+" ")]),i("div",{staticClass:"weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_num_"+t.mid+"_"+t.idx}},[t.old_like_num>=10?[e._v("赞 "+e._s(t.like_num_wording))]:t.is_pay_subscribe&&t.pay_cnt?[e._v("付费 "+e._s(t.pay_cnt_wording))]:t.read_num?[e._v("阅读 "+e._s(t.read_num_wording))]:e._e()],2)]),i("div",{staticClass:"relate_article_opr"},[i("button",{ref:"feedbackBtn",refInFor:!0,staticClass:"reset_btn dislike_btn js_feedback_btn weui-wa-hotarea",attrs:{type:"button"},on:{touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()},click:function(t){return t.stopPropagation(),e.showFeedback(n)}}},[e._v("不喜欢")])]),i("div",{ref:"feedbackBd",refInFor:!0,class:["feedback_dialog_wrp js_feedback_dialog",e.feedbackIdx===n?"feedback_dialog_show":""],attrs:{role:"dialog","aria-modal":"true",tabindex:"0","aria-hidden":e.feedbackIdx!==n},on:{click:function(e){e.stopPropagation()},touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()}}},[i("div",{staticClass:"weui-mask js_mask",attrs:{role:"button","aria-label":"关闭"},on:{click:e.hideFeedback}}),i("div",{class:["feedback_dialog js_dialog_wrp","top"===e.feedbackPos?"feedback_dialog_pos_top":""]},[i("div",{staticClass:"feedback_dialog_hd weui-flex"},[i("div",{staticClass:"weui-flex__item feedback_dialog_title"},[e._v("不看的原因")]),i("button",{class:["weui-btn weui-btn_primary weui-btn_mini js_submit",e.hasFeedbackReason?"":"weui-btn_disabled"],attrs:{type:"button"},on:{click:function(i){return e.submitFeedback(t)}}},[e._v("确定")])]),i("div",{staticClass:"feedback_dialog_bd"},[i("ul",{staticClass:"feedback_tag_list"},[e._l(e.reason,(function(t){return i("li",{key:t.value,class:["feedback_tag_item js_reason js_tag_item",e.feedbackReasonTacitly[t.value]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":e.feedbackReasonTacitly[t.value],"data-value":t.value},on:{click:e.chooseFeedbackReason}},[e._v(e._s(t.name))])})),e._l(t.keyword,(function(t,n){return[n<2?i("li",{key:t,class:["feedback_tag_item js_keyword js_tag_item",e.feedbackReasonKeyword[t]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":e.feedbackReasonKeyword[t],"data-value":t},on:{click:e.chooseFeedbackReason}},[e._v("对"+e._s(t)+"不感兴趣")]):e._e()]}))],2)])])])])]),i("div",{staticClass:"weui-media-box__ft"},[i("img",{directives:[{name:"wxpic-src",rawName:"v-wxpic-src",value:t.cover,expression:"item.cover"}],staticClass:"relate_article_cover"})])])})),0):[e._m(0),i("div",{staticClass:"relate_article_list relate_article_placeholder"},[i("div",{ref:"relatedPlaceholder",staticClass:"weui-media-box weui-media-box_appmsg"},[i("div",{staticClass:"weui-media-box_placeholder"})])])]],2)])]):e._e()])},go=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"relate_list_loading"},[t("span",{staticClass:"weui-primary-loading",attrs:{role:"img","aria-label":"加载中"}},[t("span",{staticClass:"weui-primary-loading__dot"})])])}];const fo=Be.getInnerHeight(),yo=100*Math.random()<1,bo=De.os.ipad||!He.isIOS&&!He.isAndroid;let vo=0;He.isIOS?vo=1:He.isAndroid&&(vo=2);const xo=[{name:"内容质量低",value:1},{name:"不看此公众号",value:2}],ko=(()=>{let e=!1;const t=[],i=n=>{e=!0,Ne({url:"/mp/relatedarticle?action=expose",type:"POST",dataType:"json",data:n,complete(){t.length?i(t.shift()):e=!1}})};return n=>{e?t.push(n):i(n)}})(),Co={name:"mp-related-article",data(){const e=this.$store.state.cgiData;return{list:[],reason:[],reportInfo:"",showList:!He.isMpapp&&1*e.item_show_type==0&&""!==e.item_show_type,unbindTransition:!1,lineHeightPx:0,listStyle:{overflow:"hidden",opacity:1,height:0,margin:0},feedbackIdx:-1,feedbackPos:"bottom",feedbackReasonTacitly:{},feedbackReasonKeyword:{}}},computed:d(r(r(r({},c(["extRes"])),c("mp-related-article",["sources"])),_("mp-like-and-share",["hasExtAppmsgStat"])),{commonReportData(){const e=this.$store.state.cgiData;return{Bizuin_from:e.biz,Msgid_from:parseInt(e.mid,10)||0,Itemidx_from:parseInt(e.idx,10)||0,Scene:parseInt(e.source,10)||0,Subscene:e.related_article_scene||parseInt(e.source,10)||0,Sessionid:e.sessionid||"",Enterid:parseInt(e.enterid,10)||0,ItemShowType:parseInt(e.item_show_type,10)||0,LoadType:this.loadType}},type(){return this.sources[0]},isPageInit(){return this.sources[1]},isFromPay(){return"pay"===this.type?1:0},loadType(){switch(this.type){case"default":default:return 0;case"favorite":return 1;case"share":return 2;case"praise":return 3;case"like":return 4;case"pay":return 5;case"reward":return 6;case"favorited":return 7;case"shared":return 8;case"praised":return 9;case"liked":return 10;case"paid":return 11;case"rewarded":return 12;case"recommend":return 13;case"force":return 14}},hasFeedbackReason(){return!!(Object.keys(this.feedbackReasonTacitly).length+Object.keys(this.feedbackReasonKeyword).length)}}),watch:{sources(){!this.__lock&&this.showList&&this.type&&(this.__lock=!0,this.$nextTick(this.loadData))}},mounted(){if(yo&&window.WX_BJ_REPORT){const e=this.$store.state.cgiData;window.WX_BJ_REPORT.BadJs.report("relatedArticleFlag","value:"+e.relatedArticleFlag,{mid:"mmbizwap:related_monitor",uin:e.user_uin})}},beforeDestroy(){this.destroy()},methods:{loadData(){const e=this.$store.state.cgiData;this.isPageInit&&(this.listStyle.transition="none"),this.__placeholderTimer=setTimeout((()=>this.showCard(3)),500),$e.on(window,"scroll",this.exposeHandler),Ne({url:`/mp/relatedarticle?action=getlist&article_url=${window.encodeURIComponent(location.href)}&__biz=${e.biz}&mid=${e.mid}&idx=${e.idx}&has_related_article_info=${e.hasRelatedArticleInfo}&is_pay=${this.isFromPay}&is_from_recommand=${uo?1:0}&scene=${this.commonReportData.Scene}&subscene=${parseInt(e.subscene,10)||0}&is_open_comment=${this.extRes.comment_enabled}`,type:"GET",dataType:"json",success:t=>{if(t&&t.base_resp&&1*t.base_resp.ret==0&&t.list&&t.list.length){const i=t.list.map((e=>(uo&&(e.url=e.url.replace(/#wechat_redirect/,`&show_related_article=1&related_article_scene=${this.commonReportData.Subscene}$&`)),e.like_num_wording=e.old_like_num?tt.formatReadNum(e.old_like_num):"",e.read_num_wording=e.read_num?tt.formatReadNum(e.read_num):"",e.pay_cnt_wording=e.pay_cnt?tt.formatReadNum(e.pay_cnt):"",e.ext_info=e.ext_info.html(!0),e)));yo&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs.report("list.length","list.length:"+i.length,{mid:"mmbizwap:related_monitor",_info:{relatedArticleFlag:e.relatedArticleFlag,isPc:bo},uin:e.user_uin}),this.list=i,this.reason=xo,this.reportInfo=t.report_info||"",this.clearPlaceholderTimeout((e=>{e?this.showCard(t.list.length):this.setLines(t.list.length),this.listStyle.opacity=1,this.listStyle.overflow="visible",this.$nextTick((()=>{this.exposeHandler(),window.ipados13_font_scale&&me(this.$refs.jsRelatedArea,window.ipados13_font_scale/100)}))}))}else this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))},error:e=>{console.error(e),this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))}})},showCard(e){if(!this.isPageInit&&this.hasExtAppmsgStat){const t=24,i=parseFloat(window.getComputedStyle(this.$refs.jsRelatedMain).marginTop),n=this.$refs.jsRelatedArea.getBoundingClientRect().top;this.setLines(e),this.$nextTick((()=>{const a=this.getHeight(e)+t+i,o=tt.getId("js_bottom_opr_right").getBoundingClientRect().top,s=n+a;if(!(o>fo||s<0)){const e=n-t;if(!(e>0&&s<fo)){const t=s-fo;e<0||t>n?ue.start({distance:e,duration:.5,end:this.exposeHandler}):ue.start({distance:t,duration:.5,end:this.exposeHandler})}}}))}else this.setLines(e);delete this.__placeholderTimer},setLines(e){const t=this.$refs.jsRelatedTitle;let i=2.25,n=0;if(t){const e=t.getBoundingClientRect().height;e>0&&(i=e/tt.getDefaultFontSize())}0===e?(this.listStyle.overflow="hidden",this.listStyle.margin="0",this.unbindTransition=!0):(window.is_like_profile_gray?this.listStyle.margin="16px 0 0":this.listStyle.margin="12px 0 0",n=6.5*e+i),this.listStyle.height=`${n}em`,this.isPageInit&&e&&this.transitionEndHandler({propertyName:"height"})},getHeight(e){return this.lineHeightPx||(this.$refs.relatedPlaceholder?this.lineHeightPx=this.$refs.relatedPlaceholder.getBoundingClientRect().height:this.lineHeightPx=tt.qs(".js_related_item",this.$refs.jsRelatedList).getBoundingClientRect().height),e*this.lineHeightPx+tt.qs(".js_related_title",this.$refs.jsRelatedMain).getBoundingClientRect().height},clearPlaceholderTimeout(e){this.__placeholderTimer?(clearTimeout(this.__placeholderTimer),delete this.__placeholderTimer,"function"==typeof e&&e(!0)):"function"==typeof e&&e(!1)},jumpArticle(e){const t=e.currentTarget.dataset,i=t.url;Me.setSum(110809,23,1),Je.report(18832,Object.assign({Actiontype:2,Type:1,Bizuin:Pe.getQuery("__biz",i),Msgid:parseInt(Pe.getQuery("mid",i),10)||0,Itemidx:parseInt(Pe.getQuery("idx",i),10)||0,Sendtimestamp:parseInt(t.time)||0,Pos:(1*t.index||0)+1,Recalltype:1*t.recalltype,Isreaded:1*t.isreaded,Mmversion:vo,ExpType:t.exptype,ExtInfo:t.ext_info,RecInfo:t.report_info},this.commonReportData)),He.isWechat&&!He.isMpapp?Ue.invoke("openWebViewUseFastLoad",{url:i,item_show_type:t.item_show_type,scene:132,openType:0},(e=>{console.log("openWebViewUseFastLoad res: ",e),e&&e.err_msg&&-1===e.err_msg.indexOf("ok")&&we(i)})):location.href=i},exposeHandler(){const e=this.$refs.jsRelatedArticleItem;if(!e)return;const t=tt.getScrollTop(),i=[];for(let n=0;n<e.length;n++){let a=e[n];1*a.dataset.hasreport!=1&&a.clientHeight+a.offsetTop>=t+a.clientHeight/2&&a.clientHeight+a.offsetTop<=t+a.clientHeight/2+Be.getInnerHeight()&&((e,t)=>{const n=e.dataset,a=n.url;n.hasreport=1,Me.setSum(110809,21,1),Je.report(18832,Object.assign({Actiontype:1,Type:1,Bizuin:Pe.getQuery("__biz",a),Msgid:parseInt(Pe.getQuery("mid",a),10)||0,Itemidx:parseInt(Pe.getQuery("idx",a),10)||0,Sendtimestamp:parseInt(n.time)||0,Pos:t+1,Recalltype:1*n.recalltype,Mmversion:vo,Isreaded:1*n.isreaded,ExpType:n.exptype,ExtInfo:n.ext_info,RecInfo:n.report_info},this.commonReportData)),ko({bizuin:n.bizuin,mid:n.mid,idx:n.idx}),i.push({item_show_type:n.item_show_type,url:a})})(a,n)}i.length&&Ue.invoke("downloadPageDataForFastLoad",{itemList:i},(e=>{console.log("downloadPageDataForFastLoad",e)}))},transitionEndHandler(e){this.unbindTransition||"height"!==e.propertyName||(this.unbindTransition=!0)},destroy(){this.showList=!1,$e.off(window,"scroll",this.exposeHandler)},showFeedback(e){const t=this.$refs.jsRelatedArticleItem[e];this.feedbackIdx=e,this.feedbackPos=Be.getInnerHeight()-t.getBoundingClientRect().bottom<268?"top":"bottom",this.$nextTick((()=>{this.$refs.feedbackBd[e].focus()}))},hideFeedback(){this.feedbackIdx=-1,this.feedbackPos="bottom",this.feedbackReasonTacitly={},this.feedbackReasonKeyword={}},submitFeedback(e){if(this.hasFeedbackReason){const t={tacitly:Object.keys(this.feedbackReasonTacitly).map((e=>1*e)),keyword:Object.keys(this.feedbackReasonKeyword)},i=this.$store.state.cgiData,n={biz_from:i.biz,mid_from:i.mid,idx_from:i.idx,recommended_biz:Pe.getQuery("__biz",e.url),mid:Pe.getQuery("mid",e.url),idx:Pe.getQuery("idx",e.url),reason:JSON.stringify(t)};Ne({type:"POST",url:"/mp/relatedarticle?action=dislike",dataType:"json",data:n,success:t=>{if(console.log(t),t&&t.base_resp&&0===t.base_resp.ret){this.hideFeedback();const t=this.list.indexOf(e);t>-1&&(this.list.splice(t,1),this.setLines(this.list.length))}else window.weui.alert("系统错误，请稍后再试")}})}},chooseFeedbackReason(e){const t=e.currentTarget,i=Fe.hasClass(t,"js_reason")?this.feedbackReasonTacitly:this.feedbackReasonKeyword,n=t.dataset.value;i[n]?this.$delete(i,n):this.$set(i,n,1)}}},To={};var Io=yt(Co,ho,go,!1,So,null,null,null);function So(e){for(let t in To)this[t]=To[t]}var Eo=function(){return Io.exports}(),Ao=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"page_bottom_area"}},[t("mp-related-article"),t("mp-bottom-ad"),t("mp-comment",{attrs:{"fetch-before-ext-resp":""}})],1)},Ro=[];const jo={components:{[Eo.name]:Eo,[ft.name]:ft,[A.name]:A}},Bo={};var No=yt(jo,Ao,Ro,!1,Do,null,null,null);function Do(e){for(let t in Bo)this[t]=Bo[t]}var Po=function(){return No.exports}();const Lo={name:"mp-context-menu",props:{bgColor:{type:String,default:"#000"},scrollEleSelector:{type:String,default:""},isShow:{type:Boolean,default:!1}},model:{prop:"isShow",event:"change"},data:()=>({scale:0,menuOptionsTailLeft:"",menuOptionsLeft:"",menuOptionsTop:"",isBottomMenuOptions:!1,nativeHeight:0,pageHeight:window.innerHeight||document.documentElement.clientHeight,menuOptionsTailWidth:0}),mounted(){this.menuOptionsTailWidth=this.$refs.menuOptionsTail.offsetWidth,this.scrollEle=this.scrollEleSelector?document.querySelector(this.scrollEleSelector):null},methods:{getScrollTop(){return this.scrollEle?this.scrollEle.scrollTop:document.body.scrollTop||document.documentElement.scrollTop},onTransitionend(){this.isShow||(this.scale=0,this.$emit("hide"))},showMenu(e){let t;const i=window.innerWidth,n=document.getSelection(),a=this.$refs.menuOptions.offsetWidth,o=this.$refs.menuOptions.offsetHeight;if(!(n.rangeCount||e&&e.length))return;let s={};if(n.rangeCount){const e=n.getRangeAt(0);s=e.getBoundingClientRect(),0===s.width&&0===s.height&&0===s.top&&0===s.left&&(s=e.commonAncestorContainer.getBoundingClientRect())}else e.forEach((e=>{const t=e.getBoundingClientRect();s={top:Math.min(s.top||9999,t.top),bottom:Math.max(s.bottom||0,t.bottom),left:Math.min(s.left||9999,t.left),right:Math.max(s.right||0,t.right)}}));s.top-o>=10&&(!De.os.ios||De.os.ios&&He.gtVersion("8.1.0",!0))?(this.isBottomMenuOptions=!1,t=s.top+this.getScrollTop()-o-10):(s.bottom,this.pageHeight,this.nativeHeight,this.isBottomMenuOptions=!0,t=s.bottom+this.getScrollTop()+10);let r=a/2,d=(s.left+s.right)/2-a/2;if(d<10)r-=10-d,d=10;else if(d+a>i-10){const e=i-10-a;r+=d-e,d=e}r-=this.menuOptionsTailWidth/2,r<8?r=8:r+this.menuOptionsTailWidth>a-8&&(r=a-8-this.menuOptionsTailWidth),this.menuOptionsTailLeft=`${r}px`,this.menuOptionsLeft=`${d}px`,this.menuOptionsTop=`${t}px`,this.$emit("change",!0),this.scale=1,this.$emit("show")},show(e){this.showMenu(e)},hide(){this.$emit("change",!1)}}},Mo={};var qo=yt(Lo,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"menuOptions",staticClass:"menu_options",class:{menu_options_pos_bottom:e.isBottomMenuOptions,menu_options_show:e.isShow},style:{left:e.menuOptionsLeft,top:e.menuOptionsTop,transform:"scale("+e.scale+")"},on:{transitionend:e.onTransitionend}},[i("div",{ref:"menuOptionsBar",staticClass:"menu_options_bar",style:{backgroundColor:e.bgColor}},[e._t("default")],2),i("div",{ref:"menuOptionsTail",staticClass:"menu_options_tail",style:{left:e.menuOptionsTailLeft,backgroundColor:e.bgColor,color:e.bgColor}})])}),[],!1,Oo,"1dfe23a8",null,null);function Oo(e){for(let t in Mo)this[t]=Mo[t]}var zo=function(){return qo.exports}(),Wo=function(){var e=this,t=e.$createElement,i=e._self._c||t;return"follow"===e.type?i("div",{staticClass:"menu_option_btn_list"},[i("span",{staticClass:"sns_opr_btn sns_opr_btn_break sns_underline_btn",class:e.hasStar?"":"underlined",attrs:{role:"button"},on:{click:function(t){return e.onStar(!0)}}},[i("span",{staticClass:"sns_opr_gap"},[e._v(e._s(e.hasStar?"取消划线":"划线"))])]),i("span",{staticClass:"sns_opr_btn sns_opr_btn_break sns_copy_btn",attrs:{role:"button",id:"copy_btn"},on:{click:e.onCopy}},[i("span",{staticClass:"sns_opr_gap"},[e._v("复制")])]),e.deviceIsPc?e._e():i("span",{staticClass:"sns_opr_btn sns_opr_btn_break sns_search_btn",attrs:{role:"button"},on:{click:e.onSouYiSou}},[i("span",{staticClass:"sns_opr_gap"},[e._v("搜一搜")])])]):i("div",{staticClass:"wx_underline_opr"},[i("button",{staticClass:"wx_underline_opr_btn sns_opr_btn sns_opr_btn_break sns_underline_btn",class:e.hasStar?"underlined":"",attrs:{type:"button"},on:{click:function(t){return e.onStar(!0)}}},[i("span",{staticClass:"sns_opr_gap"},[e._v(e._s(e.starNum||"划线"))])])])},$o=[];const Ho={name:"mp-underline-action-panel",props:{hasPraise:{type:Number,default:0},hasStar:{type:Number,default:0},praiseNum:{type:Number,default:0},starNum:{type:Number,default:0},type:{type:String,default:""},curRange:{type:Object,default:()=>({})}},data:()=>({deviceIsPc:De.os.pc,nativeRange:null}),created(){document.addEventListener("selectionchange",this.handleSelectionChange)},beforeDestroy(){document.removeEventListener("selectionchange",this.handleSelectionChange)},computed:d(r({},c(["cgiData"])),{copyHtml(){if(this.nativeRange){const e=document.createElement("div");return e.appendChild(this.nativeRange.cloneContents()),e.innerHTML}return""},copyText(){return this.nativeRange?this.nativeRange.toString():""}}),methods:{onCopy(){document.getSelection().removeAllRanges(),Ue.invoke("setClipboardData",{htmlText:this.copyHtml,data:this.copyText},(e=>{if(!/:ok$/.test(e.err_msg)){var t=window.getSelection();t.removeAllRanges(),t.addRange(this.nativeRange),document.execCommand("copy",!1,null),document.execCommand("unselect",!1,null)}}))},handleSelectionChange(){var e;window.getSelection().rangeCount&&window.getSelection().getRangeAt(0)&&!window.getSelection().getRangeAt(0).collapsed&&(this.nativeRange=null==(e=null==window?void 0:window.getSelection())?void 0:e.getRangeAt(0))},onCommentClick(){document.getSelection().removeAllRanges(),window._has_comment?this.$emit("comment"):(console.error("留言暂不可用"),window.weui.alert("该文章暂不支持留言"))},onPraise(e=!1){document.getSelection().removeAllRanges();const t=Number(!this.hasPraise);this.$emit("change-praise",t,"hasPraise"),t&&(he.$emit(ge.PRAISE_ARTICLE,null,!0),e&&Ue.invoke("vibrateShort",{style:"medium"}))},onStar(e=!1){const t=Number(!this.hasStar);this.$emit("change-praise",t,"hasStar"),t&&e&&Ue.invoke("vibrateShort",{style:"medium"}),document.getSelection().removeAllRanges()},onSouYiSou(){document.getSelection().removeAllRanges(),Ue.invoke("openWXSearchPage",{query:this.curRange.text,thirdExtParam:JSON.stringify({from:"mpWidget"})})}}},Uo={};var Fo=yt(Ho,Wo,$o,!1,Vo,"a69a8c04",null,null);function Vo(e){for(let t in Uo)this[t]=Uo[t]}var Jo=function(){return Fo.exports}(),Ko=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"discuss_container"},[e._m(0),i("div",{staticClass:"discuss_list_wrp"},[i("mp-comment-list",{directives:[{name:"show",rawName:"v-show",value:e.myComment.length,expression:"myComment.length"}],attrs:{type:"mine",list:e.myComment,"hide-quote":"","in-dialog":""},on:{"dialog-scroll":e.scrollToComment,"reset-dialog-scroll":e.resetScroll,"show-more-replies":e.showCommentDialog}}),i("mp-comment-list",{directives:[{name:"show",rawName:"v-show",value:e.electedComment.length,expression:"electedComment.length"}],attrs:{type:"elected","in-dialog":"","hide-quote":"",list:e.electedComment},on:{"dialog-scroll":e.scrollToComment,"reset-dialog-scroll":e.resetScroll,"show-more-replies":e.showCommentDialog}})],1)])},Xo=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"rich_media_extra_title_wrp weui-flex"},[i("div",{staticClass:"weui-flex__item"},[i("strong",{staticClass:"rich_media_extra_title"},[e._v("相关留言")])])])}];const Go={name:"mp-underline-comment-panel",components:{[R.name]:R},props:{showSegmentData:{type:Object,default:()=>({})}},computed:{myComment(){return this.showSegmentData.myComment},electedComment(){return this.showSegmentData.electedComment}},methods:{showCommentDialog(e){this.$emit("show-more-replies",e)},scrollToComment:h.exports.throttle((function({scrollDeltaY:e}){Math.abs(e)>1&&this.$emit("change-fixed-context-style",{bottom:-e+"px",transition:"all 0.3s ease"})}),300,{trailing:!1}),resetScroll(){this.$emit("change-fixed-context-style",{})}}},Yo={};var Qo=yt(Go,Ko,Xo,!1,Zo,"aad2ee08",null,null);function Zo(e){for(let t in Yo)this[t]=Yo[t]}var es=function(){return Qo.exports}(),ts=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wx_underline_praise_wall",on:{click:function(t){return e.$emit("show-praise-wall-modal")}}},[i("ul",{staticClass:"wx_underline_praise_list wx_underline_praise_list_horizontal"},e._l(e.showPraiseList,(function(t){return i("li",{key:t},[i("img",{staticClass:"wx_underline_praise_avatar",attrs:{src:e.userInfos[t]?e.userInfos[t].head_img:""}})])})),0),e.praiseList.length?i("span",{staticClass:"wx_underline_praise_tips"},[e._v(" "+e._s(e.userInfos[e.showPraiseList.slice(-1)[0]].nick_name)+" "),e.praiseList.length>3?[e._v("等"+e._s(e.praiseList.length)+"个朋友")]:e._e(),e._v("赞过 ")],2):e._e()])},is=[];const ns={name:"mp-underline-praise-wall",components:{[pe.name]:pe},props:{curRange:{type:Object,default:()=>({})},userInfos:{type:Array,default:()=>[]},praiseList:{type:Array,default:()=>[]}},computed:{showPraiseList(){const e=[];return this.praiseList.includes(0)&&e.push(0),this.praiseList.some((t=>(0!==t&&e.push(t),3===e.length))),e}}},as={};var os=yt(ns,ts,is,!1,ss,"01f21811",null,null);function ss(e){for(let t in as)this[t]=as[t]}var rs=function(){return os.exports}();const ds={};var ls=yt({name:"mp-underline-quote",props:{text:{type:String,default:""}},data:()=>({quoteFold:!0}),watch:{text(){this.quoteFold=!0}},methods:{expandQuote(){this.quoteFold=!1}}},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("p",{staticClass:"wx_underline_text",class:{fold:e.quoteFold},on:{click:e.expandQuote}},[e._v(e._s(e.text))])}),[],!1,cs,null,null,null);function cs(e){for(let t in ds)this[t]=ds[t]}var ps=function(){return ls.exports}(),_s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.enableUnderline?i("div",{staticClass:"underline-container"},["follow"===e.menuType?i("mp-context-menu",{ref:"contextMenu",attrs:{"bg-color":"rgb(76, 76, 76)"},on:{hide:e.onMenuHide},model:{value:e.menuVisible,callback:function(t){e.menuVisible=t},expression:"menuVisible"}},[i("mp-underline-action-panel",{attrs:{type:e.menuType,"cur-range":e.curRangeStatic,"has-praise":e.showSegmentDataStatic.hasPraise,"has-star":e.showSegmentDataStatic.hasStar},on:{"change-praise":e.onChangePraise,comment:e.onCommentClick,"delete-range":e.deleteRange}}),e.showSegmentDataStatic.userLineList&&e.showSegmentDataStatic.userLineList.length&&(1!==e.showSegmentDataStatic.userLineList.length||0!==e.showSegmentDataStatic.userLineList[0])?i("div",{staticClass:"menu_option_tips"},[e._v(" "+e._s(e.showSegmentDataStatic.userLineList.length)+"人划线 ")]):e._e()],1):e._e(),i("div",{staticStyle:{"pointer-events":"auto"}},[i("mp-bottom-modal",{ref:"bottomModal",attrs:{hideWhenScrollDown:"",hideWhenSideslip:"",autoHeight:"","max-height":e.maxBottomModalHeight,"content-area-prop-style":e.fixedContextStyle,"header-type":"slide",extClass:"wx_underline_dialog"},on:{hide:e.onFixedContextHide}},[i("div",{staticClass:"wx_underline_context"},[i("div",{ref:"underlineHd",staticClass:"wx_underline_hd"},[i("mp-underline-quote",{attrs:{text:e.showSegmentData.newRange.text}}),i("mp-underline-action-panel",{attrs:{"has-praise":e.showSegmentData.hasPraise,"has-star":e.showSegmentData.hasStar,"praise-num":e.showSegmentData.userPraiseList.length,"star-num":e.showSegmentData.userLineList.length,type:e.menuType,"cur-range":e.curRange},on:{"change-praise":e.onChangePraise,comment:e.showNativeKeyboard,"delete-range":e.deleteRange}})],1)])])],1),i("span",{ref:"tag",staticClass:"tag underline__tag",on:{transitionend:e.onTagTransitionEnd}},[e._m(0),i("span",{staticClass:"tag_text"},[e._v(" "+e._s(e._f("underlineTagFilter")(e.showTagData))+" ")])])],1):e._e()},ms=[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"tag_arrow_wrp"},[t("span",{staticClass:"tag_arrow"})])}];function us(e,t){return e.start<=t.start&&e.end>=t.end?"contain":e.start>=t.start&&e.end<=t.end?"subset":(e.start<=t.start&&e.end>t.start||e.start>=t.start&&e.start<t.end)&&"cross"}function ws(e,t=(e=>[e]),i=(e=>N(B(e)).slice(-1)[0]),n=!1){const a=JSON.parse(JSON.stringify(e));a.sort(((e,t)=>e.start!==t.start?e.start-t.start:e.end-t.end));const o=[],s=[],d=[];let l=-1,c=-1;a.forEach((e=>{const a=i(e);-1===l&&-1===c||!(!n&&e.start<c||n&&(e.start===l||e.start>l&&e.end<=c))?(o.push(r({},e)),s.push(t(e)),d.push(a),c=e.end,l=e.start):(o[o.length-1].start=Math.min(o[o.length-1].start,e.start),o[o.length-1].end=Math.max(o[o.length-1].end,e.end),s[s.length-1]=[...s[s.length-1],...t(e)],l=Math.min(e.start,l),e.end>c&&(d[d.length-1]=a,c=Math.max(e.end,c)))}));const p={};return s.forEach(((e,t)=>{e.forEach((e=>{p[B(e)]=t}))})),{originRangeList:s,bigRangeList:o,rangeTailSpan:d,origin2ResultIdx:p}}const hs={content:document.querySelector("#js_content")},gs=Be.getInnerHeight(),fs=u.extend({components:{[zo.name]:zo,[Jo.name]:Jo,[es.name]:es,[pe.name]:pe,[rs.name]:rs,[ps.name]:ps,[j.name]:j},filters:{underlineTagFilter(e){if(e){let t=e.friendPraiseList.indexOf(0);if(e.friendPraiseList.length-(t>-1?1:0))return`${tt.formatReadNum(e.friendPraiseList.length)}个朋友赞过`;t=e.friendLineList.indexOf(0);const i=e.friendLineList.length-(t>-1?1:0);if(i)return`${tt.formatReadNum(i)}个朋友划线`;if(e.userLineList.length)return`${tt.formatReadNum(e.userLineList.length)}人划线`;if(e.userPraiseList.length)return`${tt.formatReadNum(e.userPraiseList.length)}人赞过`}return""}},data:()=>({rangeMap:{},comment2Underline:{},menuVisible:!1,curRange:null,curRangeStatic:null,showSegmentDataStatic:{},menuType:"follow",fixedContextStyle:{},maxBottomModalHeight:window.innerHeight-16,enterRangeTail:[],rangeTagBlackList:{},showTagUnderlineKey:null,showTagUnderlineKeyRealtime:null,firstSelection:!0,nativeRange:null,hasBeenClickRangeList:[],selectedClickRange:null}),computed:d(r(r(r({},c(["extRes"])),c("mp-underline",["userInfos","segmentData"])),_("mp-underline",["segmentDataCooked"])),{enableUnderline(){return De.os.ios&&He.gtVersion("8.1.0",!0)&&"0"===window.item_show_type&&0!=(1024&this.extRes.test_flag)},underlineKeys(){const e=[];for(let t in this.segmentDataCooked){const i=this.segmentDataCooked[t];e.push([t,i.isPrivate])}return e},mergeRangeResult(){const e=[],t=[];Object.keys(this.rangeMap).forEach((i=>{const n=this.rangeMap[i];n.isPrivate?t.push(n):e.push(n)}));const i=ws(t),n=ws(e),a=[...i.bigRangeList,...n.bigRangeList],o=[...i.originRangeList,...n.originRangeList],s=[...i.rangeTailSpan,...n.rangeTailSpan];return ws(a,(e=>{const t=a.findIndex((t=>t.start===e.start&&t.end===e.end&&t.isPrivate===e.isPrivate));return o[t]}),(e=>{const t=a.findIndex((t=>t.start===e.start&&t.end===e.end&&t.isPrivate===e.isPrivate));return s[t]}),!0)},showSegmentData(){return this.getRangeData(this.curRange)},curRangeKey(){return this.curRange?B(this.curRange):""},showTagData(){return this.showTagUnderlineKeyRealtime&&this.rangeMap[this.showTagUnderlineKeyRealtime]?this.getRangeData(this.rangeMap[this.showTagUnderlineKeyRealtime]):null},highlightSpans(){return this.mergeRangeResult.originRangeList[this.mergeRangeResult.origin2ResultIdx[this.selectedClickRange.underlineKey]].reduce(((e,t)=>[...e,...N(B(t))]),[])}}),watch:{enableUnderline(e){e&&this.initUnderline()},curRangeStatic(e){this.showSegmentDataStatic=this.getRangeData(e)},underlineKeys:{handler(e,t){t||(t=[]),e.forEach((([e,i])=>{const n=t.findIndex((([t])=>t===e)),a=t[n];if(a)a[1]!==i&&N(e).forEach((t=>{t.className="wx_text_underline"+(i?" wx_text_underline_private":""),this.rangeMap[e].isPrivate=i})),t.splice(n,1);else{const t=D(e);this.addRange(t,i)}})),t.forEach((([e,t])=>{this.deleteRange(e)}))},immediate:!0},mergeRangeResult(e,t){const{rangeTailSpan:i}=e,{rangeTailSpan:n}=t;var a,o;(a=n,o=i,a.concat(o).filter((e=>!a.includes(e)||!o.includes(e)))).forEach((e=>{const t=this.enterRangeTail.indexOf(e);-1!==t&&this.enterRangeTail.splice(t,1)})),this.handleScroll()},enterRangeTail(){if(!this.enterRangeTail.length||this.__disableChangeUnderlineTag)return this.showTagUnderlineKey=null;const e=this.enterRangeTail.map((e=>e.underlineKey)).sort(((e,t)=>D(e).start-D(t).start));if(-1===e.indexOf(this.showTagUnderlineKey)){const t=e.find((e=>{const t=this.mergeRangeResult.originRangeList[this.mergeRangeResult.origin2ResultIdx[e]].reduce(((e,t)=>e&&0===t.isPrivate),!0),i=this.rangeTagBlackList[this.mergeRangeResult.rangeTailSpan[this.mergeRangeResult.origin2ResultIdx[e]].underlineKey];return t&&!i}));this.showTagUnderlineKey=t}this.showTagUnderlineKey&&this.enterRangeTail.forEach((e=>{e.underlineKey!==this.showTagUnderlineKey&&this.$set(this.rangeTagBlackList,e.underlineKey,!0)}))},showTagUnderlineKey(e,t){const i=this.mergeRangeResult.rangeTailSpan[this.mergeRangeResult.origin2ResultIdx[e]],n=this.mergeRangeResult.rangeTailSpan[this.mergeRangeResult.origin2ResultIdx[t]];n?this.hideTag(n):i&&this.moveTag(i)},nativeRange(e,t){if(t||(this.__needAdjustRange=!0),!e)return this.hideContextMenu("follow"),void(this.firstSelection=!0);if(hs.content&&hs.content.contains(e.startContainer)&&hs.content.contains(e.endContainer)){if(De.os.ios&&Ue.invoke("handleMPPageAction",{action:"disableContextMenu",disable:!0}),this.__needAdjustRange&&De.os.android)return this.__needAdjustRange=!1,void this.adjustRange()}else De.os.ios&&Ue.invoke("handleMPPageAction",{action:"disableContextMenu",disable:!1});this.hideContextMenu("follow"),De.os.android&&this.computeFollowContextMenu()}},beforeDestroy(){this.unbindEvent(),fe.offGetKeyboardHeight(this.onGetKeyboardHeight)},methods:d(r(r({},m("mp-underline",["setSegmentData","addRangeKeep","removeRangeKeep"])),p("mp-underline",["fetchSegment","starSegment"])),{initUnderline(){this.bindEvent(),this.fetchSegment().then((()=>{const e=parseInt(qe("start")),t=parseInt(qe("end"));if(!isNaN(e)&&!isNaN(t)){const i=B({start:e,end:t});P(i);let n=location.href;n=Oe(Oe(n,"start"),"end"),history.replaceState(null,null,n)}})),fe.onGetKeyboardHeight(this.onGetKeyboardHeight),ye((()=>{this.showTagUnderlineKey=null}))},bindEvent(){this.bindPrventSystemContext(),De.os.ios&&(window.addEventListener("touchstart",this.handleIOSTouchstart),window.addEventListener("touchend",this.handleIOSTouchend)),document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("scroll",this.handleScroll)},unbindEvent(){this.unBindPrventSystemContext(),De.os.ios&&(window.removeEventListener("touchstart",this.handleIOSTouchstart),window.removeEventListener("touchend",this.handleIOSTouchend)),document.removeEventListener("selectionchange",this.handleSelectionChange),document.removeEventListener("scroll",this.handleScroll)},bindPrventSystemContext(){hs.content.addEventListener("contextmenu",this.preventContextMenu)},unBindPrventSystemContext(){hs.content.removeEventListener("contextmenu",this.preventContextMenu)},handleIOSTouchstart(e){hs.content.contains(e.target)&&Ue.invoke("handleMPPageAction",{action:"disableContextMenu",disable:!0})},handleIOSTouchend(){setTimeout((()=>{this.__needAdjustRange?(this.__needAdjustRange=!1,this.adjustRange(),setTimeout((()=>{this.computeFollowContextMenu()}),10)):this.computeFollowContextMenu()}),10)},handleShowContextTouchend(e){this.$nextTick((()=>{this.hideContextMenu()})),document.addEventListener("selectionchange",this.handleSelectionChange),window.removeEventListener("touchend",this.handleShowContextTouchend,!0),this.highlightSpans.forEach((e=>e.classList.remove("wx_text_underline_highlight"))),this.$refs.contextMenu.$el.contains(e.target)||e.preventDefault()},computeFollowContextMenu(){const e=this.nativeRange;if(e&&hs.content.contains(e.startContainer)&&hs.content.contains(e.endContainer)){const t=L({range:e});this.showContextMenu(d(r({},t),{isPrivate:1}),"follow")}else this.hideContextMenu("follow")},onShowPraiseWallModel(){const e=this.curRange;this.$refs.bottomModal.hide(),this.setCurRange(e),this.$refs.praiseWallModal.show()},onPraiseWallModelHide(){this.$refs.bottomModal.show()},preventContextMenu(e){e.preventDefault()},onTagTransitionEnd(){if(this.showTagUnderlineKey){const e=this.mergeRangeResult.rangeTailSpan[this.mergeRangeResult.origin2ResultIdx[this.showTagUnderlineKey]];this.moveTag(e)}},adjustRange(){const e=window.getSelection();if(!e.rangeCount)return;const{startContainer:t,startOffset:i,endContainer:n,endOffset:a}=e.getRangeAt(0);if(!hs.content.contains(t)||!hs.content.contains(n))return;const o=["。","！","？","…","\n"],s=document.createRange(),r=t.textContent.slice(0,i);let d=o.reduce(((e,t)=>Math.max(r.lastIndexOf(t),e)),-1),l=t;for(;l._prev&&!g(l._prev,l)&&-1===d;)l=l._prev,d=o.reduce(((e,t)=>Math.max(l.textContent.lastIndexOf(t),e)),-1);s.setStart(l,d+1);const c=['"',"”","…"],p=n.textContent.slice(a-1>0?a-1:0);let _=o.reduce(((e,t)=>{const i=p.indexOf(t);return-1!==i?-1!==c.indexOf(p[i+1])?Math.min(i+1,e):Math.min(i,e):e}),Number.MAX_VALUE);for(l=n;l._next&&!g(l,l._next)&&_===Number.MAX_VALUE;)l=l._next,_=o.reduce(((e,t)=>{const i=l.textContent.indexOf(t)+1;return 0!==i?-1!==c.indexOf(l.textContent[i+1])?Math.min(i+1,e):Math.min(i,e):e}),Number.MAX_VALUE);l===n?s.setEnd(l,a+_>l.textContent.length?l.textContent.length:a+_):s.setEnd(l,_>l.textContent.length?l.textContent.length:_),e.removeAllRanges(),e.addRange(s)},handleSelectionChange(){var e;if(window.getSelection().isCollapsed)return this.nativeRange=null;this.nativeRange=null==(e=null==window?void 0:window.getSelection())?void 0:e.getRangeAt(0)},moveTag(e){this.showTagUnderlineKeyRealtime=this.showTagUnderlineKey,this.$refs.tag.style.top="",this.$refs.tag.style.left="",this.$refs.tag.style.marginLeft="",this.$refs.tag.style.transform="",e.appendChild(this.$refs.tag);const t=this.$refs.tag.getBoundingClientRect();this.$refs.tag.style.top=`${window.scrollY+t.top}px`,this.$refs.tag.style.left=`${t.left}px`,this.$refs.tag.style.transform="none",document.body.appendChild(this.$refs.tag),this.$nextTick((()=>{const t=innerWidth-this.$refs.tag.getBoundingClientRect().left-20-this.$refs.tag.offsetWidth;this.$refs.tag.style["margin-left"]=t<0?`${t}px`:0,this.showTag(e)}),0)},showPrivateContextMenuPreferentially(e){this.hasBeenClickRangeList.push({range:this.rangeMap[e],underlineKey:e}),this.__timer||(this.__timer=setTimeout((()=>{document.removeEventListener("selectionchange",this.handleSelectionChange),this.hasBeenClickRangeList.sort(((e,t)=>t.range.isPrivate-e.range.isPrivate)),this.selectedClickRange=this.hasBeenClickRangeList[0],this.highlightSpans.forEach((e=>e.classList.add("wx_text_underline_highlight"))),this.$nextTick((()=>{this.showContextMenu(this.selectedClickRange.range,"follow",this.highlightSpans)})),this.hasBeenClickRangeList=[],this.__timer=null,window.addEventListener("touchend",this.handleShowContextTouchend,!0)}),0))},addRange(e,t){if(e.start===e.end)return;e=d(r({},e),{text:M(e.start,e.end),isPrivate:t});const i=q(e.start,e.end,{className:"wx_text_underline"+(t?" wx_text_underline_private":""),onclick:e=>{if(window.getSelection().containsNode(e.target,!0)&&!window.getSelection().isCollapsed)return;window.getSelection().removeAllRanges(),this.showPrivateContextMenuPreferentially(i);const t=this.mergeRangeResult.rangeTailSpan[this.mergeRangeResult.origin2ResultIdx[i]];this.$set(this.rangeTagBlackList,t.underlineKey,!0)}});i&&this.$set(this.rangeMap,i,e)},deleteRange(e){e||(e=this.curRangeKey),this.rangeMap[e]&&(O(e),this.$delete(this.rangeMap,e))},showContextMenu(e,t="follow",i=[]){e.end<=e.start||(this.menuType=t,this.setCurRange(e),this.curRangeStatic=e,this.showTagUnderlineKey=null,this.__disableChangeUnderlineTag=!0,this.$nextTick((()=>{"follow"===t?this.$refs.contextMenu.showMenu(i):this.$refs.bottomModal.show()})))},hideContextMenu(e){e&&e!==this.menuType||("follow"===this.menuType?this.$refs.contextMenu.hide():this.$refs.bottomModal.hide())},onCommentClick(){const e=this.curRange,t=B(e);this.addRangeKeep({underlineKey:t}),this.showContextMenu(e,"fixed"),setTimeout((()=>{this.showNativeKeyboard()}),250)},onGetKeyboardHeight({keyboard:e,input:t}){if(!this.enableGetKeyboardHeightCb)return;const i=e+t-(gs-this.$refs.underlineHd.getBoundingClientRect().bottom);Math.abs(i)>1&&(this.fixedContextStyle={bottom:`${i}px`,transition:"all 0.3s ease"}),this.enableGetKeyboardHeightCb=!1},showNativeKeyboard(){this.$refs.bottomModal.scrollTo({top:0}),this.enableGetKeyboardHeightCb=!0,be.lockOrientation(),fe.show({type:"comment",mask:!0,disableScroll:!0,disableScrollAdjustment:!0,success:e=>{he.$emit(ge.SEND_COMMENT_BY_UNDERLINE,e)},hide:()=>{this.fixedContextStyle={},this.enableGetKeyboardHeightCb=!1,be.unlockOrientation()}})},setCurRange(e){this.curRange=e,he.$emit(ge.SET_CUR_RANGE,e)},onChangePraise(e,t){const i="follow"===this.menuType?this.curRangeStatic:this.showSegmentData.newRange;let n="follow"===this.menuType?this.showSegmentDataStatic.crossRangeKey:this.showSegmentData.crossRangeKey;if(e)i.end>i.start&&(n=this.mergeRangeResult.bigRangeList.reduce(((e,t,n)=>1===t.isPrivate&&us(t,i)?[...e,...this.mergeRangeResult.originRangeList[n]]:e),[]).map((e=>B(e))),n.forEach((e=>{this.segmentDataCooked[e][t]&&this.starSegment({underlineKey:e,likeStatus:0});const n=D(e);i.start=Math.min(n.start,i.start),i.end=Math.max(n.end,i.end)})),this.$nextTick((()=>{this.starSegment({underlineKey:B(i),likeStatus:e})})));else for(let a of n)this.segmentDataCooked[a][t]&&this.starSegment({underlineKey:a,likeStatus:e})},onFixedContextHide(){this.removeRangeKeep({underlineKey:this.curRangeKey}),this.onMenuHide()},onMenuHide(){this.__disableChangeUnderlineTag=!1,this.setCurRange(null),this.curRangeStatic=null},onShowMoreReplies(e){this.$refs.commentDialog.show(e),De.os.pc&&this.hideContextMenu()},getRangeData(e){if(!e)return d(r({},z()),{crossRangeKey:[],newRange:{start:0,end:0,text:""}});const t=B(e);let i=[];if(this.segmentDataCooked[t])i=this.mergeRangeResult.originRangeList[this.mergeRangeResult.origin2ResultIdx[t]];else for(let a=0;a<this.mergeRangeResult.bigRangeList.length;a++){if("contain"===us(this.mergeRangeResult.bigRangeList[a],e)){i=this.mergeRangeResult.originRangeList[a];break}}const n=z({crossRangeKey:i.map((e=>B(e))),isPrivate:e.isPrivate,newRange:{start:e.start,end:e.end,text:e.text}});return i.forEach((t=>{const i=B(t);t.start===e.start&&t.end&&e.end?(n.electedComment=[...(this.segmentDataCooked[i]||{}).electedComment||[],...n.electedComment],n.myComment=[...(this.segmentDataCooked[i]||{}).myComment||[],...n.myComment]):(n.electedComment=[...n.electedComment,...(this.segmentDataCooked[i]||{}).electedComment||[]],n.myComment=[...n.myComment,...(this.segmentDataCooked[i]||{}).myComment||[]]),n.friendPraiseList=Array.from(new Set([...n.friendPraiseList,...(this.segmentDataCooked[i]||{}).friendPraiseList||[]])),n.userPraiseList=Array.from(new Set([...n.userPraiseList,...(this.segmentDataCooked[i]||{}).userPraiseList||[]])),n.friendLineList=Array.from(new Set([...n.friendLineList,...(this.segmentDataCooked[i]||{}).friendLineList||[]])),n.userLineList=Array.from(new Set([...n.userLineList,...(this.segmentDataCooked[i]||{}).userLineList||[]])),n.hasPraise=n.hasPraise||this.segmentDataCooked[i].hasPraise,n.hasStar=n.hasStar||this.segmentDataCooked[i].hasStar,n.newRange.start=Math.min(t.start,n.newRange.start),n.newRange.end=Math.max(t.end,n.newRange.end),n.newRange.text=M(n.newRange.start,n.newRange.end)})),n},showTag(e){e.classList.add("wx_text_underline_tag_show"),this.$refs.tag.style.opacity=1},hideTag(e){e.classList.remove("wx_text_underline_tag_show"),this.$refs.tag.style.opacity=0},handleScroll:h.exports.throttle((function(){const{rangeTailSpan:e}=this.mergeRangeResult;e.forEach((e=>{const t=e.getBoundingClientRect().bottom/window.innerHeight;if(t>.4&&t<.88)-1===this.enterRangeTail.indexOf(e)&&this.enterRangeTail.push(e);else{const t=this.enterRangeTail.indexOf(e);-1!==t&&this.enterRangeTail.splice(t,1)}}))}),50)})}),ys={};var bs=yt(fs,_s,ms,!1,vs,"68cd7e8e",null,null);function vs(e){for(let t in ys)this[t]=ys[t]}var xs=function(){return bs.exports}();function ks(){let e={hasShowBotbar:!1,mpVideoBotH:37,showComment:!0,loverCount:{}},t={};function i(e,t){const i=t||window.location.search,n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=i.substr(i.indexOf("?")+1).match(n);return null!=a?a[2]:""}function n(t){return document.querySelector(`#js_mp_video_container_${e.iframeIdx} #${t}`)}function a(){!function(){let i=e.ratio;t.vw&&t.vh&&(i=t.vw/t.vh);const a=t.vw||e.dom.js_mpvedio.offsetWidth,o=Math.ceil(a/i),s=[kt];He.isWechat&&(De.os.iphone||De.os.android)&&new Date(1e3*window.ct)>new Date("2022/01/12 19:00:00 GMT+0800")&&s.push(Et);const l={cgiData:t,preview:!(1*t.preview!=1),isInIframe:!0,hitBizuin:t.hit_bizuin,hitVid:t.hit_vid,fromid:e.scene,oriStatus:e.ori_status,isMpVideo:t.txvideo_vid?0:t.is_mp_video,plugins:s,oriVid:e.vid,vid:t.txvideo_vid?t.txvideo_vid:e.vid,ckey:t.txvideo_vid?"":e.ckey,ckey_ad:e.ckey_ad,width:a,height:o,__biz:e.__biz,uin:e.uin,mid:e.mid,idx:e.idx,coverFit:"contain",vtitle:window.msg_title,videoTitle:window.msg_title,useFeFullscreen:!0,comment_id:e.comment_id,scene_type:0,autoplay:e.autoplay,videoMd5:t.video_md5,headImgUrl:window.round_head_img,canShareVideo:!t.isPaySubscribe,bizUserName:window.user_name,bizNickName:window.nickname,profileTabType:1,leaveReport12710Type:1,storeFactory:e=>{const t=new f.Store({modules:{[ve.name]:ve},state:d(r({},xe()),{cgiData:e}),mutations:ke()});return t.registerModule([ve.name,Ce.name],Ce),t.registerModule([ve.name,Te.name],Te),t}},c=vt();e.myPlayer=new xt({el:"#js_vue_player_"+e.iframeIdx,opt:l,store:c}),e.myPlayer.$on("player-ready",(()=>{if(e.dom.js_mpvedio.style.height="100%",(Ie.showVideoDetail()||Ie.showReprint())&&!e.hasShowBotbar){const i=n("bottom_bar");i&&(i.style.display="",e.hasShowBotbar=!0,it.postMessage({type:"addVideoIframeHeight",data:{vid:t.txvideo_vid||e.id,height:e.mpVideoBotH}}))}it.postMessage({type:"videoInited",data:{vid:e.id,ori_status:e.ori_status,hit_bizuin:t.hit_bizuin,hit_vid:t.hit_vid}})})),e.myPlayer.$on("video-ready",(()=>{it.postMessage({type:"removeVideoLoading",data:{vid:e.vid}})})),e.myPlayer.$on("fullscreenchange",(t=>{"frontend"===t.type&&(t.state&&e.dom.js_mpvedio.parentNode!==document.body?(e.dom.js_mpvedio.style="position: fixed; top: 0; width: 100%; height: 100%",e.dom.js_article.style.opacity=0,window.requestAnimationFrame((()=>{document.body.appendChild(e.dom.js_mpvedio),t.supportSwipeBack||(e.dom.js_article.style.transition="opacity .1s")}))):t.state||e.dom.js_mpvedio.parentNode===e.dom.page_content||(e.dom.page_content.appendChild(e.dom.js_mpvedio),t.supportSwipeBack?(e.dom.js_mpvedio.style="position: relative; height: 100%",e.dom.js_article.style.opacity=1):(e.dom.js_mpvedio.style="",setTimeout((()=>{e.dom.js_article.style.opacity=1}),150))))}))}()}function o(o,s){Ne({url:s,type:"GET",f:"json",success:function(s){let r={};try{r=JSON.parse(s),Me.setSum(110644,51,1)}catch(m){Me.setSum(110644,53,1)}const{vid:d,vh:l,vw:c,ratio:p,index:_}=o;t={hit_bizuin:r.hit_bizuin,hit_vid:r.hit_vid,txvideo_vid:r.txvideo_vid,txvideo_openid:r.txvideo_openid,ckey:r.ckey,ckey_ad:r.ckey_ad,video_title:r.video_title,ori_status:r.ori_status,nick_name:window.nickname,hit_username:r.hit_username,is_mp_video:r.is_mp_video,is_login:r.is_login,user_uin:r.user_uin,vh:l,vw:c,scene:window.source||window.scene||i("scene",window.location.href)||0,ratio:p,openid:r.openid,show_comment:window.show_comment,comment_id:window.comment_id,vid:d,__biz:window.biz,biz:window.biz,mid:window.mid,idx:window.idx,uin:window.uin,media_source:r.media_source,vidsn:r.vidsn,username:r.biz_user_name,preview:!!window.is_temp_url,sn:window.sn||i("sign",window.location.href)||"",source_encode_biz:window.source_encode_biz,video_md5:r.video_md5,isPaySubscribe:1*window.isPaySubscribe||0,bizNickname:window.nickname,roundHeadImg:window.round_head_img,subscene:window.subscene,enterid:1*window.enterid,sessionid:window.sessionid,channel_session_id:window.channel_session_id,real_item_show_type:window.real_item_show_type,item_show_type:window.item_show_type,clientversion:window.clientversion,devicetype:window.devicetype,isprofileblock:window.isprofileblock,iframeIdx:_},1*t.ori_status==1?e.ori_status=1:1*t.ori_status==2?e.ori_status=2:e.ori_status=3,e.showComment=1*t.show_comment==1,e.comment_id=t.comment_id,e.vid=t.vid,e.ckey=t.ckey,e.ckey_ad=t.ckey_ad,e.__biz=t.__biz,e.uin=t.uin,e.mid=t.mid,e.idx=t.idx,e.scene=t.scene||i("scene",window.location.href)||0,e.autoplay=!!e.container.getAttribute("__sec_open_auto_play__"),e.iframeIdx=t.iframeIdx,e.dom={js_article:document.getElementById("js_article"),js_mpvedio:n("js_mpvedio_wrapper_"+e.vid),page_content:n("page-content")},a(),function(){const a=n("h5_profile_btn");a&&2===t.ori_status&&$e.tap(a,(function(){const e="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz="+t.source_encode_biz+"&scene=111#wechat_redirect";He.isWindowsWechat||He.isMacWechat?location.href=e:Ue.invoke("openUrlWithExtraWebview",{url:e,openType:1},(function(t){-1===t.err_msg.indexOf("ok")&&(location.href=e)}))}));const o=n("video_detail_btn");o&&1===t.media_source&&$e.tap(o,(function(){const n=["https://mp.weixin.qq.com/mp/video?t=pages/video_detail_new","&vid=",e.vid,"&mid=",e.mid,"&__biz=",e.__biz,"&idx=",e.idx,"&sn=",window.sn||i("sign",window.location.href)||"","&vidsn=",t&&t.vidsn?t.vidsn:"","&scene=100#wechat_redirect"];e.myPlayer&&e.myPlayer.extendMpReportData({detail_click:1}),window.location.href=n.join("")}))}()},error:function(){Me.setSum(110644,52,1)}})}return{createMpVideoDom:function(t,i,n){const a=Pe.getQuery("vid",n),s=t.getAttribute("data-vw"),r=t.getAttribute("data-vh"),d=t.getAttribute("data-ratio"),l=document.createElement("span"),c=t.attributes;for(let e=c.length-1;e>=0;e--)l.setAttribute(c[e].name,c[e].value);l.id="js_mp_video_container_"+i,l.setAttribute("vid",a),l.classList.add("video_iframe"),l.style.cssText=t.style.cssText,l.style.display="none";let p=Ve.tmpl('<div id="page-content">\n  \x3c!--S 全屏播放 full_screen_mv--\x3e\n  <div id="js_mpvedio_wrapper_<#=vid#>" style="position:relative;height:100%">\n    <div class="add_bg_color appmsg_video">\n      <div id="js_video_tail_panel_<#=vid#>" class="video_tail_module video_screen_half" style="display: none;">\n        <div class="video_tail_module__hd" id="js_video_tail_hd">\n          <div class="account_info_wrp">\n            <div class="profile_info_wrp js_go_profile">\n              <img class="account_avatar" src="" alt="" id="js_tail_panel_account_avatar">\n                <div class="account_name" id="js_tail_panel_account_name"></div>\n                <div class="subscription_info subscription_success">\n                  <div class="account_subscription_tips js_subscription_success" id="js_subscription_success"\n                    style="display: none;">已关注</div>\n                  <i class="account_link_icon js_profile_icon" id="js_profile_icon"></i>\n                </div>\n            </div>\n            <div class="btn_account_subscription js_btn_account_subscription" id="js_btn_account_subscription" style="display: none;">\n              关注</div>\n          </div>\n          <div class="opr_wrp">\n            <span class="opr_item_wrp js_replay" id="js_replay">\n              <i class="opr_item refresh_icon"></i>\n              <span class="opr_item_text">重播</span>\n            </span>\n            <span class="opr_item_wrp share_item_wrp js_share_button" id="js_tail_share_button"\n              style="display: none;">\n              <i class="opr_item share_icon"></i>\n              <span class="opr_item_text">分享</span>\n            </span>\n            \x3c!--点赞后 加className selected--\x3e\n            <span class="opr_item_wrp like_item_wrp" id="js_tail_like_button" style="display: none;">\n              <i class="opr_item like_icon"></i>\n              <span class="opr_item_text">赞</span>\n            </span>\n            \x3c!-- <span class="opr_item_wrp recommend_item_wrp" id="js_tail_channel_button"\n              style="display: none;">\n              <i class="opr_item video-logo_icon"></i>\n              <span class="opr_item_text">随便看看</span>\n            </span> --\x3e\n          </div>\n        </div>\n\n        \x3c!-- 有拓展内容 --\x3e\n        <div class="have_expand" id="js_expand_area">\n        </div>\n\n        \x3c!-- 广告内容 --\x3e\n        <div class="ad_area" id="js_tail_video_ad_area">\n        </div>\n      </div>\n    </div>\n    <div id="js_vue_player_<#=index#>"></div>\n  </div>\n  \x3c!--E 视频播放器--\x3e\n  \x3c!-- S 视频社交--\x3e\n  <div id="bottom_bar" class="interact_video" style="display:none;height: 35px;">\n    <div class="inter_opr">\n      <a id="video_detail_btn" href="javascript:;" target="_blank" class="access_original">\n        视频详情\n      </a>\n    </div>\n  </div>\n</div>',{vid:a,index:i,video_h:r},!1);l.innerHTML=p;const _=t.parentNode;return _?(_.lastChild===t?_.appendChild(l):_.insertBefore(l,t.nextSibling),_.removeChild(t),e.container=l,o({iframe:l,vid:a,vh:r,vw:s,ratio:d,index:i},n),l):null}}}function Cs(){let e={txVideoReg:/^http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/,mpVideoReg:/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/,video_iframe:[],video_top:[]};function t(e){console.info("iframe_onload");let t=0;try{const i=document.getElementsByTagName("html").item(0).style["-webkit-text-size-adjust"],n=e.contentDocument;if(n){const e=n.getElementsByTagName("html").item(0);e&&(e.style["-webkit-text-size-adjust"]=i)}if(Ue.on("menu:setfont",(function(t){const i=function(e){let t=0;return e.contentDocument&&e.contentDocument.body.offsetHeight?t=e.contentDocument.body.offsetHeight:e.Document&&e.Document.body&&e.Document.body.scrollHeight?t=e.Document.body.scrollHeight:e.document&&e.document.body&&e.document.body.scrollHeight&&(t=e.document.body.scrollHeight),t}(e);e.parentElement&&0!==i&&(e.style.height=`${i}px`)})),e.contentDocument&&e.contentDocument.body.offsetHeight?t=e.contentDocument.body.offsetHeight:e.Document&&e.Document.body&&e.Document.body.scrollHeight?t=e.Document.body.scrollHeight:e.document&&e.document.body&&e.document.body.scrollHeight&&(t=e.document.body.scrollHeight),e.parentElement&&(e.style.height=t+"px"),/MSIE\s(7|8)/.test(navigator.userAgent)&&e.contentWindow&&e.contentWindow.document){let t=e.contentWindow.document.getElementsByTagName("html");t&&t.length&&(t[0].style.overflow="hidden")}en&&en.postPageHeightMessage&&en.postPageHeightMessage("updatePageHeight"),console.log("financeUtils done")}catch(i){}}let i=[].slice.call(document.getElementsByTagName("iframe")),n=[],a=Math.ceil(1e4*Math.random());window.reportVid=[];for(let s=0,r=i.length;s<r;++s)!function(i,o){let r=i.getAttribute("data-src")||"",d=i.className||"",l=i.getAttribute("src")||r;if(!r||"#"==r){let e=i.getAttribute("data-display-src");if(e&&(0==e.indexOf("/cgi-bin/readtemplate?t=vote/vote-new_tmpl")||0==e.indexOf("https://mp.weixin.qq.com/cgi-bin/readtemplate?t=vote/vote-new_tmpl"))){e=e.replace(/&amp;/g,"&");let t=e.split("&"),i=["/mp/newappmsgvote?action=show"];for(let e=0;e<t.length;e++)0!=t[e].indexOf("__biz=")&&0!=t[e].indexOf("supervoteid=")||i.push(t[e]);i.length>1&&(r=i.join("&")+"#wechat_redirect")}}if(l&&(e.txVideoReg.test(l)||e.mpVideoReg.test(l))||i.getAttribute("data-mpvid")&&i.getAttribute("data-mpvid").startsWith("wxv_")){if(Se.isShowMpVideo()||e.mpVideoReg.test(l)){let t=Pe.getQuery("vid",r)||i.getAttribute("data-mpvid");if(!t)return;let n=i.getAttribute("data-vw"),s=i.getAttribute("data-vh");"qq.com"==document.domain&&((new Image).src="https://badjs.weixinbridge.com/badjs?id=139&level=4&from="+window.encodeURIComponent(window.location.host)+"&msg="+window.encodeURIComponent(window.location.href),Me.setLogs({id:27302,key:100,value:1,lc:1,log0:"[beforeD]"+window.encodeURIComponent(window.location.href)})),window.reportVid.push(t),l=["/mp/videoplayer?video_h=",s,"&video_w=",n,"&scene=",window.source,"&random_num=",a,"&article_title=",encodeURIComponent(window.msg_title.htmlDecode()),"&source=4&vid=",t,"&mid=",appmsgid,"&idx=",itemidx||idx,"&__biz=",biz,"&nodetailbar=",window.is_temp_url?1:0,"&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&version=",version,"&devicetype=",window.devicetype||"","&wxtoken=",window.wxtoken||"","&sessionid=",window.sessionid||"","&preview=",window.is_temp_url?1:0,"&is_in_pay_subscribe=",window.isPaySubscribe,`&nickname=${window.nickname}`,`&roundHeadImg=${window.round_head_img}`,`&enterid=${window.enterid}`,`&subscene=${window.subscene}`].join("");const d=ks().createMpVideoDom(i,o,l);e.video_iframe.push({dom:d,vid:t})}}else if(r&&(r.indexOf("newappmsgvote")>-1&&(d.indexOf("js_editor_vote_card")>=0||d.indexOf("vote_iframe")>=0)||0==r.indexOf("http://mp.weixin.qq.com/bizmall/appmsgcard")&&(d.indexOf("card_iframe")>=0||d.indexOf("js_editor_card")>=0)||r.indexOf("appmsgvote")>-1||r.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")>-1)){if(window.is_transfer_msg&&!window.reprint_ticket&&r.indexOf(window.biz)<0)return void n.push(i);if(window.__second_open__||(r=r.replace(/^http:/,location.protocol)),d.indexOf("card_iframe")>=0||d.indexOf("js_editor_card")>=0){-1===d.indexOf("card_iframe")&&(i.className+=" card_iframe"),-1===d.indexOf("res_iframe")&&(i.className+=" res_iframe");let e=r.replace("#wechat_redirect",["&pass_ticket=",pass_ticket,"&scene=",source,"&msgid=",appmsgid,"&msgidx=",itemidx||idx,"&version=",version,"&devicetype=",window.devicetype||"","&child_biz=",biz,"&wxtoken=",window.wxtoken||""].join(""));reprint_ticket&&(e+=["&mid=",mid,"&idx=",idx,"&reprint_ticket=",reprint_ticket,"&source_mid=",source_mid,"&source_idx=",source_idx].join("")),window.__second_open__?Ne({url:e,type:"GET",f:"html",success:function(n){i.setAttribute("src",e),i.contentWindow.document.open("text/html","replace"),i.contentWindow.document.write(n),i.contentWindow.document.close(),i.contentWindow.history.replaceState(null,null,e),-1==r.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(i.onload=function(){t(i)})}}):(i.setAttribute("src",e),-1==r.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(i.onload=function(){t(i)}))}else{let e=r.indexOf("#wechat_redirect")>-1,n=["&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&wxtoken=",window.wxtoken||""].join("");reprint_ticket?n+=["&mid=",mid,"&idx=",idx,"&reprint_ticket=",reprint_ticket,"&source_mid=",source_mid,"&source_idx=",source_idx,"&appmsg_token=",appmsg_token].join(""):(d.indexOf("vote_iframe")>=0||d.indexOf("js_editor_vote_card")>=0)&&(n+=["&mid=",mid,"&idx=",idx,"&appmsg_token=",appmsg_token].join(""),-1===d.indexOf("vote_iframe")&&(i.className+=" vote_iframe"));let a=e?r.replace("#wechat_redirect",n):r+n;window.__second_open__?Ne({url:a,type:"GET",f:"html",success:function(e){i.contentWindow.Ajax=Ne,i.setAttribute("src",a),i.contentWindow.document.open("text/html","replace"),i.contentWindow.document.write(e),i.contentWindow.document.close(),i.contentWindow.history.replaceState(null,null,a),-1==r.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(i.onload=function(){t(i)})}}):(i.setAttribute("src",a),-1==r.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(i.onload=function(){t(i)}))}i.appmsg_idx=s}if(r&&r.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")>-1&&w>0){let e=w,t=3*e/4;i.width=e,i.height=t,i.style.setProperty&&(i.style.setProperty("width",e+"px","important"),i.style.setProperty("height",t+"px","important"))}}(i[s],s);for(let s=0;s<n.length;s++){let e=n[s];e.parentNode.removeChild(e)}function o(){let t=window.pageYOffset||document.documentElement.scrollTop,i=e.video_top.length,n=t+Be.getInnerHeight(),a=0;for(let o=0;o<i;o++){let t=e.video_top[o];t.reported?a++:n>=t.start&&n<=t.end&&(t.reported=!0,setTimeout(function(e,t,i){return function(){let n=nt.getVideoInfo(),a="",o="",s=3;n[e]&&(n[e].hit_bizuin&&(a=n[e].hit_bizuin),n[e].hit_vid&&(o=n[e].hit_vid),n[e].ori_status&&(s=n[e].ori_status)),Ie.report({step:1,hit_vid:o,hit_bizuin:a,ori_status:s,vid:e,screen_num:Math.ceil(t/i),screen_height:i})}}(t.vid,n,Be.getInnerHeight()),1e4))}a==i&&($e.off(window,"scroll",o),e.video_top=e.video_iframe=o=null)}if(window.iframe_reload=function(){for(let e=0,n=i.length;e<n;++e){let n=i[e],a=n.getAttribute("src");a&&(a.indexOf("newappmsgvote")>-1||a.indexOf("appmsgvote")>-1)&&t(n)}},"getElementsByClassName"in document){let e=document.getElementsByClassName("video_iframe");for(let t,i=0;t=e.item(i++);)t.setAttribute("scrolling","no"),t.style.overflow="hidden"}e.video_iframe.length>0&&setTimeout((function(){let t=e.video_iframe,i=document.getElementById("js_article");for(let n=0,a=t.length;n<a;n++){let a=t[n];if(!a||!a.dom)return;let o=a.dom,s=parseFloat(getComputedStyle(o).getPropertyValue("height")),r=0;for(;o&&i!==o;)r+=o.offsetTop,o=o.offsetParent;e.video_top.push({start:r+s/2,end:r+s/2+Be.getInnerHeight(),reported:!1,vid:a.vid})}o(),$e.on(window,"scroll",o)}))}const Ts=[];function Is(e){let t=e.getAttribute("data-src")||e.getAttribute("src"),i=Pe.getQuery("vid",t),n=e.getAttribute("data-vw"),a=e.getAttribute("data-vh"),o=e.getAttribute("data-ratio"),s=document.createElement("span");s.setAttribute("data-ratio",o),s.id="js_tx_video_container_"+Math.random(),s.className="js_tx_video_container",s.style.cssText=e.style.cssText,s.style.display="none";let r=e.parentNode;if(r)return r.lastChild===e?r.appendChild(s):r.insertBefore(s,e.nextSibling),At.createTxVideo({containerId:s.id,vid:i,width:n,height:a,autoplay:!1,allowFullScreen:!0,onSuccess:function(e){s.playerObj=e.player,function(e,t){if(!t||!e)return;let i=e.parentNode;if(!i)return;let n=[];for(let a=0,o=i.children.length;a<o;a++){let e=i.children[a];e.className.indexOf("js_img_placeholder")>=0&&e.getAttribute("data-vid")==t&&n.push(e)}for(let a=0,o=n.length;a<o;a++)i.removeChild(n[a]);e.style.display="block"}(s,i),s.style.display="block"},onError:function(){}}),r.removeChild(e),s}function Ss(){let e="27613";We.getData({biz:biz,appmsg_type:appmsg_type,mid:mid,sn:sn,idx:idx,scene:source,title:msg_title,ct:ct,abtest_cookie:abtest_cookie,devicetype:devicetype,version:window.clientversion,is_need_ticket:Ts&&Ts.length>0?1:0,is_need_ad:0,comment_id:comment_id,is_need_reward:is_need_reward,both_ad:0,reward_uin_count:is_need_reward?3*W.getCountPerLine({can_reward:!0})-1:0,send_time:window.send_time||"",msg_daily_idx:msg_daily_idx,item_show_type:window.item_show_type,is_original:0,is_only_read:is_only_read,req_id:window.req_id||"",pass_ticket:pass_ticket,is_temp_url:window.is_temp_url||0,rtId:e,rtKey:"50",appmsg_like_type:window.appmsg_like_type,is_pay_subscribe:window.isPaySubscribe,pay_subscribe_uin_count:window.isPaySubscribe?3*I.getCountPerLine():0,has_red_packet_cover:window.__appmsgCgiData.has_red_packet_cover,onSuccess:function(t){if(t){window.ext_complete_success=!0;try{if(E.commit("SET_EXT_RES",t),window.__second_open__&&t.pay_subscribe_info&&1*t.pay_subscribe_info.is_paid!=isPaid)return S.report110809(11),(new Image).src="https://badjs.weixinbridge.com/badjs?id=244&level=4&from="+window.encodeURIComponent(window.location.host)+"&msg="+window.encodeURIComponent(window.location.href),void Ue.invoke("handleMPPageAction",{action:"paySuccess",fullUrl:window.location.href,itemShowType:window.item_show_type},(e=>{e.err_msg.indexOf("ok")>-1?S.report110809(19):S.report110809(20),window.localStorage&&window.localStorage.setItem&&window.localStorage.setItem(`isPaid-${window.biz}-${window.mid}-${window.idx}`,"1"),window.location.href=window.location.href+"&r="+Math.random()+"#wechat_redirect"}));if(t&&t.base_resp&&t.base_resp.wxtoken&&(window.wxtoken=t.base_resp.wxtoken),window.fromWeixinCached&&Cs(),function(e){if(!e||!e.img_copy_info||!e.img_copy_info.list)return;let t={},i=e.img_copy_info.list,n=window.__appmsgCgiData.copyright_stat,a=window.__appmsgCgiData.source_biz;for(let s=0,r=i.length;s<r;s++){let e=i[s];if(2==e.type){if(2==n&&a==e.source_uin)continue;t[e.img_url]={source_nickname:e.source_nickname,source_uin:e.source_uin,source_encode_biz:e.source_encode_biz||""}}}let o=document.getElementsByTagName("img");for(let s=0,r=o.length;s<r;s++){let e=o[s],i=e.getAttribute("data-src")||e.getAttribute("data-backsrc")||"";if(t[i]){let n=document.createElement("div");n.innerHTML=Ve.tmpl('<span class="original_img_wrp">\n<span class="tips_global">来自: <#=source_nickname#></span>\n</span>',t[i],!1);let a=n.children[0],o=e.parentNode.insertBefore(a,e),s=o.children[0];!function(e,t){$e.on(t,"click",(function(t){let i="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz="+e.source_encode_biz+"&scene=112#wechat_redirect";return He.isWindowsWechat||He.isMacWechat?(location.href=i,!1):(Ue.invoke("openUrlWithExtraWebview",{url:i,openType:1},(function(e){-1==e.err_msg.indexOf("ok")&&(location.href=i)})),!1)}))}(t[i],s),o.insertBefore(e,s)}}}(t),t.ret)return;t.red_packet_cover_data&&t.red_packet_cover_data.cover_uri_data&&t.red_packet_cover_data.cover_uri_data.length>0&&(un(),wn({list:t.red_packet_cover_data.cover_uri_data})),window.isFans=t.is_fans,function(e){let t=e.appmsgstat||{};const i=e.appmsgact||{},n=e.paySubscribeInfo||{};window.paySubscribeInfo=n,window.isFans=e.is_fans,window.appmsgstat||(window.appmsgstat=t),pt(),ce.setBackgroundClass(),W.initAuthorName(e.reward,{reward_entrance_enable_for_preview:e.reward_entrance_enable_for_preview}),window.isPaySubscribe&&I.init(n,E);let a=[];const{old_liked_before:o,seen_before:s,favorite_before:r,share_before:d,reward_before:l,pay_before:c}=i,{old_liked:p,liked:_}=t;(p||o)&&a.push("like"),(_||s)&&a.push("zaikan"),r&&a.push("collect"),d&&a.push("share"),l&&a.push("reward"),c&&a.push("pay"),window.is_like_profile_gray=e.show_biz_banner,window.is_like_profile_gray&&a.push("gray"),(a.length>0||uo)&&E.commit("mp-like-profile/setSources",a),t.old_liked||i.old_liked_before?E.commit("mp-related-article/setSources",["praised",!0]):t.liked||i.seen_before?E.commit("mp-related-article/setSources",["liked",!0]):i.favorite_before?E.commit("mp-related-article/setSources",["favorited",!0]):i.share_before?E.commit("mp-related-article/setSources",["shared",!0]):uo?E.commit("mp-related-article/setSources",["recommend",!0]):e.show_related_article?E.commit("mp-related-article/setSources",["force",!0]):window.is_login?i.reward_before?E.commit("mp-related-article/setSources",["rewarded",!0]):i.pay_before&&E.commit("mp-related-article/setSources",["paid",!0]):E.commit("mp-related-article/setSources",["default",!0])}({show_biz_banner:t.show_biz_banner,appmsgstat:t.appmsgstat,appmsgact:t.appmsgact,comment_enabled:t.comment_enabled,comment_count:t.comment_count,only_fans_can_comment:t.only_fans_can_comment,only_fans_days_can_comment:t.only_fans_days_can_comment,is_fans_days:t.is_fans_days,reward:{reward_total:t.reward_total_count,is_reward_total_count_cut:t.is_reward_total_count_cut,reward_head_img_infos:t.reward_head_img_infos||[],can_reward:t.can_reward,user_can_reward:t.user_can_reward,reward_qrcode_ticket:t.reward_qrcode_ticket,timestamp:t.timestamp,reward_author_head:t.reward_author_head,rewardsn:t.rewardsn,scene:source,is_need_reward:is_need_reward,title:msg_title,author_id:author_id,appmsgextRtId:e,appmsgextRtKey:"50",can_whisper:t.can_whisper},reward_entrance_enable_for_preview:t.reward_entrance_enable_for_preview,reward_wording:t.reward_wording,reward_author_head:t.reward_author_head,comment_entrance_enable_for_preview:t.comment_entrance_enable_for_preview,share_redirect_url:t.share_redirect_url||"",logo_url:t.logo_url,nick_name:t.nick_name,is_fans:t.is_fans,paySubscribeInfo:t.pay_subscribe_info,share_flag:t.share_flag,test_flag:t.test_flag,show_related_article:t.show_related_article})}catch(i){return Le.log("[Appmsg] error parse async data, biz="+biz+", mid="+mid),(new Image).src=("http://mp.weixin.qq.com/mp/jsreport?1=1&key=1&content=biz:"+biz+",mid:"+mid+",uin:"+uin+"[key1]"+encodeURIComponent(i.toString())+"&r="+Math.random()).substr(0,1024),console&&console.error(i),void(void 0!==window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.onError(i))}}},onError:function(){(new Image).src="http://mp.weixin.qq.com/mp/jsreport?1=1&key=2&content=biz:"+biz+",mid:"+mid+",uin:"+uin+"[key2]ajax_err&r="+Math.random()},onComplete:function(){window.ext_complete=!0,Ee.emit("ext-complete")}})}function Es(){!function(){let e=document.getElementsByTagName("iframe"),t=[];for(let a=0,o=e.length;a<o;++a)t.push(e[a]);e=null;let i=document.getElementById("js_content").offsetWidth,n=i/Ie.getRatio();window.logs.video_cnt=0;for(let a=0,o=t.length;a<o;++a){let e=t[a],o=e.getAttribute("data-src")||"",s=e.getAttribute("src")||o;if(s)if(0==s.indexOf("http://z.weishi.com/weixin/player.html"))s=s.replace(/width=\d+/g,"width="+i),s=s.replace(/height=\d+/g,"height="+n),e.width=i,e.height=n,e.style.setProperty&&(e.style.setProperty("width",i+"px","important"),e.style.setProperty("height",n+"px","important")),e.setAttribute("src",s),window.__addIdKeyReport&&window.__addIdKeyReport("28307",10),window.logs.video_cnt++;else{if(/http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/.test(s)){if(!Se.isShowMpVideo()){const t=Is(e);t&&Ts.push(t),"function"==typeof window.__addIdKeyReport&&(window.__addIdKeyReport("28307",10),He.isWechat&&He.isWindowsWechat?window.__addIdKeyReport("110644",0):He.isWechat&&He.isMacWechat&&window.__addIdKeyReport("110644",1))}window.logs.video_cnt++;continue}/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/.test(s)&&window.logs.video_cnt++}}Ts.length>0&&"function"==typeof window.__getVideoWh&&$e.on(window,"resize",(function(){try{for(let e=0,t=Ts.length;e<t;e++){let t=Ts[e],i=t.playerObj;if(i){let e=window.__getVideoWh(t);t.style.width=e.w+"px",t.style.height=e.h+"px",i.resize({width:e.vw,height:e.vh})}}}catch(e){}}),!1)}(),Ss()}const As=window.user_uin||0,Rs=Math.floor(As/100)%1e3,js=0!==As&&Rs<1001;function Bs(e,t,i){window.logs.img={download:{},read:{},load:{}};const n=document.getElementById("js_cover");if(n){let e=n.getAttribute("data-src");e&&(e.isCDN()&&(e=e.imgChange640(),i&&(e=U(e)),e=ze(e,"wxfrom","5",!0),is_https_res||js?e=e.http2https():"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(e=e.https2http())),setTimeout((function(){n.onload=function(){It.setProperty(n,"height","auto","important"),It.setProperty(n,"visibility","visible","important")},n.setAttribute("src",e)}),0),window.logs.img.read[e]=!0,window.logs.img.load[e]=!0,n.removeAttribute("data-src"))}function a(e){return parseInt(e,10)||0}function o(e,t,i){const n=i.getAttribute("data-index"),o=i.parentNode.querySelector(`.js_img_placeholder[data-index="${n}"]`);!o||(o.width<40||o.height<40)&&(a(o.style.width)<40||a(o.style.height)<40)||(o.querySelector("span.weui-primary-loading").style.opacity=0,o.classList.contains("img_loadederror")||(o.classList.add("img_loadederror"),o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==",window.__addIdKeyReport("28307",51),o.bindRetry||(o.bindRetry=!0,$e.on(o,"click",(()=>(window.__addIdKeyReport("28307",66),s(o),function(e){!e||(e.width<40||e.height<40)&&(a(e.style.width)<40||a(e.style.height)<40)||(e.querySelector("span.weui-primary-loading").style.opacity=null)}(o),e=e.https2http(),t.__retryload++,t.src=ze(e,"retryload",t.__retryload,!0),!1))))))}function s(e){e&&e.classList.remove("img_loadederror")}window.logs.outer_pic=0;const r=document.getElementsByTagName("img");for(let _=0,m=r.length;_<m;_++){const e=r[_].getAttribute("data-src");e&&e.isGif()&&r[_].classList.add("__bg_gif")}const d=document.getElementsByClassName("__bg_gif");for(let _=0,m=d.length;_<m;++_)d[_].setAttribute("data-order",_);const l=function(e){try{let t=e.childNodes,i=getComputedStyle(e);(i.backgroundImage.match(/https\:\/\/mmbiz\.qpic\.cn/)||i.backgroundImage.match(/http\:\/\/mmbiz\.qpic\.cn/))&&window.__addIdKeyReport("111535",2);for(let e=0;e<t.length;e++)"a"!=t[e].tagName.toLowerCase()&&l(t[e])}catch(t){}};try{const e=document.getElementsByTagName("a");for(let t=0;t<e.length;t++){const i=e.item(t);null!=(i.getAttribute("href")||"").match(/^http/)&&l(i)}}catch(p){}let c=!1;window.isCartoonCopyright||window.is_care_mode||new St({attrKey:"data-src",imgOccupied:!0,crossOrigin:!0,accessibilityCallback(e){Ue.invoke("getUserConfig",{},(function(t){t.isAccessibilityMode&&(window.localStorage.setItem("isMpUserAccessibility","1"),e())}))},lazyloadHeightWhenWifi(){let e,t=1,i=1;e=window.svr_time?new Date(1e3*window.svr_time):new Date;const n=e.getHours();return n>=20&&n<23&&(t=.5,i=0),{bottom:t,top:i}},inImgRead(e){e&&(window.logs.img.read[e]=!0)},getImgRect(e){const t=e.getAttribute("data-index"),i=e.parentNode.querySelector(`.js_img_placeholder[data-index="${t}"]`);return i&&i.getBoundingClientRect()},changeSrc(e,n){if(!n)return"";if(window.__offlineCacheScheme)return n.offline();let a=n;if(n.isCDN())a=a.imgChange640(),t&&a.canHevc()?(a=F(a,!1),window.__addIdKeyReport("28307",91)):i&&(a=U(a),window.__addIdKeyReport("28307",84)),a=ze(a,"wxfrom","5",!0),is_https_res||js?(a=a.http2https(),window.__addIdKeyReport("28307",77)):"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(a=a.https2http(),window.__addIdKeyReport("28307",70));else try{new RegExp("^http(s)?://((mmbiz.qpic.cn/.*)|(m.qpic.cn/.*)|(mmsns.qpic.cn/.*)|(shp.qpic.cn/.*)|(puui.qpic.cn/.*)|(wx.qlogo.cn/.*)|(mmbiz.qlogo.cn/.*)|((a|b)[0-9]*.photo.store.qq.com/.*)|(mp.weixin.qq.com/.*)|(res.wx.qq.com/.*))").test(n)||(window.__addIdKeyReport("28307",9),window.logs.outer_pic++)}catch(p){}return a=a.replace(/^http\:\/\/(a|b)(\d)+\.photo\.store\.qq\.com/g,"http://m.qpic.cn"),/^http(s)?:\/\/m\.qpic\.cn([\/?].*)*$/i.test(a)&&!i&&(a=ze(a,"t","",!0)),a=ze(a,"wx_lazy","1",!0),"anonymous"==e.crossOrigin&&(a=ze(a,"wx_co","1",!0)),V()&&(a=J(a)),K(a)&&window.__addIdKeyReport("28307",106),window.logs.img.load[a]=!0,Le.log("[Appmsg] image_load_event_change_src. originsrc:"+n+"  ^^^ newsrc : "+a),e.start_load_time=+new Date,a},onerror(e,t,i){let n=t&&t.__retryload||0;if(n>=2&&o(e,t,i),!e||n>2)return;if(!e.isCDN()){if(!V())return;if(!K(e))return}const a=0==e.indexOf("https://")?7:0;window.__addIdKeyReport("28307",72+a),n<=1&&window.__addIdKeyReport("28307",75+1*n+a),e.isWxpic()?(window.__addIdKeyReport("28307",93),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:hevc",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),n<=1&&window.__addIdKeyReport("28307",96+1*n)):e.isWebp()?(window.__addIdKeyReport("28307",86),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:webp",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),n<=1&&window.__addIdKeyReport("28307",89+1*n)):window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),K(e)&&window.__addIdKeyReport("28307",108),n<2&&(n++,t.__retryload=n,1==n&&e.indexOf("http://")>-1?(e=e.http2https(),window.__addIdKeyReport("28307",60),window.__addIdKeyReport("28307",77)):1==n&&e.indexOf("https://")>-1?(window.__addIdKeyReport("28307",61),window.__addIdKeyReport("28307",77)):2==n&&e.indexOf("mmbiz.qpic.cn")>-1&&(e=e.replace("mmbiz.qpic.cn","mmbiz.qlogo.cn")).indexOf(!1)&&(e=e.http2https()),K(e)&&(e=X(e)),t.start_load_time=+new Date,t.src=ze(e,"retryload",n,!0)),window.__has_imgfailed||(window.__has_imgfailed=!0,window.__addIdKeyReport("28307",65)),Le.log("[Appmsg] image_load_event_on_error. src:"+e),t.setAttribute("data-fail",1);try{if("[object Array]"==Object.prototype.toString.call(t.lazyLoadOnerror))for(let e=0,i=t.lazyLoadOnerror.length;e<i;e++)"function"==typeof t.lazyLoadOnerror[e]&&t.lazyLoadOnerror[e].call(t)}catch(p){}let s=10;/tp\=webp/.test(e)&&(s=11),(new Image).src="http://mp.weixin.qq.com/mp/jsreport?key="+s+"&content="+encodeURIComponent(e)+"["+uin+"]&r="+Math.random()},onload(t,i){if(!window.__second_open__&&!c){const e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||!e.timing)return;const t=window.location.protocol;re.saveSpeeds({uin:uin,pid:"https:"==t?462:417,speeds:{sid:35,time:Date.now()-e.timing.navigationStart}}),re.send(),c=!0}const n=i.getAttribute("data-index"),a=i.parentNode.querySelector(`.js_img_placeholder[data-index="${n}"]`),o=i.getAttribute("data-origin-display");i.style.display=o||"initial",a&&(a.remove(),s(a)),e&&e.bindEvent(i),i.gray&&!i.loadGif&&((i.width||i.naturalWidth)<120||(i.height||i.naturalHeight)<120?i.autoTap&&i.autoTap():i.span&&i.span.children&&i.span.children.item(0)&&(i.span.children.item(0).style.display=""));let r=i&&i.__retryload||0;if(r>2)return;Le.log("[Appmsg] image_load_event_onload_image. src:"+t+"  ^^^  retryloadtimes: "+r),i.setAttribute("data-fail",0),function(e){try{const t=e.getAttribute("data-src");if(!/^https?\:\/\/mmbiz\.qpic\.cn/.test(t))return;let i=e.parentNode,n=!1;Fe.hasClass(i,"js_jump_icon")&&(n=!0);let a=!1;for(;i.tagName&&"body"!=i.tagName.toLowerCase();){if("a"==i.tagName.toLowerCase()){null!=(i.getAttribute("href")||"").match(/^http/)&&(a=!0);break}i=i.parentNode}if(n&&!a){let t=e.parentNode,i=t.parentNode;if(i){let e=document.createDocumentFragment();for(;t.firstChild;)e.appendChild(t.firstChild);i.insertBefore(e,t),i.removeChild(t)}}else if(!n&&a){let t=document.createElement("span"),i=getComputedStyle(e);"static"!=i.positon&&(t.style.position=i.positon),t.style.left=i.left,t.style.top=i.top,t.style.right=i.right,t.style.bottom=i.bottom,t.style.margin=i.margin,Fe.addClass(t,"js_jump_icon"),Fe.addClass(t,"h5_image_link"),e.style.position="static",e.style.margin="0px",e.parentNode.insertBefore(t,e),t.appendChild(e),window.__addIdKeyReport("111535",0)}}catch(p){}}(i);try{if("[object Array]"==Object.prototype.toString.call(i.lazyLoadOnload))for(let e=0,t=i.lazyLoadOnload.length;e<t;e++)"function"==typeof i.lazyLoadOnload[e]&&i.lazyLoadOnload[e].call(i)}catch(p){}const d=0==t.indexOf("https://")?7:0;window.__addIdKeyReport("28307",71+d),r<=1&&window.__addIdKeyReport("28307",73+1*r+d),t.isWxpic()?(window.__addIdKeyReport("28307",92),r<=1&&window.__addIdKeyReport("28307",94+1*r)):t.isWebp()&&(window.__addIdKeyReport("28307",85),r<=1&&window.__addIdKeyReport("28307",87+1*r)),K(t)&&window.__addIdKeyReport("28307",107),window.__has_imgsucceed||(window.__has_imgsucceed=!0,window.__addIdKeyReport("28307",64)),1==r&&t.indexOf("http://")>-1&&window.__addIdKeyReport("28307",50),1==r&&t.indexOf("https://")>-1&&window.__addIdKeyReport("28307",52);const l=Math.random(),_=+new Date-i.start_load_time;_&&0==t.indexOf("https://")&&l<.5?(window.__addIdKeyReport("27822",121,_),window.__addIdKeyReport("27822",122)):_&&l<5e-4&&(window.__addIdKeyReport("27822",124,_),window.__addIdKeyReport("27822",125)),""===i.style.filter||"none"===i.style.filter||/translate(Z|3d)\(/.test(i.style.transform)||(i.style.transform+=" translateZ(0)",i.style.webkitTransform+=" translateZ(0)")},detect(e){if(!e||!e.time||!e.loadList)return;const t=e.time,i=e.loadList;window.logs&&window.logs.img&&window.logs.img.download&&(window.logs.img.download[t]=i)},container:document.getElementById("page-content")})}function Ns(){const e=document.getElementById("js_read_container"),t={player:null,srcId:`__wxtag__${window.biz}-${window.mid}-${window.idx}`,mediaId:"",tag:"===mediaId-sep===",playDuration:0,playTime:0,maxNum:5,curNum:0,format:"",type:6,speed:100,voiceInfo:{title:"",nickname:"",appmsgUrl:"",duration:0},voiceOpt:null,lock:!1,status:"stop",currentTime:0,beginTime:0,leaveNeedReport:!1,pause2PlayNeedReport:!1,isSeek:!1,loadingTimer:null},i=e=>`${e}&uin=${window.uin}&key=${window.key}&pass_ticket=${encodeURIComponent(window.pass_ticket)}`,n=()=>{if(t.curNum>10)return(e=>{if(!e&&null!==t.loadingTimer)return clearTimeout(t.loadingTimer),void(t.loadingTimer=null);Ue.invoke("handleMPPageAction",{action:"showToast",status:e?"loading":"dismissloading"})})(!1),t.lock=!1,void weui.alert("系统繁忙，请稍后再试");t.curNum++;const e=t.curNum>t.maxNum?5e3:1e3;Ne({url:`/mp/msgvoice?action=getvoiceinfo&__biz=${window.biz}&mid=${window.mid}&idx=${window.idx}&sn=${window.sn}&type=${t.type}&speed=${t.speed}`,type:"GET",dataType:"json",async:!0,success:o=>{if(o&&o.base_resp&&0===o.base_resp.ret)if(o.mediaid){t.mediaId=o.mediaid;const e=encodeURIComponent(`__biz=${window.biz}&mid=${window.mid}&idx=${window.idx}`),n=t.voiceInfo;t.voiceOpt={protocol:2===o.format?"hls":"",src:i(`https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=${o.mediaid}&devicetype=${window.devicetype}&_type=${t.type}&speed=${t.speed}&encodeurl=${e}`),lowbandUrl:i(`https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=${o.mediaid}&devicetype=${window.devicetype}&_type=${t.type}&speed=${t.speed}&encodeurl=${e}`),title:n.title,epname:"来自文章",singer:n.nickname?`${n.nickname}的语音`:"公众号语音",srcId:t.srcId+t.tag+t.mediaId,coverImgUrl:"",webUrl:n.appmsgUrl,musicbar_url:`https://mp.weixin.qq.com/mp/msgvoice?action=ttspage&__biz=${window.biz}&mid=${window.mid}&idx=${window.idx}&sn=${window.sn}&type=${t.type}#wechat_redirect`,needStartMusicUI:0},a()}else setTimeout(n,1e3);else console.log("getvoiceinfo err",o),setTimeout(n,e)},error:t=>{console.log("getvoiceinfo err",t),setTimeout(n,e)}})},a=()=>{t.player=Qe.init({protocal:"hls",wxIndex:t.voiceOpt.srcId,type:7,comment_id:"",src:t.voiceOpt.src,jsapi2Src:t.voiceOpt.src+"&voice_type=1",allowPause:!0,duration:t.voiceInfo.duration,title:t.voiceOpt.title,singer:t.voiceOpt.singer,epname:t.voiceOpt.epname,coverImgUrl:t.voiceOpt.coverImgUrl,playingCss:"share_audio_playing",playCssDom:e.getElementsByClassName("js_read_main")[0],playArea:e.getElementsByClassName("js_read_play")[0],progress:e.getElementsByClassName("js_read_progress")[0],fileSize:0,playtimeDom:e.getElementsByClassName("js_read_playtime")[0],bufferDom:e.getElementsByClassName("js_read_buffer")[0],playdotDom:e.getElementsByClassName("js_read_playdot")[0],seekRange:e.getElementsByClassName("js_read_seekRange")[0],seekContainer:e.getElementsByClassName("js_read_main")[0],loadingDom:e.getElementsByClassName("js_read_loading")[0],detailArea:"",detailUrl:t.voiceOpt.musicbar_url,webUrl:t.voiceOpt.musicbar_url})};Ne({url:`/mp/msgvoice?action=ttspage&__biz=${window.biz}&mid=${window.mid}&idx=${window.idx}&sn=${window.sn}&type=${t.type}&f=json`,type:"GET",dataType:"json",async:!0,success:i=>{i&&i.base_resp&&0===i.base_resp.ret?(t.voiceInfo={title:i.title,nickname:i.nickname,appmsgUrl:i.appmsg_url,duration:1*i.voice_info.duration},n(),e.getElementsByClassName("js_read_duration")[0].innerHTML=(e=>{const t=e=>e>=10?e:`0${e}`;return`${t(Math.floor(e/60))}:${t(e%60)}`})(1*i.voice_info.duration)):weui.alert("系统繁忙，请稍后再试")},error:e=>{console.log("ttspage err: ",e),weui.alert("网络不可用，请检查网络设置")}})}const Ds={adapter:{1:Ze,2:et},musicList:{},musicLen:0};function Ps(e,t,i){if(t.media_id=Qe.encodeStr(e.getAttribute("mid")||"").replace(/^\s/,"").replace(/\s$/,""),t.musictype=parseInt(e.getAttribute("musictype"))||1,t.musictype>2&&(t.musictype=2),t.albumid=Qe.encodeStr(e.getAttribute("albumid")||"").replace(/^\s/,"").replace(/\s$/,""),t.otherid=Qe.encodeStr(e.getAttribute("otherid")||"").replace(/^\s/,"").replace(/\s$/,""),t.jumpurlkey=Qe.encodeStr(e.getAttribute("jumpurlkey")||"").replace(/^\s/,"").replace(/\s$/,""),t.duration=parseInt(e.getAttribute("play_length")||0,10),t.posIndex=i,t.albumurl=Qe.encodeStr(e.getAttribute("albumurl")||"").replace(/^\s/,"").replace(/\s$/,""),t.audiourl=Qe.encodeStr(e.getAttribute("audiourl")||"").replace(/^\s/,"").replace(/\s$/,""),t.singer=Qe.encodeStr(e.getAttribute("singer")||"").replace(/^\s/,"").replace(/\s$/,""),!t.singer||"undefined"==t.singer){let i=e.getAttribute("src")||"",n=decodeURIComponent(Pe.getQuery("singer",i)||"");t.singer=Qe.encodeStr(n).replace(/^\s/,"").replace(/\s$/,""),t.singer&&"undefined"!=t.singer||(t.singer="")}t.music_name=Qe.encodeStr(e.getAttribute("music_name")||"").replace(/^\s/,"").replace(/\s$/,""),Ds.adapter[t.musictype]&&"function"==typeof Ds.adapter[t.musictype].initData&&(t=Ds.adapter[t.musictype].initData(t,{scene:0})),Qe.renderPlayer('<span id="qqmusic_main_<#=musicid#>_<#=posIndex#>" class="js_wap_qqmusic db pages_reset music_area <#if(!musicSupport){#> unsupport<#}#>">\n  <span class="tc tips_global unsupport_tips" <#if(show_not_support!==true){#>style="display:none;"<#}#>>\n  当前浏览器不支持播放音乐或语音，请在微信或其他浏览器中播放\n  </span>\n  <span class="db music_card appmsg_card_context wx_tap_card js_wx_tap_highlight">\n    <a role="none" id="qqmusic_home_<#=musicid#>_<#=posIndex#>" class="music_card_bd">\n      <span role="link" tabindex="0" aria-labelledby="music_title_tips_<#=musicid#>_<#=posIndex#> music_link_<#=musicid#>_<#=posIndex#> js_a11y_comma music_singer_<#=musicid#>_<#=posIndex#> js_a11y_comma music_source_<#=musicid#>_<#=posIndex#>" id="music_link_<#=musicid#>_<#=posIndex#>" class="music_card_title"><#=music_name#></span>\n      <span aria-hidden="true" id="music_title_tips_<#=musicid#>_<#=posIndex#>" class="weui-hidden_abs">音乐：</span>\n      <span aria-hidden="true" class="music_card_desc" id="music_singer_<#=musicid#>_<#=posIndex#>"><#=singer#></span>\n      <span class="music_card_source <#if(musictype==2){#>music_card_source_kugou<#}#>">\n        <img aria-hidden="true" id="music_source_<#=musicid#>_<#=posIndex#>" src="<#=musicIcon#>" alt="<#if(musictype==2){#>来自酷狗音乐<#}else{#>来自QQ音乐<#}#>">\n      </span>\n    </a>\n    <span role="button" aria-label="播放" id="qqmusic_play_<#=musicid#>_<#=posIndex#>" class="music_card_ft">\n      <i class="weui-play-btn"></i>\n      <img src="<#=albumurl#>" data-autourl="<#=audiourl#>" data-musicid="<#=musicid#>" class="music_card_thumb" alt="">\n    </span>\n  </span>\n</span>',t,e);let n=t.musicid+"_"+t.posIndex,a=e.parentNode.querySelector('[data-preloadingid="'+n+'"]');a&&a.parentNode.removeChild(a),function(e){let t=e.musicid+"_"+e.posIndex;Le.log("[Music] init "+e.detailUrl);let i=Qe.decodeStr(e.music_name);e.player=Qe.init({allowPause:!0===e.allowPause,wxIndex:e.posIndex,type:e.type||0,comment_id:"",mid:e.media_id,otherid:e.otherid,albumid:e.albumid,songId:e.musicid,jumpurlkey:e.jumpurlkey,duration:e.duration,title:i,singer:window.nickname?window.nickname+"推荐的歌":"公众号推荐的歌",epname:"音乐",coverImgUrl:e.albumurl,playingCss:"qqmusic_playing",pauseCss:e.pauseCss||"",playCssDom:Ls("qqmusic_main_"+t),playArea:Ls("qqmusic_play_"+t),detailUrl:e.detailUrl||"",webUrl:e.webUrl||"",detailArea:Ls("qqmusic_home_"+t)})}(t),Ds.musicList[t.musicid+"_"+t.posIndex]=t}function Ls(e){return document.getElementById(e)}function Ms(){(function(){let e=Ls("js_content");return!(!e||(Ds._oElements=e.getElementsByTagName("qqmusic")||[],Ds._oElements.length<=0))})()&&(Ds.musicLen=Ds._oElements.length,function(){let e=0;for(let t=0;t<Ds.musicLen;t++){let i=Ds._oElements[t],n={};n.musicid=Qe.encodeStr(i.getAttribute("musicid")||"").replace(/^\s/,"").replace(/\s$/,""),n.musicid&&"undefined"!=n.musicid&&(Ps(i,n,e),e++)}}())}const qs={musicList:{},musicLen:0,srcRoot:location.protocol+"//res.wx.qq.com/voice/getvoice?mediaid=#meidaid#"};function Os(e,t,i){t.duration=parseInt((1*e.getAttribute("play_length")||0)/1e3,10),t.duration_str=Qe.formatTime(t.duration),t.posIndex=i;var n=e.getAttribute("name")||"";try{n=decodeURIComponent(n)}catch(a){}if(t.title=Qe.encodeStr(n).replace(/^\s/,"").replace(/\s$/,""),t.fileSize=1*e.getAttribute("high_size")||0,t.nickname=window.nickname,t.voiceTag="v",1===window.is_temp_url){const{transState:e,voiceVerifyState:i}=window.voice_in_appmsg[t.voiceid];t.transState=e,t.voiceVerifyState=i}Qe.renderPlayer('<span class="js_audio_frame db pages_reset audio_area <#if(!!albumLink){#>audio_area_tag<#}#>">\n  <#if(show_not_support===true){#>\n  <span class="db">当前浏览器不支持播放音乐或语音，请在微信或其他浏览器中播放</span>\n  <#}#>\n\n  <span tabindex="0" id="voice_main_<#=voiceid#>_<#=posIndex#>" class="wx_tap_card js_wx_tap_highlight appmsg_card_context db audio_card <# if (!!errMsg) { #> pages_ban_msg_wrp <# } #>" <#if(!musicSupport){#>style="display:none;"<#}#>>\n    <span id="audio_card_bd_<#=voiceid#>_<#=posIndex#>" class="audio_card_bd" <# if (!!errMsg) { #> style="visibility: hidden;"<# } #>>\n      <strong  id="voice_title_<#=voiceid#>_<#=posIndex#>" class="audio_card_title" role="link" tabindex="0" aria-labelledby="js_a11y_audio_title_tips_<#=voiceid#>_<#=posIndex#> voice_title_<#=voiceid#>_<#=posIndex#>"><#=title#></strong>\n      <span class="weui-hidden_abs" id="js_a11y_audio_title_tips_<#=voiceid#>_<#=posIndex#>" aria-hidden="true">音频：</span>\n\n      <span class="weui-flex weui-flex_align-center">\n        <span class="weui-flex__item">\n          <span class="audio_card_opr">\n            <span id="voice_seekRange_<#=voiceid#>_<#=posIndex#>" class="audio_card_progress_wrp">\n              <span class="audio_card_progress">\n                <span id="voice_progress_<#=voiceid#>_<#=posIndex#>" style="width:0%" class="audio_card_progress_inner"></span>\n                <span id="voice_buffer_<#=voiceid#>_<#=posIndex#>" class="audio_card_progress_buffer" style="width:0%;"></span>\n                <span id="voice_loading_<#=voiceid#>_<#=posIndex#>" class="audio_card_progress_loading" style="display:none;"></span>\n              </span>\n              <span tabindex="0" role="option" title="按住可调" id="voice_playdot_<#=voiceid#>_<#=posIndex#>" class="audio_card_progress_handle weui-wa-hotarea" style="display:none;left:0%;">\n                <span class="weui-hidden_abs">\n                  <span id="voice_percent_desc_<#=voiceid#>_<#=posIndex#>">进度条</span>\n                  <span id="voice_percent_<#=voiceid#>_<#=posIndex#>"></span>\n                </span>\n              </span>\n            </span>\n            <span role="option" aria-labelledby="voice_playtime_<#=voiceid#>_<#=posIndex#> js_a11y_comma voice_duration_<#=voiceid#>_<#=posIndex#>" class="audio_card_tips">\n              <em aria-hidden="true" id="voice_playtime_<#=voiceid#>_<#=posIndex#>" class="audio_card_length_current">00:00</em>\n              <em aria-hidden="true" id="voice_duration_<#=voiceid#>_<#=posIndex#>" class="audio_card_length_total"><#=duration_str#></em>\n            </span>\n          </span>\n        </span>\n        <span tabindex="0" role="button" aria-label="播放" id="voice_play_<#=voiceid#>_<#=posIndex#>" class="audio_card_switch"><em id="audio_play_btn" class="weui-wa-hotarea weui-audio-btn"></em></span>\n      </span>\n\n      <span id="audio_card_control_<#=voiceid#>_<#=posIndex#>" class="weui-flex weui-flex_align-center audio_card_playtool" style="display: none;">\n        <button type="button" id="audio_fast_back_<#=voiceid#>_<#=posIndex#>" class="reset_btn audio_card_playbtn js_wx_tap_highlight"><span class="weui-hidden_abs">后退15秒</span></button>\n        <button type="button" id="audio_double_speed_<#=voiceid#>_<#=posIndex#>" class="weui-btn weui-btn_mini audio_card_playbtn_multiple weui-wa-hotarea js_wx_tap_highlight">倍速</button>\n        <button type="button" id="audio_fast_forward_<#=voiceid#>_<#=posIndex#>" class="reset_btn audio_card_playbtn js_wx_tap_highlight"><span class="weui-hidden_abs">快进15秒</span></button>\n      </span>\n    </span>\n\n    <#if(!!albumLink){#>\n      <span class="audio_card_ft" <# if (!!errMsg) { #> style="visibility: hidden;"<# } #>>\n        <span id="voice_album_<#=voiceid#>_<#=posIndex#>" class="audio__tag wx_tap_card" data-link="<#=albumLink#>" data-title="<#=albumTitle#>" data-album="<#=albumid#>" target="_blank">\n          <span role="link" tabindex="0" aria-labelledby="js_a11y_voice_album_link_<#=voiceid#>_<#=posIndex#> js_a11y_voice_album_link_title_<#=voiceid#>_<#=posIndex#> js_a11y_voice_album_link_num_<#=voiceid#>_<#=posIndex#>" id="js_a11y_voice_album_link_<#=voiceid#>_<#=posIndex#>" class="audio__tag-title">合集</span>\n          <span class="weui-flex__item" id="js_a11y_voice_album_link_title_<#=voiceid#>_<#=posIndex#>" aria-hidden="true">\n            <span class="audio__tag-name"><span aria-hidden="true">#</span><#=albumTitle#></span>\n          </span>\n          <span class="audio__tag-num" id="js_a11y_voice_album_link_num_<#=voiceid#>_<#=posIndex#>" aria-hidden="true"><#=albumNum#>个</span>\n        </span>\n      </span>\n    <#}#>\n\n    <# if (!!errMsg) { #>\n      \x3c!-- 违规处理提示 --\x3e\n      \x3c!-- 在需要处理的模块加上pages_ban_msg_wrp，然后加一个msg的子元素 --\x3e\n      <span class="pages_ban_msg"><#=errMsg#></span>\n    <# } #>\n  </span>\n</span>',t,e,void 0,(()=>{let i=t.voiceid+"_"+t.posIndex,n=e.parentNode.querySelector('[data-preloadingid="'+i+'"]');n&&n.parentNode.removeChild(n),function(e){var t=e.voiceid+"_"+e.posIndex,i="";if(window.voice_in_appmsg&&window.voice_in_appmsg[e.voiceid]){var n=window.voice_in_appmsg[e.voiceid],a=window.biz||"",o=window.mid||"",s=window.idx||"";n.bizuin&&n.appmsgid&&n.idx&&(a=n.bizuin,o=n.appmsgid,s=n.idx),i=(window.location.protocol||"https:")+"//mp.weixin.qq.com/mp/audio?_wxindex_=#_wxindex_#&scene=104&__biz=#biz#&mid=#mid#&idx=#idx#&voice_id=#voice_id#&sn=#sn##wechat_redirect".replace("#_wxindex_#",e.posIndex).replace("#biz#",a).replace("#mid#",o).replace("#idx#",s).replace("#voice_id#",e.voiceid).replace("#sn#",n.sn||"")}Le.log("[Voice] init"+i);var r=Qe.decodeStr(e.title);e.player=Qe.init({wxIndex:e.posIndex,type:2,songId:e.voiceid,comment_id:"",src:e.src,jsapi2Src:e.jsapi2Src,allowPause:!0,duration:e.duration,title:r,singer:window.nickname?window.nickname+"的语音":"公众号语音",epname:"来自文章",coverImgUrl:window.__appmsgCgiData.hd_head_img,playingCss:"share_audio_playing",playCssDom:zs("voice_main_"+t),playArea:zs("voice_play_"+t),progress:zs("voice_progress_"+t),fileSize:e.fileSize,playtimeDom:zs("voice_playtime_"+t),bufferDom:zs("voice_buffer_"+t),playdotDom:zs("voice_playdot_"+t),playpercent:zs("voice_percent_"+t),playpercentDesc:zs("voice_percent_desc_"+t),seekRange:zs("voice_seekRange_"+t),seekContainer:zs("voice_main_"+t),loadingDom:zs("voice_loading_"+t),detailArea:i?zs("voice_main_"+t):"",albumDom:zs("voice_album_"+t),detailUrl:i,webUrl:i,speedList:[1,1.25,1.5,2],audioCardBody:zs(`audio_card_bd_${t}`),ctrlArea:zs(`audio_card_control_${t}`),fastBackBtn:zs(`audio_fast_back_${t}`),fastForwardBtn:zs(`audio_fast_forward_${t}`),doubleSpeedBtn:zs(`audio_double_speed_${t}`),isAudio:!0,userName:window.user_name||"",articleCoverCdnUrl1_1:window.cdn_url_1_1,tingExtInfo:{bizuin:1*window.atob(window.biz)||0,appmsgid:1*window.mid||0,idx:1*window.idx||0,audio_id:e.voiceid||"",is_album_page:!1},albumInfo:{albumId:e.albumid||"",albumName:e.albumTitle||"",albumUrl:e.albumLink||""}})}(t),qs.musicList[t.voiceid+"_"+t.posIndex]=t}))}function zs(e){return document.getElementById(e)}function Ws(e){var t;!(t=zs("js_content"))||(qs._oElements=t.getElementsByTagName("mpvoice")||[],qs._oElements.length<=0)||(qs.musicLen=qs._oElements.length,function(e){for(var t=0,i=0;i<qs.musicLen;i++){var n=qs._oElements[i],a={},o=n.getAttribute("voice_encode_fileid")||"";try{o=decodeURIComponent(o)}catch(s){}if(a.voiceid=Qe.encodeStr(o),a.voiceid=a.voiceid.replace(/&#61;/g,"=").replace(/^\s/,"").replace(/\s$/,""),a.isaac=1*n.getAttribute("isaac2")||0,a.src=qs.srcRoot.replace("#meidaid#",a.voiceid),1===a.isaac&&(a.jsapi2Src=a.src+"&voice_type=1"),a.voiceid&&"undefined"!=a.voiceid){if(a.albumLink="",e&&e.length>0&&e.forEach((e=>{if(e.voice_id===o)return e.appmsgalbuminfo&&(a.albumTitle=e.appmsgalbuminfo.title,a.albumLink=e.appmsgalbuminfo.link.replace("#wechat_redirect","")+"#wechat_redirect",a.albumNum=e.appmsgalbuminfo.tag_content_num||0,a.albumid=e.appmsgalbuminfo.album_id||0),!1})),Os(n,a,t),"undefined"!=typeof voiceid&&o&&voiceid&&o===voiceid){let e=n.offsetTop+122-40;setTimeout((()=>{window.scrollTo(0,e)}),0)}t++}}}(e))}const $s={tagName:"mppoi",isWechat:(He.isAndroid||He.isIOS)&&He.isWechat&&!He.isWxWork,screen_height:Be.getInnerHeight(),commonReportData:{bizuin:1*l(window.biz),msgid:1*window.mid,itemidx:1*window.idx,sessionidnew:window.sessionid,enterid:1*window.enterid},poiDom:[]},Hs=e=>{$s.isWechat?Ue.invoke("openLocation",{latitude:1*e.latitude,longitude:1*e.longitude,name:e.name,address:e.address,infoUrl:""},(function(e){-1!==e.err_msg.indexOf("ok")?Me.setSum(110809,53,1):Me.setSum(110809,54,1)})):new Xe({msg:"请使用移动端微信打开。"})},Us=()=>{for(let e=0;e<$s.poiDom.length;e++){const t=$s.poiDom[e];if(1*t.getAttribute("data-hasreport")!=1){t.setAttribute("data-hasreport",1);const e=document.documentElement.scrollTop||document.body.scrollTop;t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+$s.screen_height&&("A"===t.tagName?(Je.report(19937,Object.assign({},$s.commonReportData,{type:1,actiontype:1})),Me.setSum(110809,58,1)):(Je.report(19937,Object.assign({},$s.commonReportData,{type:2,actiontype:1})),Me.setSum(110809,56,1)))}}},Fs=(e={})=>{if(e.node&&e.data&&e.data.img){const t=function(e){let t=e.node,i=e.data;return function(){let e=document.createElement("div");e.innerHTML=Ve.tmpl('<div class="ct_geography_loc_card weapp_card app_context appmsg_card_context wx_tap_card" data-id="<#=data.id#>" data-latitude="<#=data.latitude#>" data-longitude="<#=data.longitude#>">\n  <div id="poi_name_<#=data.id#>" role="link" tabindex="0" aria-labelledby="poi_name_tips_<#=data.id#> poi_name_<#=data.id#> js_a11y_comma poi_addr_<#=data.id#>" class="location_title line-clamp1"><#=data.name#></div>\n  <div class="weui-hidden_abs" id="poi_name_tips_<#=data.id#>" aria-hidden="true">位置：</div>\n  <div id="poi_addr_<#=data.id#>" class="location_detail line-clamp1" aria-hidden="true"><#=data.address#></div>\n  <div class="location_img_wrp" style="background-image:url(<#=data.img#>);"></div>\n</div>',{data:i},!0).replace(/>\s*</g,"><").replace(/^\s+/,"").replace(/\s+$/,"");let n=e.firstChild;t.parentNode.insertBefore(n,t.nextSibling);let a=t.parentNode.querySelector('[data-preloadingid="'+i.id+'"]');a&&a.parentNode.removeChild(a),((e={})=>{const t=e.dom,i=e.poiInfo;$e.on(t,"tap",(function(e){G.highlightEle(t),e.stopPropagation(),e.preventDefault(),Je.report(19937,Object.assign({},$s.commonReportData,{type:2,actiontype:2})),Me.setSum(110809,55,1),Hs(i)}),!0),$e.on(t,"click",(e=>{e.preventDefault(),e.stopPropagation()}),!0)})({dom:n,poiInfo:i}),$s.poiDom.push(n),Us()}}(e),i=function(){this.onload=null,this.onerror=null,t()};let n=new Image;n.onload=i,n.onerror=i,n.src=e.data.img}},Vs={oldTagName:"mpsearch",tagName:"mp-common-search",isWechat:(He.isAndroid||He.isIOS)&&He.isWechat&&!He.isWxWork,keywords:[],screen_height:Be.getInnerHeight(),exposeHasReport:0,commonReportData:{BizUin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,SearchKeyWord:"",SessionId:window.sessionid,EnterId:1*window.enterid,Scene:1*window.source,SubScene:1*window.subscene}},Js=(e={})=>{$e.on(e.dom,"click",(function(){let e=Vs.keywords.map((e=>e.label)).join(";");if(Je.report(19453,Object.assign({},Vs.commonReportData,{SearchKeyWord:e,EventType:2})),Me.setSum(110809,47,1),Vs.isWechat){if(He.isIOS&&He.ltVersion("7.0.12")||He.isAndroid&&He.ltVersion("7.0.12"))return void new Xe({msg:"当前微信版本不支持展示该内容，请升级至最新版本。"});const e=[];for(let t=0;t<Vs.keywords.length;t++)e.push({hotword:Vs.keywords[t].label,id:t,optype:1});Ue.invoke("openWXSearchPage",{query:"",thirdExtParam:JSON.stringify({data:[{items:e,title:window.nickname+"推荐搜索",type:4}],from:"mpWidget",bizUserName:window.user_name,bizNickName:window.nickname,id:`mpWidget_${Vs.commonReportData.BizUin}:${Vs.commonReportData.MsgId}:${Vs.commonReportData.ItemIdx}`})},(function(e){-1!==e.err_msg.indexOf("ok")?Me.setSum(110809,48,1):Me.setSum(110809,49,1)}))}else new Xe({msg:"请使用移动端微信打开。"})}));const t=()=>{if(!Vs.exposeHasReport){Vs.exposeHasReport=1;const t=document.documentElement.scrollTop||document.body.scrollTop;if(e.dom.clientHeight+e.dom.offsetTop>=t+e.dom.clientHeight/2&&e.dom.clientHeight+e.dom.offsetTop<=t+e.dom.clientHeight/2+Vs.screen_height){let e=Vs.keywords.map((e=>e.label)).join(";");Je.report(19453,Object.assign({},Vs.commonReportData,{SearchKeyWord:e,EventType:1})),Me.setSum(110809,46,1)}}};$e.on(window,"scroll",t),t()};const Ks=e=>{const t=e+"";return t.length>=2?t:"0"+t},Xs=e=>{const t=new Date(1e3*e);return t.getFullYear()<=(new Date).getFullYear()?`${Ks(t.getMonth()+1)}月${Ks(t.getDate())}日 ${Ks(t.getHours())}:${Ks(t.getMinutes())}`:`${t.getFullYear()}年${Ks(t.getMonth()+1)}月${Ks(t.getDate())}日 ${Ks(t.getHours())}:${Ks(t.getMinutes())}`};var Gs=(e,t)=>{let i;switch(e=parseInt(e,10),t=parseInt(t,10),e){case 0:i=0===t?"预约":"已预约";break;case 1:i="已失效";break;case 2:i="观看直播";break;case 3:case 4:i="已结束";break;case 5:i="观看回放";break;default:i="预约"}return i},Ys=(e,t)=>{let i;switch(t=parseInt(t,10)){case 0:i=`将在${Xs(e)} 直播`;break;case 1:case 3:i=`${Xs(e)} 直播`;break;case 2:default:i="正在直播";break;case 4:i="已结束直播，正在生成回放";break;case 5:i="已结束直播，可观看回放"}return i};var Qs=(e,t,i,n)=>{let a=0;try{a=1*window.atob(window.biz)}catch(o){}Je.report(22035,{BizUin:a,AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Scene:window.parseInt(window.scene,10)||0,Enterid:window.parseInt(window.enterid,10)||0,Action:e,Status:n||"",ActionTS:Math.ceil(Date.now()/1e3),Noticeid:t||"",Username:i||""})};var Zs=(e,t)=>{let i=0;try{i=1*window.atob(window.biz)}catch(n){}Je.report(24980,{BizUin:i,AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Scene:window.parseInt(window.scene,10)||0,Enterid:window.parseInt(window.enterid,10)||0,Action:e,ActionTS:Math.ceil(Date.now()/1e3),EventId:t+""||""})};let er=[],tr=[],ir=[],nr=[],ar=[],or=[],sr=1,rr=0;try{rr=1*window.atob(window.biz)}catch(vd){}function dr(){return!!De.os.pc&&(!(!He.isMac||!He.cpVersion("3.1.0",1,!0,"mac"))||!!(He.isWindows&&He.getWindows()>="63030000"))}function lr(e,t,i){Je.report(21146,{BizUin:rr,AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,ExportId:t||"",Action:e,Username:i||"",Scene:window.parseInt(window.scene,10)||0,Subscene:window.parseInt(window.subscene,10)||0,EnterId:window.parseInt(window.enterid,10)||0})}function cr(e){"live"!==e&&"topic"!==e?("1"!==e&&0!==e||He.isInMiniProgram&&window.weui.alert("暂不支持从小程序进入视频号"),He.isAndroid&&window.clientversion>"2700135F"&&window.clientversion<"27001400"?window.weui.alert("当前版本暂不支持查看"):(He.isWechat&&De.os.pc?window.weui.alert("当前版本暂不支持查看，请在手机上查看"):He.isWechat&&!He.isWxWork||alert("请使用微信手机客户端打开"),!He.isWechat||De.os.pc||He.isWxWork||tt.jumpUrl("https://support.weixin.qq.com/update/",!0))):He.isAndroid&&window.clientversion<"2700143c"||He.isIOS&&window.clientversion<"17001228"?window.weui.alert("请升级微信客户端版本后查看"):He.isWechat&&De.os.pc?window.weui.alert("当前版本暂不支持查看，请在手机上查看"):He.isInMiniProgram?window.weui.alert("暂不支持从小程序进入直播间"):He.isWechat&&!He.isWxWork||alert("请使用微信手机客户端打开")}function pr(e){if(!He.isWechat||De.os.pc||He.isWxWork||He.isAndroid&&window.clientversion<"2700143c"||He.isIOS&&window.clientversion<"17001228")cr("profile");else{let t={action:"openFinderProfile",finderUserName:e,commentScene:5,reportExtraInfo:JSON.stringify({scenenote:{bizUin:rr,msgid:window.parseInt(window.mid,10)||0,idx:window.parseInt(window.idx,10)||0,scene:window.parseInt(window.scene,10)||0,enterid:window.parseInt(window.enterid,10)||0,action:5,status:sr,actionTS:Math.ceil(Date.now()/1e3),url:window.msg_link}})};Ue.invoke("openFinderView",{extInfo:t},(e=>{console.log("openFinderView",e)}))}}function _r(e,t){if(!He.isWechat||De.os.pc||He.isWxWork||He.isAndroid&&window.clientversion<"2700143c"||He.isIOS&&window.clientversion<"17001228"||window.is_teenager&&(window.weui.alert("青少年模式下，不支持观看直播"),1))if(dr())if(t){let e=(window.location.protocol||"https:")+`//channels.weixin.qq.com/web/pages/live?eid=${t=encodeURIComponent(t)}`;Ue.invoke("openUrlWithExtraWebview",{url:e,openType:1},(e=>{console.log("openUrlWithExtraWebview",e)}))}else cr();else cr("live");else Ue.invoke("openFinderView",{extInfo:{action:"autoOpenFinderLive",finderUserName:e,commentScene:5,reportExtraInfo:JSON.stringify({scenenote:{bizUin:rr,msgid:window.parseInt(window.mid,10)||0,idx:window.parseInt(window.idx,10)||0,scene:window.parseInt(window.scene,10)||0,enterid:window.parseInt(window.enterid,10)||0,action:4,status:sr,actionTS:Math.ceil(Date.now()/1e3),url:window.msg_link}})}},(e=>{console.log("openFinderLive",e)}))}function mr(e,t,i){!He.isWechat||De.os.pc||He.isWxWork||He.isAndroid&&window.clientversion<"2700143c"||He.isIOS&&window.clientversion<"17001228"||Ue.invoke("openFinderView",{extInfo:{action:"autoOpenFinderLive",finderUserName:e,commentScene:5,feedID:t,nonceID:i,exportId:t,enableReplay:!0}})}function ur(e,t,i,n,a){if(lr(2,e,i),!He.isWechat||De.os.pc||He.isWxWork||He.isIOS&&He.ltVersion("7.0.15",!1)||He.isAndroid&&window.clientversion<="27001337"||He.isAndroid&&window.clientversion>"2700135F"&&window.clientversion<"27001400")if(dr())if(a){let e=(window.location.protocol||"https:")+`//channels.weixin.qq.com/web/pages/feed?eid=${a=encodeURIComponent(a)}`;Ue.invoke("openUrlWithExtraWebview",{url:e,openType:1},(e=>{console.log("openUrlWithExtraWebview",e)}))}else cr(n);else lr(3,e,i),cr(n);else{let i={action:"openFinderFeed",feedID:e,nonceID:t,notGetReleatedList:9===n?"1":0,shareScene:11,requestScene:16,reportExtraInfo:JSON.stringify({mp:{scene:1},bizUin:rr,url:window.msg_link})};Ue.invoke("openFinderView",{extInfo:i},(e=>{console.log("openFinderDetailView",e)}))}}function wr(e,t){!He.isWechat||De.os.pc||He.isWxWork||He.isAndroid&&window.clientversion<"28000130"||He.isIOS&&window.clientversion<"18000622"||window.is_teenager&&(window.weui.alert("青少年模式下，不支持观看直播"),1)?cr("topic"):Ue.invoke("openFinderTopicView",{extInfo:{title:e,topicType:7,eventEncryptedTopicId:t,entryScene:5}},(e=>{console.log("openFinderTopicView",e)}))}function hr(e){if(!e)return 0;const t=1e4;return e<t?e:e>1e5?"10万+":(e/t).toFixed(1)/1+"万"}function gr(e){return tr.filter((t=>t.export_id===e))}function fr(e){return ir.filter((t=>t.notice_id===e))}function yr(e){return nr.filter((t=>t.event_id===e))}function br(e){let t=e.parentNode;if(t){let e,i=t.getAttribute("data-id"),n=gr(i);n&&n.length>0&&(e=n[0]);let a=e&&e.nonce_id?e.nonce_id:t.getAttribute("data-nonceid"),o=e&&e.flag||0,s=e&&e.username?e.username:t.getAttribute("data-username"),r=e&&e.media_type?e.media_type:t.getAttribute("data-mediatype"),d=e&&e.export_id;0===o&&ur(i,a,s,r,d)}}function vr(e){let t=e.parentNode;if(t){let e=t.getAttribute("data-eventid")||"event/UzFfAgtgekIEAQAAAAAA8PsgAc-cEgAAAAstQy6ubaLX4KHWvLEZgBPE8KNsXHhHYfj-zNPgMI5VOd7tKLpk98zswwl8bF9v",i=yr(e),n=i.length>0?i[0]:{event_info:{}};0===n.event_info.flag?(wr(n.event_info.name,e),Zs(2,e)):Zs(3,e)}}function xr(e){let t=fr(e);t&&t.length>0&&(t=t[0]);let i=t.status,n=t.reservation;return 0===i?0===n?1:2:1===i?5:2===i?3:3===i?4:1}function kr(e,t,i){!He.isWxWork&&He.isWechat?window.is_teenager?window.weui.alert("青少年模式下，不支持预约直播"):Ne({url:"/mp/appmsg_video_snap?action=reserve_live",type:"POST",dataType:"json",async:!0,data:{username:e,notice_id:t,reserve_status:i},success:function(e){if(e&&e.base_resp&&0===e.base_resp.ret){let e=document.querySelectorAll(`.js_channel_btn_operation[data-noticeid="${t}"]`);for(let t=0;t<e.length;t++){let n=e[t];n.setAttribute("data-reservation",1===i?1:0),n.querySelector(".js_channel_btn_operation_wording").innerHTML=1===i?"已预约":"预约",1===i?Fe.addClass(n,"weui-btn_disabled"):Fe.removeClass(n,"weui-btn_disabled")}let n=fr(t);n&&n.length>0&&n.forEach((e=>{e.reservation=1===i?1:0}))}else window.weui.alert("系统繁忙，请稍后再试")},error:function(){window.weui.alert("操作失败")}}):window.weui.alert("请在微信内操作")}function Cr(){if(er&&er.length&&ar.length===er.length)$e.off(window,"scroll",Cr);else for(let e=0;e<er.length;e++){let t=er[e],i=t.firstChild;if(i&&i.getBoundingClientRect().top>0&&i.getBoundingClientRect().top+i.getBoundingClientRect().height/2<=Be.getInnerHeight()){let e=t.getAttribute("data-id")||t.getAttribute("data-noticeid")||t.getAttribute("data-eventid"),i=t.getAttribute("data-username"),n=t.getAttribute("data-type");-1===ar.indexOf(e)&&(ar.push(e),"live"===n?Qs(1,e,i,xr(e)):"topic"===n?Zs(1,xr(e)):lr(1,e,i))}}}function Tr(e,t,i,n){let a=document.querySelectorAll(`.js_wechannel_live_card[data-noticeid="${e}"]`);for(let o=0;o<a.length;o++){let s=a[o],r=s.querySelector(`.js_channel_btn_operation[data-noticeid="${e}"]`),d=Gs(t,i),l=Ys(n,t);r&&(r.querySelector(".js_channel_btn_operation_wording").innerHTML=d,r.setAttribute("data-reservation",i),r.setAttribute("data-status",t),s.querySelector(".js_wechannel_live_desc").innerHTML=l,0!==t&&2!==t||0!==i?Fe.addClass(r,"weui-btn_disabled"):Fe.removeClass(r,"weui-btn_disabled"),r.querySelector(".js_wechannnel_live").style.display=2===t?"block":"none")}}function Ir(){$e.bindVisibilityChangeEvt((e=>{e&&function(){let e={__biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",uin:window.uin||"",key:window.key||"",pass_ticket:window.pass_ticket||"",video_snap_num:ir.length};for(let i=0;i<ir.length;i++){let t=ir[i].notice_id,n=ir[i].username;e[`notice_id_${i}`]=t,e[`username_${i}`]=n}let t="/mp/appmsg_video_snap?action=batch_get_flag_info";for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t+="&"+i+"="+encodeURIComponent(e[i]));Ne({url:t,type:"GET",dataType:"json",async:!0,success:function(e){if(e&&e.base_resp&&0===e.base_resp.ret&&(console.log("batch_get_flag_info:",e),e.live_info&&e.live_info.length>0))for(let t=0;t<e.live_info.length;t++){let i=e.live_info[t],n=fr(i.notice_id);if(n&&n.length>0){let e=n[0];i.status===e.status&&i.reservation===e.reservation||(e.reservation=i.reservation,e.status=i.status,Tr(i.notice_id,i.status,i.reservation,e.start_time))}}},error:function(){}})}()}))}function Sr(){!function(){let e=document.getElementsByClassName("js_wechannel_img_card");for(let t=0;t<e.length;t++){let i=e[t];$e.on(i,"click",(()=>{G.highlightEle(i),br(i)}))}}(),function(){let e=document.getElementsByClassName("js_wechannel_video_card");for(let t=0;t<e.length;t++){let i=e[t];$e.on(i,"click",(()=>{G.highlightEle(i),br(i)}))}}(),function(){let e=document.getElementsByClassName("js_channel_btn_operation"),t=e=>{let t=e.currentTarget,i=t.getAttribute("data-noticeid"),n=t.getAttribute("data-username"),a="";return ir instanceof Array&&ir.forEach((e=>{e.notice_id===i&&(a=e.export_id)})),Qs(4,i,n,xr(i)),sr=xr(i),_r(n,a),!1};for(let i=0;i<e.length;i++){let n=e[i],a=parseInt(n.getAttribute("data-status"),10);if(2===a)$e.on(n,"click",t);else if(0===a)$e.on(n,"click",(()=>{if(G.highlightEle(n),window.is_temp_url)return window.weui.alert("预览状态下无法操作"),!1;let e=n.getAttribute("data-noticeid"),t=n.getAttribute("data-reservation"),i=n.getAttribute("data-username");return Qs("0"===t?2:3,e,i,xr(e)),kr(i,e,"0"===t?1:2),!1}));else if(5===a){const e=n.getAttribute("data-noticeid"),t=n.getAttribute("data-username"),i=fr(e)||[],a=i[0]&&i[0].export_id;$e.on(n,"click",(()=>{mr(t,a,e)}))}}}(),function(){let e=document.getElementsByClassName("js_wechannel_live_card");const t=e=>{let t=e.currentTarget,i=t.getAttribute("data-username"),n=t.getAttribute("data-noticeid");Qs(5,n,i,xr(n)),sr=xr(n),G.highlightEle(t),pr(i)};for(let i=0;i<e.length;i++){let n=e[i];$e.on(n,"click",t)}}(),function(){let e=document.getElementsByClassName("js_wechannel_topic_card");for(let t=0;t<e.length;t++){let i=e[t];$e.on(i,"click",(()=>{G.highlightEle(i),vr(i)}))}}(),Ir(),$e.on(window,"scroll",Cr)}function Er(e,t){if(t){if(t.isSaveEnter)return e.replace(/\n/g,"<br>");if(t.isDecodeEnter)return e.replace(/&lt;br&gt;/g,"<br>")}return e}function Ar(){let e=document.getElementById("js_content");if(e){er=e.getElementsByTagName("mpvideosnap")||[];for(let e=0;e<er.length;e++){let t,i=er[e],n=i.getAttribute("data-id")||i.getAttribute("data-noticeid")||"",a=i.getAttribute("data-type")||"video";if("live"===a){let e=fr(i.getAttribute("data-noticeid")||""),n=e.length>0?e[0]:{};t={snapType:"live",headImgUrl:n.head_url||i.getAttribute("data-headimgurl")||"",nickname:n.nickname||i.getAttribute("data-nickname")||"",desc:Ys(n.start_time,n.status)||i.getAttribute("data-desc")||"",reservation:n.reservation||0,status:n.status||0,username:n.username||i.getAttribute("data-username")||"",noticeid:n.notice_id||i.getAttribute("data-noticeid")||"",liveWording:Gs(n.status||0,n.reservation||0),flag:1===n.spam_flag||2===n.spam_flag?1:0,intro:Er(n.introduction||"",{isSaveEnter:!0})},or.push({noticeid:n.notice_id||i.getAttribute("data-noticeid")||"",status:n.status||0})}else if("video"===a||"image"===a){let e=gr(n),o=e.length>0?e[0]:{},s=hr(1*o.feed_like_num),r=4===o.media_type||9===o.media_type?"video":"image",d=((1*i.getAttribute("data-ratio")||1)>1?o.feed_full_cover_url||o.feed_thumb_url:o.feed_cover_url||o.feed_thumb_url)||i.getAttribute("data-url")||"";"image"===a&&(d=o.feed_thumb_url||i.getAttribute("data-url")||""),t={snapType:o&&o.media_type?r:i.getAttribute("data-type"),url:d,headImgUrl:o.head_url||i.getAttribute("data-headimgurl")||"",authiconUrl:o.auth_info&&o.auth_info.auth_icon_url||"",nickname:o.nickname||i.getAttribute("data-nickname")||"",desc:o.feed_desc||i.getAttribute("data-desc")||"",flag:o.flag||0,likenum:s,isNews:o.is_news},"image"===t.snapType&&(t=Object.assign(t,{imgCount:parseInt(o.media_num||"0",10)||parseInt(i.getAttribute("data-imgcount")||"0",10)||0}))}else if("topic"===a){let e=yr(i.getAttribute("data-eventid")||"event/UzFfAgtgekIEAQAAAAAA8PsgAc-cEgAAAAstQy6ubaLX4KHWvLEZgBPE8KNsXHhHYfj-zNPgMI5VOd7tKLpk98zswwl8bF9v"),n=e.length>0?e[0]:{event_info:{}},a=y.unix(n.event_info.end_time).format("YYYY年MM月DD日 HH:mm");t={snapType:"topic",headImgUrl:n.event_info.head_url,nickname:n.event_info.nickname,desc:n.event_info.desc,flag:n.event_info.flag,endTime:a,closeFlag:n.event_info.close_flag,title:n.event_info.name}}const o=document.createElement("div");let s=Ve.tmpl('\n<# if(snapType === \'video\'){ #>\n  <div role="option" tabindex="0" class="wxw_wechannel_card appmsg_card_channel appmsg_card_context js_wechannel_video_card" title="轻点两下前往视频号">\n    <div class="wxw_wechannel_card_bd">\n      <div class="wxw_wechannel_video_context" style="background-image:url(<#=url#>)">\n        <i class="weui-play-btn_primary"></i>\n      </div>\n      \x3c!-- 不可引用时show出来即可 --\x3e\n      <# if(flag===1){ #>\n        <div class="wxw_wechannel_msg">\n          该视频号动态已删除\n        </div>\n      <# } else if (flag===2) { #>\n        <div class="wxw_wechannel_msg">\n          无法浏览该视频号动态\n        </div>\n      <# } else if (flag===3) { #>\n        <div class="wxw_wechannel_msg">\n          无法浏览该视频号动态\n        </div>\n      <# } #>\n    </div>\n    <div class="wxw_wechannel_card_ft weui-flex">\n      <div class="wxw_wechannel_profile weui-flex">\n        <div class="wxw_wechannel_logo"></div>\n        <div class="wxw_wechannel_nickname js_wx_tap_highlight">\n          <#=nickname#>\n        </div>\n        <# if (authiconUrl) {#>\n          <div class="wxw_wechannel_authicon_wrp" style="background-image:url(<#=authiconUrl#>)"></div>\n        <# } #>\n      </div>\n      <# if (likenum) {#>\n        <div class="wxw_wechannel_like weui-flex">\n          <div class="wxw_wechannel_like_icon <# if(isNews === true){ #>  wxw_wechannel_like_hot <# } #>"></div>\n          <div class="wxw_wechannel_like_content">\n            <span class="weui-hidden_abs">，赞 </span>\n            <#=likenum#>\n          </div>\n        </div>\n      <# } #>\n    </div>\n  </div>\n\n<# } else if (snapType === \'image\'){  #>\n<div role="option" tabindex="0" class="wxw_wechannel_card appmsg_card_channel appmsg_card_context js_wechannel_img_card js_wechannel_img_context" title="轻点两下前往视频号">\n  <div class="wxw_wechannel_card_bd">\n    <div class="wxw_wechannel_img_context" style="background-image:url(<#=url#>)">\n        <ul class="wxw_wechannel_img_list js_wechannel_img_list" style="display:none;" id="js_wechannel_img_list" data-poster-src="<#=url#>" data-disable-preview="1">\n            <li class="wxw_wechannel_img js_wechannel_img" data-w="1000" data-ratio="1" style="background-image:url(<#=url#>)" data-disable-preview="1"></li>\n        </ul>\n        <ul class="wxw_wechannel_img_navs js_wechannel_img_navs" style="display:none;">\n          <# for(var i = 0; i < imgCount; i++){ #>\n            <li class="wxw_wechannel_img_nav <# if(i === 0){ #>  wxw_wechannel_img_nav_current <# } #> "></li>\n          <# } #>\n        </ul>\n    </div>\n    <# if(flag === 1){ #>\n      <div class="wxw_wechannel_msg">\n        该视频号动态已删除\n      </div>\n    <# } else if (flag === 2) { #>\n      <div class="wxw_wechannel_msg">\n        无法浏览该视频号动态\n      </div>\n    <# } else if (flag === 3) { #>\n      <div class="wxw_wechannel_msg">\n        无法浏览该视频号动态\n      </div>\n    <# } #>\n  </div>\n  <div class="wxw_wechannel_card_ft weui-flex">\n    <div class="wxw_wechannel_profile weui-flex">\n      <div class="wxw_wechannel_logo"></div>\n      <div class="wxw_wechannel_nickname js_wx_tap_highlight">\n        <#=nickname#>\n      </div>\n      <# if (authiconUrl) {#>\n        <div class="wxw_wechannel_authicon_wrp" style="background-image:url(<#=authiconUrl#>)"></div>\n      <# } #>\n    </div>\n    <# if (likenum) {#>\n      <div class="wxw_wechannel_like weui-flex">\n        <div class="wxw_wechannel_like_icon <# if(isNews === true){ #>  wxw_wechannel_like_hot <# } #>"></div>\n        <div class="wxw_wechannel_like_content">\n          <span class="weui-hidden_abs">，赞 </span>\n          <#=likenum#>\n        </div>\n      </div>\n    <# } #>\n  </div>\n</div>\n\n<# } else if (snapType === \'live\') { #>\n<div class="wxw_wechannel_card appmsg_card_context wxw_wechannel_card_live js_wechannel_live_card" data-noticeid="<#=noticeid#>" data-username="<#=username#>">\n  <div class="wxw_wechannel_card_bd">\n    <div class="wxw_wechannel_live_context">\n      <div class="weui-flex wxw_wechannel_live_overview">\n        <div class="wxw_wechannel_live_hd">\n          <img class="wxw_wechannel_live_avatar" src="<#=headImgUrl#>" alt="">\n        </div>\n        <div class="wxw_wechannel_live_bd weui-flex__item" role="option" title="轻点两下前往视频号">\n          <strong class="wxw_wechannel_live_nickname"><#=nickname#></strong>\n          <div class="weui-hidden_abs">，</div>\n          <div class="wxw_wechannel_live_desc js_wechannel_live_desc"><#=desc#></div>\n        </div>\n        <div class="wxw_wechannel_live_ft js_wechannel_operation_area">\n          <button class="weui-btn weui-btn_mini wxw_wechannel_live_btn js_channel_btn_operation <# if((status !== 0 && status !== 2 && status !== 5)|| reservation === 1){ #>weui-btn_disabled<# } #>" data-reservation="<#=reservation#>" data-noticeid="<#=noticeid#>" data-username="<#=username#>" data-status="<#=status#>" type="button">\n            <i class="icon_wxw_wechannel_live js_wechannnel_live" <#if (status !== 2){ #> style="display:none" <# } #>></i>\n            <span class="js_channel_btn_operation_wording"><#=liveWording#></span>\n          </button>\n        </div>\n      </div>\n      <div class="wxw_wechannel_live_tips"><#=intro#></div>\n    </div>\n    <# if (flag === 1) { #>\n      <div class="wxw_wechannel_msg">\n        无法浏览该视频号动态\n      </div>\n    <# } else if (flag === 2) { #>\n      <div class="wxw_wechannel_msg">\n        无法浏览该视频号动态\n      </div>\n    <# } else if (flag === 3) { #>\n      <div class="wxw_wechannel_msg">\n        无法浏览该视频号动态\n      </div>\n    <# } #>\n  </div>\n  <div class="wxw_wechannel_card_ft weui-flex" id="wxw_wechannel_logo_<#=noticeid#>">\n    <i class="wxw_wechannel_logo"></i>视频号\n  </div>\n</div>\n\n<# } else if (snapType === \'topic\') { #>\n<div class="wxw_wechannel_card appmsg_card_context wxw_wechannel_card_topic js_wechannel_topic_card js_wx_tap_highlight wx_tap_card">\n  <div class="wxw_wechannel_card_bd">\n    <div class="wxw_wechannel_topic_context">\n      <div class="weui-flex weui-flex_align-center wxw_wechannel_topic_profile">\n        <div class="wxw_wechannel_topic_hd">\n          <img class="wxw_wechannel_topic_avatar" src="<#=headImgUrl#>" alt="">\n        </div>\n        <div class="wxw_wechannel_topic_bd weui-flex__item">\n          <strong class="wxw_wechannel_topic_nickname"><#=nickname#></strong>\n        </div>\n      </div>\n      <div class="weui-flex weui-flex_align-center">\n        <div class="wxw_wechannel_topic_bd weui-flex__item">\n          <strong class="wxw_wechannel_topic_name"><#=title#></strong>\n        </div>\n        <div class="wxw_wechannel_topic_ft js_wechannel_operation_area">\n          <button class="weui-btn weui-btn_mini wxw_wechannel_topic_btn" <# if(closeFlag){ #>disabled<# } #> type="button"><# if(closeFlag){ #>已结束<# } else { #>参与<# } #></button>\n        </div>\n      </div>\n      <div role="option">\n        <div class="wxw_wechannel_topic_tips"><#=desc#></div>\n        <div class="weui-hidden_abs"> </div>\n        <div class="wxw_wechannel_topic_tips">结束时间：<#=endTime#></div>\n      </div>\n    </div>\n    <# if (flag === 3) { #>\n      <div class="wxw_wechannel_msg">\n        无法浏览该视频号动态\n      </div>\n    <# } else if (flag !== 0) { #>\n      <div class="wxw_wechannel_msg">\n        此视频号活动因违规无法查看\n      </div>\n    <# } #>\n    <# if (flag === 3453464560) { #>\n      <div class="wxw_wechannel_msg">\n        <span tabindex="0" role="img" aria-label="加载中" class="weui-primary-loading">\n          <span class="weui-primary-loading__dot"></span>\n        </span>\n      </div>\n    <# } #>\n  </div>\n  <div role="option" class="wxw_wechannel_card_ft weui-flex" id="wxw_wechannel_logo_<#=noticeid#>">\n    <i class="wxw_wechannel_logo"></i>视频号<span class="wxw_wechannel_logo_tail">活动</span>\n  </div>\n</div>\n<# } #>\n',t,!0);o.innerHTML=Er(s,{isDecodeEnter:!0}),"video"!==a&&"image"!==a||Rr(o,i),o.firstElementChild&&i.appendChild(o.firstElementChild);let r=i.parentNode.querySelector(`[data-preloadingid="${n}"]`);r&&i.parentNode.removeChild(r)}Cr(),Sr()}}function Rr(e,t){let i=t.getAttribute("data-computedHeight")||0,n=t.getAttribute("data-computedWidth")||0;i=Math.round(i),n=Math.round(n);let a=t.getAttribute("data-isHorizontal")||!1;if(e.firstElementChild){"true"===a&&e.firstElementChild.classList.add("wxw_wechannel_card_horizontal");try{if(n){let t=e.firstElementChild;t&&(t.style.width=n+"px")}if(i){let t=e.firstElementChild.children[0].children[0];t&&(t.style.height=i+"px")}}catch(vd){window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.onError(err)}}}function jr(){!function(){let e=[];try{e=JSON.parse(window.video_snap_json).list}catch(vd){console.log(vd)}let t={},i={__biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",uin:window.uin||"",key:window.key||"",pass_ticket:window.pass_ticket||""},n=0;for(let a=0;a<e.length;a++){let o=e[a].export_id||e[a].notice_id||e[a].event_id,s=e[a].username;t[o]?t[o].push(a):(t[o]=[a],e[a].export_id?i[`exportid_${n}`]=o:e[a].notice_id?i[`notice_id_${n}`]=o:e[a].event_id&&(i[`export_event_id_${n}`]=o),i[`username_${n}`]=s,n++)}i.video_snap_num=Object.keys(t).length,Ne({url:"/mp/appmsg_video_snap?action=batch_get_video_snap",type:"POST",dataType:"json",async:!0,data:i,success:function(e){e&&e.base_resp&&0===e.base_resp.ret&&(tr=e.video_snap_info||[],ir=e.live_info||[],nr=e.event_info||[]),Ar()},error:function(){Ar()}})}()}let Br={pvele:[],checkInScreenId:null,reportRandom:Math.random()};function Nr(){if(console.log("weproduct init"),"function"!=typeof document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_container");e&&e.length>0&&(!function(e){try{for(let t=0,i=e.length;t<i;t++){let i=e[t];if(i.className.indexOf("js_list_container")>=0){let e=i.querySelector("img.js_cover");if(e){let t=e.parentNode.getBoundingClientRect();e.style.setProperty("width",t.width+"px","important"),e.style.setProperty("height",t.height+"px","important"),e.style.setProperty("background-size","unset","important"),"0"==e.getAttribute("data-fail")?Dr.call(e):e.getAttribute("data-fail")||(e.lazyLoadOnload=e.lazyLoadOnload||[],e.lazyLoadOnload.push(Dr))}}}}catch(vd){}}(e),C.getAppidInfo({onSuccess:function(t){Br.data=t.data,function(e){for(let i=0,n=e.length;i<n;i++)!function(e,t){$e.on(e,"tap",".js_product_loop_content",(function(e){let i=e.delegatedTarget,n=i.getAttribute("data-wxaappid"),a=i.getAttribute("data-wxapath"),o=i.getAttribute("data-pid"),s=i.getAttribute("data-appid"),r=i.querySelector(".cps_inner_info_title").innerHTML;return i&&G.highlightEle(i),C.jumpUrl({privateExtraData:{cookies:"cps_package=123456; expires=1538286412; busid=mmbiz_ad_cps; domain=*"},sourceAppId:s,appid:n,path:a,scene:1091,sceneNote:[encodeURIComponent(location.href),user_name,msg_title,encodeURIComponent(o),r,a].join(":"),beforeNonWechatWarn:function(){},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){if("openWeApp:ok"===e.err_msg&&o){let e=2;2==i.getAttribute("data-pidtype")&&(e=4),Lr([{wxa_appid:n,pid:o,type:e,absolute_order:t+1,appid:i.getAttribute("data-appid")||"",templateid:i.getAttribute("data-templateid")||"",relative_order:1*i.getAttribute("data-order"),packid:i.getAttribute("data-packid")||""}])}}}),!1}))}(e[i],i);let t=document.getElementsByClassName("js_product_loop_content");if(t&&t.length>0&&Be.getInnerHeight()){for(let e=0;e<t.length;e++)Br.pvele.push(t[e]);Pr(),$e.on(window,"scroll",Pr)}}(e)}})),setTimeout((function(){let e=document.getElementsByClassName("js_product_loop_content").length,t=document.getElementsByClassName("js_product_err_container").length;Me.setSum("64469","15",e+t),Me.setSum("64469","16",e),Me.setSum("64469","18",t)}),0)}function Dr(){let e=this.parentNode;if(!e)return;let t=document.createElement("span");t.className=this.className,t.style.background='url("'+this.src+'") no-repeat center',e.insertBefore(t,this),e.removeChild(this)}function Pr(e){Br.checkInScreenId&&clearTimeout(Br.checkInScreenId),Br.checkInScreenId=setTimeout((function(){Br.checkInScreenId=null;let e=[];for(let t=0;t<Br.pvele.length;t++){let i=Br.pvele[t],n=i.getBoundingClientRect();if((n.height||n.bottom-n.top)>0&&n.top<Be.getInnerHeight()&&n.bottom>0){let n=i.getAttribute("data-pid");if(n){let a=1;2==i.getAttribute("data-pidtype")&&(a=3),e.push({wxa_appid:i.getAttribute("data-wxaappid"),pid:n,type:a,absolute_order:t+1,appid:i.getAttribute("data-appid")||"",templateid:i.getAttribute("data-templateid")||"",relative_order:1*i.getAttribute("data-order"),packid:i.getAttribute("data-packid")||""})}Br.pvele.splice(t--,1)}}Lr(e),0==Br.pvele.length&&($e.off(window,"scroll",Pr),Pr=null)}),100)}function Lr(e){if(!e||0==e.length)return;let t={batch_no:Pe.getQuery("batch_no")||"",bizuin:window.biz||"",biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",total:e.length};for(let i=0;i<e.length;i++){let n=e[i],a=i+1;for(let e in n)n.hasOwnProperty(e)&&(t[e+""+a]=n[e])}Ne({url:"/mp/productreport?",type:"POST",data:t,dataType:"json",async:!0})}const Mr=window.location.protocol+"//support.weixin.qq.com/update/";let qr=[],Or=1,zr=Pe.getQuery("fontScale");function Wr(e){zr=e.fontScale,setTimeout((()=>{let e=document.getElementsByTagName("wx-open-subscribe")||[];for(let t=0;t<e.length;t++)e[t].setAttribute("size",Or),e[t].setAttribute("scale",zr),Or++}),50)}function $r(){if(!document.getElementById("js_content"))return;const e=document.querySelectorAll("mpsubscribe");for(let t=0;t<e.length;t++){let i=e[t];const n=document.createElement("mp-common-subscribe"),a=i.getAttribute("data-templateidlist");let o=i.getAttribute("data-index")||0;i.parentNode.appendChild(n),i.parentNode.removeChild(i),n.setAttribute("data-templateidlist",a),n.setAttribute("data-index",o)}qr=document.getElementsByTagName("mp-common-subscribe")||[];for(let t=0;t<qr.length;t++){let e=qr[t],i=e.getAttribute("data-templateidlist")||[],n=e.getAttribute("data-index")||0,a=window.__is_support_wxOpen?1:0;e.setAttribute("data-scene",window.is_temp_url?3:2),e.setAttribute("data-username",window.user_name),e.setAttribute("data-supportwxopen",a),e.setAttribute("data-scale",zr),e.setAttribute("data-index",n),e.setAttribute("data-tagContent","订阅消息"),e.setAttribute("data-templateidlist",i),a||e.classList.add("js_subsc_btn")}ye(Wr),function(){let e=document.getElementsByClassName("js_subsc_btn")||[];for(let t=0;t<e.length;t++){let i=e[t];$e.on(i,"click",(()=>{window.uin&&window.key&&He.isWechat&&!He.isWindowsWechat&&!He.isMacWechat?document.getElementById("js_update_dialog").style.display="block":window.weui.alert("请在手机微信内操作")}))}$e.on(document.getElementById("js_update_cancel"),"click",(()=>{document.getElementById("js_update_dialog").style.display="none"})),$e.on(document.getElementById("js_update_confirm"),"click",(()=>{tt.jumpUrl(Mr,!0)}))}()}function Hr(){if(!networkType)return;let e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||void 0===e.getEntries)return;let t,i=document.getElementsByTagName("img"),n=i.length;function a(e){let t=[];for(let i in e)t.push(i+"="+encodeURIComponent(e[i]||""));return t.join("&")}let o,s=navigator.userAgent,r=!1;/micromessenger\/(\d+\.\d+)/i.test(s),o=RegExp.$1;for(let d=0,l=i.length;d<l;d++){if(t=parseInt(100*Math.random()),t>100)continue;let s=i[d].getAttribute("src");if(!s||s.indexOf("mp.weixin.qq.com")>=0)continue;let l,c=e.getEntries();for(let e=0;e<c.length;e++)if(l=c[e],l.name==s){let e=i[d].getAttribute("data-fail");Ne({type:"POST",url:"/mp/appmsgpicreport?__biz="+biz+"#wechat_redirect",data:a({rnd:Math.random(),uin:uin,version:version,client_version:o,device:navigator.userAgent,time_stamp:parseInt(+new Date/1e3),url:s,img_size:i[d].fileSize||0,user_agent:navigator.userAgent,net_type:networkType,appmsg_id:window.appmsgid||"",sample:n>100?100:n,delay_time:parseInt(l.duration),from:window.isSg?"sougou":"",fail:e})}),r=!0;break}if(r)break}}let Ur={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};let Fr=[],Vr=[];function Jr(e){try{return 1*window.atob(e)}catch(vd){}return 0}function Kr(e,t,i,n){Je.report(22316,{BizUin:Jr(window.biz),AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Itemshowtype:0,SessionId:window.sessionid+"",EnterId:window.parseInt(window.enterid,10)||0,Scene:1*window.source,Subscene:1*window.subscene,ActionType:e,toBizuin:Jr(t),isBizBan:1*i,isMassSend:1*window.appmsg_type,CardType:n})}function Xr(){if(Fr&&Fr.length&&Vr.length===Fr.length)$e.off(window,"scroll",Xr);else for(let e=0;e<Fr.length;e++){let t=Fr[e],i=t.querySelector(".js_wx_profile_card");if(i&&i.getBoundingClientRect().top>0&&i.getBoundingClientRect().top+i.getBoundingClientRect().height/2<=Be.getInnerHeight()){let e=i.getAttribute("data-id"),n=i.getAttribute("data-index");if(-1===Vr.indexOf(n)){Vr.push(n),Kr(0,e,i.getAttribute("data-isban"),1*t.getAttribute("data-from"))}}}}function Gr(e,t,i,n,a){e.addEventListener("click",(()=>{if(Kr(1,i,n,a),n){let e=document.getElementById("js_profile_ban");"none"===e.style.display&&(e.style.display="block",setTimeout((()=>{e.style.display="none"}),2e3))}else!He.isWechat||He.isWxWork?window.weui.alert("请在微信内打开"):tt.goProfile({biz:i,scene:124},{username:t,scene:"200"})}))}function Yr(e){return window.mp_profile.find((t=>t.fakeid===e))}function Qr(){!function(){if(!document.getElementById("js_content"))return;Fr=Array.from(document.getElementsByTagName("mpprofile"))||[];const e=Array.from(document.getElementsByTagName("mp-common-profile"))||[],t=Fr.concat(e);for(let n=0;n<t.length;n++){let e=t[n],i=e.getAttribute("data-id"),a=1*e.getAttribute("data-from"),o=Yr(i)||{};const{alias:s="",fakeid:r,is_biz_ban:d,nickname:l="",original_num:c,round_head_img:p,signature:_="",username:m}=o;let u=e.parentNode&&e.parentNode.querySelector(`[data-preloadingid="${i}"]`);if(u&&e.parentNode.removeChild(u),o){if("MPPROFILE"===e.tagName){const t=document.createElement("mp-common-profile");e.parentNode.appendChild(t),e.parentNode.removeChild(e),e=t}e.setAttribute("data-index",n),e.setAttribute("data-id",r),e.setAttribute("data-headimg",p),e.setAttribute("data-nickname",l.htmlDecode()),e.setAttribute("data-alias",s.htmlDecode()),e.setAttribute("data-signature",_.htmlDecode()),e.setAttribute("data-origin_num",1*c),e.setAttribute("data-is_biz_ban",1*d),e.setAttribute("data-isban",1*d),e.classList.add("js_wx_tap_highlight"),Gr(e,o.username,o.fakeid,o.is_biz_ban,a)}else e.innerHTML=""}Xr();let i=document.createElement("div");i.innerHTML=Ve.tmpl('<div id="js_profile_ban" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-warn weui-icon_toast"></i>\n    <p class="weui-toast__content">该账号因违规无法跳转</p>\n  </div>\n</div>',{}),document.body.appendChild(i)}(),$e.on(window,"scroll",Xr)}function Zr(){window.addEventListener&&window.addEventListener("load",(function(){window.__moonsafe_mutation_report_keys||(window.__moonsafe_mutation_report_keys={});let e=window.moon&&moon.moonsafe_id||29715,t=window.moon&&moon.moonsafe_key||0,i=[],n={},a=function(e,t,a){a=a||1,n[e]||(n[e]=0),n[e]+=a,t&&(!function(e){return"[object Array]"==Object.prototype.toString.call(e)}(t)?i.push(t):i=i.concat(t)),setTimeout((function(){o()}),1500)},o=function(){let a=[],s=i.length,r=["r="+Math.random()];for(let i in n)n.hasOwnProperty(i)&&a.push(e+"_"+(1*i+1*t)+"_"+n[i]);for(let e=0;e<s&&!(e>=10);++e)r.push("log"+e+"="+encodeURIComponent(i[e]));if(0==a.length&&r.length<=1)return;let d,l="idkey="+a.join(";")+"&lc="+(r.length-1)+"&"+r.join("&");if(window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(vd){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){d=!1}}else window.XMLHttpRequest&&(d=new XMLHttpRequest);d&&(d.open("POST",location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?",!0),d.setRequestHeader("cache-control","no-cache"),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.onreadystatechange=function(){4===d.readyState&&(i.length>10?(i=i.slice(10),o()):(i=[],n={}))},i=[],n={},d.send(l))};try{if(!window.__observer)return;let e=window.__observer_data;if(window.__observer.takeRecords){let t=window.__observer.takeRecords();if(t&&t.length){e.count++;let i=new Date;t.forEach((function(t){let i=t.addedNodes;for(let n=0;n<i.length;n++){let t=i[n];if("SCRIPT"===t.tagName){let i=t.src;!i||/qq\.com/.test(i)||/weishi\.com/.test(i)||e.list.push(i)}}})),e.exec_time+=new Date-i}}window.__observer.disconnect();let t=window.__moonsafe_mutation_report_keys.observer||2,i=window.__moonsafe_mutation_report_keys.script_src||8,n=window.__moonsafe_mutation_report_keys.setattribute||9,o=window.__moonsafe_mutation_report_keys.ajax||10,s=25;for(let d=0;d<e.list.length;d++){let i=e.list[d],n=["[moonsafe][observer][url]:"+location.href,"[moonsafe][observer][src]:"+i,"[moonsafe][observer][ua]:"+navigator.userAgent];e.list.length==d+1&&(n.push("[moonsafe][observer][count]:"+e.count),n.push("[moonsafe][observer][exec_time]:"+e.exec_time+"ms")),a(t,n),"inlinescript_without_nonce"==i&&a(s,n)}let r=window.__danger_src;if(r){let e=[{key:"xmlhttprequest",idkey:o},{key:"script_src",idkey:i},{key:"script_setAttribute",idkey:n}];for(let t=0;t<e.length;t++){let i=e[t].key,n=r[i];if(n&&n.length)for(let o=0;o<n.length;o++){let s=["[moonsafe]["+i+"][url]:"+location.href,"[moonsafe]["+i+"][src]:"+n[o],"[moonsafe]["+i+"][ua]:"+navigator.userAgent];a(e[t].idkey,s)}}}}catch(vd){a(3,["[moonsafe][observer][exception]:"+vd])}}),!1)}if(window.localStorage&&window.localStorage.getItem){const e=4500,t="loadSec-"+window.biz+"-"+window.mid+"-"+window.idx;let i=window.localStorage.getItem(t);i&&window.write_sceen_time-parseInt(i,10)>e&&(Je.report(20801,{Bizuin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,Url:window.msg_source_url||"",Title:window.msg_title||""}),window.localStorage.removeItem(t))}const ed=function(){let e=window.location.href.split("?")[1];if(e){let t=e.split("&");for(let e=0;e<t.length;e++){const[i,n]=t[e].split("=");if("imageIndex"===i)return parseInt(n,10)}return""}return""}();function td(e){return e&&e.getBoundingClientRect?e.getBoundingClientRect().top+function(){let e=0;return void 0!==window.pageXOffset?e=window.pageXOffset:void 0!==document.compatMode&&"BackCompat"!==document.compatMode?e=document.documentElement.scrollTop:void 0!==document.body&&(e=document.body.scrollTop),e}():0}function id(){if(""===ed)return;const e=function(){const e=[],t=document.getElementsByTagName("img");for(let i=0,n=t.length;i<n;i++){const n=t.item(i);n.getAttribute("data-src")&&e.push(n)}return e}();if(ed>e.length)return;const t=td(e[ed]);window.scroll(0,t)}""!==ed&&"scrollRestoration"in history&&(history.scrollRestoration="manual"),"loading"!==document.readyState?id():window.addEventListener("DOMContentLoaded",(function(){id()}));const nd=[2390745668,3099420829,3872121626,3203738065,3072206507,3566970574,3002803029,3099387730,3559965496,3525314097,2390323860,3084276724,3289028514,3003793452,3003972371,2398512110,3071748654,3233018348,3095049467,3076061592,3273032305,3264278949,3086344434,3014829842,3294546013,2058310401,2397841479,2397640820,3282179238,3072107639,3521076442,3554888231,2397274880,2394106525,3077726226,2103095721,3593723769,2395186785,2393698643,3944000110,2397445840,2394144447,3082139483,3070806332,3016714421,3006879186,3213574124,3221398587,3078448935,3591999034,3551390431],ad=b(window.user_uin),od=["testrd","otherrd"];let sd=0;try{sd=1*window.atob(window.biz)}catch(vd){}let rd={report_action:2,share_type:5};function dd(e,t,i){let n="",a="";try{""!=tid&&(a="tid="+tid+"&aid=54");let o=e.split("?")[1]||"";if(o=o.split("#")[0],""==o);else{let s=[o,"mpshare=1","scene="+t,"srcid="+srcid,"sharer_sharetime="+i,"sharer_shareid="+ad];if(""!=a&&s.push(a),o=s.join("&"),2===t&&nd&&nd.indexOf(sd)>-1){let t=Math.floor(Math.random()*od.length),i=od[t];n=e.split("?")[0]+"?"+o+`&testtype=${i}#`+(e.split("#")[1]||"")}else n=e.split("?")[0]+"?"+o+"#"+(e.split("#")[1]||"")}}catch(vd){n=""}return n||(n=location.href+"#wechat_redirect",Me.setLogs({id:28307,key:47,value:1,lc:1,log0:"[share_link]["+encodeURIComponent(location.href)+"]["+encodeURIComponent(e)+"]["+encodeURIComponent(msg_link)+"]"})),n}Ue.call("hideToolbar"),Ue.call("showOptionMenu");let ld=msg_title.htmlDecode(),cd=cdn_url_1_1||msg_cdn_url||ori_head_img_url||round_head_img,pd=cd,_d=msg_link.htmlDecode(),md=msg_desc.htmlDecode();function ud(e,t,i,n,a=0){at.shareReport({link:e,action_type:i,sharer_sharetime:n,sharer_shareid:ad,share_source:window.customShareSource||(0===a?1:2)})}function wd(e,t){return e.isCDN()&&(e=Pe.addParam(e,"wxfrom",t,!0)),e}md=md||" ",md=md.replace(/<br\/>/g,"\n"),idx>1&&document.getElementById("js_content")&&ct<1446652800&&(md=document.getElementById("js_content").innerHTML.replace(/<\/?[^>]*\/?>/g,"").htmlDecode().replace(/^(\s*)|(\s*)$/g,"").substr(0,54)),window.isPayTopic&&(md="收录于付费合集"+window.payTopicTitle||""),cd=cd.compressCDNImgSize(),pd=pd.compressCDNImgSize(),malicious_title_reason_id&&(ld=Y.maliciousTitleMap[malicious_content_type][malicious_title_reason_id]||ld,md=Y.maliciousDescMap[malicious_content_type][malicious_title_reason_id]||md,1!=malicious_content_type&&(cd="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png")),"1"==is_limit_user&&Ue.call("hideOptionMenu"),window.is_temp_url&&Ue.invoke("hideMenuItems",{menuList:["menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:qzone","menuitem:share:weibo","menuItem:share:WeiboApp","menuItem:share:QZone","menuitem:facebook","menuItem:copyUrl","menuItem:share:email","menuitem:copy_url","menuitem:share:haokan"]},(function(e){}));let hd="https://res.wx.qq.com/op_res/Fwh9olR917lxUMxpJVM5sCCyrQOJSm68IEt-HfL7vpc5-_etzmyuLg1kPdU6RNRX";function gd(){let e=!1,t=window.performance||window.msPerformance||window.webkitPerformance;if(!(t&&t.timing&&t.timing.navigationStart))return!1;e=t.timing.navigationStart,function(){let t=window.performance&&window.performance.timing,i=window.write_sceen_time-e,n=window.first_sceen__time-e,a=window.page_endtime-e,o=(window.onload_endtime||+new Date)-e;-1!=navigator.userAgent.indexOf("MicroMessenger")&&(i=real_show_page_time-e,n=real_show_page_time-e);let s=window.logs.jsapi_ready_time?window.logs.jsapi_ready_time-e:void 0,r=window.logs.a8key_ready_time?window.logs.a8key_ready_time-e:void 0,d=t&&t.connectEnd-t.connectStart,l=t&&t.secureConnectionStart&&t.connectEnd-t.secureConnectionStart,c=t&&t.domainLookupEnd&&t.domainLookupStart&&t.domainLookupEnd-t.domainLookupStart;if(window.logs.pagetime.wtime=i,window.logs.pagetime.ftime=n,window.logs.pagetime.ptime=a,window.logs.pagetime.onload_time=o,window.logs.pagetime.jsapi_ready_time=s,window.logs.pagetime.a8key_ready_time=r,need_report_cost?Ne({url:"/mp/report_cost",type:"post",data:{id_key_list:["1|1|"+a,"1|2|"+n,"1|3|"+o,"1|4|"+s,"1|5|"+r,"1|6|"+d,"1|7|"+l,"1|8|"+c].join(";")}}):Math.random()<.01&&Ne({url:"/mp/report_cost",type:"post",data:{id_key_list:["#1|1|"+a,"1|2|"+n,"1|3|"+o,"1|4|"+s,"1|5|"+r,"1|6|"+d,"1|7|"+l,"1|8|"+c].join(";")}}),need_report_cost&&n>3e3){let e=new Image,t=(new Date).getTime();e.onload=function(){let e=(new Date).getTime()-t,i=(new Date).getTime(),n=new Image;n.onload=function(){let t=(new Date).getTime()-i;Ne({url:"/mp/report_cost",type:"post",data:{id_key_list:["^2|1|"+e,"2|2|"+t].join(";")}})},n.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()},e.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()}function p(){if(-1==navigator.userAgent.indexOf("NetType/"))return!1;let e=["2G","cmwap","cmnet","uninet","uniwap","ctwap","ctnet"];for(let t=0,i=e.length;t<i;++t)if(-1!=navigator.userAgent.indexOf(e[t]))return!0;return!1}Math.random()>.2||o<0||i<0||n<0||a<0||(s&&Me.setAvg(27822,15,s),r&&Me.setAvg(27822,17,r),a>=15e3?Me.setAvg(27822,29,a):(Me.setAvg(27822,1,a).setAvg(27822,3,o).setAvg(27822,5,n),window.isWeixinCached&&Me.setAvg(27822,19,a),p()?(Me.setAvg(27822,9,a),window.isWeixinCached&&Me.setAvg(27822,23,a)):"wifi"==networkType?(Me.setAvg(27822,7,a),window.isWeixinCached&&Me.setAvg(27822,21,a)):"2g/3g"==networkType?(Me.setAvg(27822,11,a),window.isWeixinCached&&Me.setAvg(27822,25,a)):"4g"==networkType?(Me.setAvg(27822,14,a),window.isWeixinCached&&Me.setAvg(27822,26,a)):(Me.setAvg(27822,13,a),window.isWeixinCached&&Me.setAvg(27822,28,a)),window.moon&&moon.clearSample&&(Me.setAvg(27822,71,a),p()?Me.setAvg(27822,73,a):"wifi"==networkType?Me.setAvg(27822,75,a):"2g/3g"==networkType?Me.setAvg(27822,77,a):"4g"==networkType?Me.setAvg(27822,78,a):Me.setAvg(27822,79,a)),d&&Me.setAvg(27822,65,d),l&&Me.setAvg(27822,67,l),c&&Me.setAvg(27822,69,c)))}(),window.logs.jsapi_ready_fail&&Me.setSum(24729,55,window.logs.jsapi_ready_fail),function(){const e=document.getElementById("page-content");if(!e||Math.random()>.1)return;const i=function(){const n=document.getElementById("js_toobar3"),a=window.pageYOffset||document.documentElement.scrollTop,o=n.offsetTop;if(a+Be.getInnerHeight()>=o){let n,a,o=e.getElementsByTagName("img"),s={},r=[],d=0,l=0,c=0;for(let e=0,t=o.length;e<t;++e){let t=o[e];n=t.getAttribute("data-src")||t.getAttribute("src"),a=t.getAttribute("src"),n&&(n.isCDN()?l++:c++,d++,s[a]={})}if(r.push("1="+1e3*d),r.push("2="+1e3*l),r.push("3="+1e3*c),t.getEntries){let e=t.getEntries(),i=window.logs&&window.logs.img&&window.logs.img.download;if(!i)return;let n=[0,0,0],a=[0,0,0];d=l=0;for(let t=0,r=e.length;t<r;++t){let i=e[t],o=i.name;o&&"img"==i.initiatorType&&s[o]&&(o.isCDN()&&(a[0]+=i.duration,l++),n[0]+=i.duration,d++,s[o]={startTime:i.startTime,responseEnd:i.responseEnd})}n[0]>0&&d>0&&(n[2]=n[0]/d),a[0]>0&&l>0&&(a[2]=a[0]/l);for(let t in i)if(i.hasOwnProperty(t)){let e=i[t],o=0,r=0,d=0,l=0;for(let t=0,i=e.length;t<i;++t){let i=e[t];if(s[i]&&s[i].startTime&&s[i].responseEnd){let e=s[i].startTime,t=s[i].responseEnd;o=Math.max(o,t),r=r?Math.min(r,e):e,i.isCDN()&&(d=Math.max(o,t),l=r?Math.min(r,e):e)}}n[1]+=Math.round(o-r),a[1]+=Math.round(d-l)}let o=4,c=7;for(let t=0;t<3;t++)n[t]=Math.round(n[t]),a[t]=Math.round(a[t]),n[t]>0&&(r.push(o+t+"="+n[t]),"wifi"==networkType?r.push(o+t+6+"="+n[t]):"2g/3g"!=networkType&&"4g"!=networkType||r.push(o+t+12+"="+n[t])),a[t]>0&&(r.push(c+t+"="+a[t]),"wifi"==networkType?r.push(c+t+6+"="+a[t]):"2g/3g"!=networkType&&"4g"!=networkType||r.push(c+t+12+"="+a[t]))}$e.off(window,"scroll",i,!1)}};$e.on(window,"scroll",i,!1)}(),function(){if(Math.random()>.001)return;const e=document.createElement("iframe"),t=Math.ceil(10*Math.random())-1,i=uin+mid+idx+Math.ceil(1e3*Math.random())+(new Date).getTime();e.style.display="none",e.id="js_ajax",e.setAttribute("data-time",t),e.src="/mp/iframetest?action=page&traceid="+i+"&devicetype="+devicetype+"&timeout="+[600,800,1e3,1200,1500,2e3,3e3,5e3,1e4,18e3][t];document.getElementById("js_article").appendChild(e)}()}Ue.on("menu:share:appmessage",(function(e){if(window.is_wash){let t=Date.now();Ue.invoke("sendAppMessage",{img_url:hd,img_width:"640",img_height:"640",link:dd(_d,type,t),desc:"你可以阅读以下原创作者的内容",title:"原文存在洗稿行为"},(function(i){ud(_d,fakeid,type,t,e.shareScene)}))}else{let t=1,i=wd(cd,"1");e&&"favorite"==e.scene&&(t=24,i=wd(cd,"4"),E.commit("mp-related-article/setSources",["favorite"])),1==malicious_content_type&&(i="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png");let n=Date.now(),a={appid:"",img_url:i,img_width:"640",img_height:"640",link:_d,desc:md,title:ld};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(a,window.customShareInfo),"string"==typeof a.forbid_msg){let t=a.forbid_msg.replace("#op#","favorite"===e.scene?"收藏":"分享");return void(window.weui||window).alert(t)}a.link=dd(a.link,t,n),Ue.invoke("sendAppMessage",a,(function(i){ud(_d,fakeid,t,n,e.shareScene),E.commit("mp-related-article/setSources",[24===t?"favorite":"share"]),a.vid&&(rd=Object.assign(rd,{vid:a.vid,share_type:2}),Ae.reportKanData(rd))}))}})),Ue.on("menu:share:timeline",(function(e){if(window.is_wash){let t=Date.now();Ue.invoke("shareTimeline",{img_url:hd,img_width:"640",img_height:"640",link:dd(_d,2,t),desc:"",title:"原文存在洗稿行为，你可以阅读以下原创作者的内容"},(function(i){ud(_d,fakeid,2,t,e.shareScene)}))}else{let t=cd;He.isIOS||(t=wd(cd,"2"));let i=Date.now(),n={img_url:t,img_width:"640",img_height:"640",link:_d,desc:md,title:ld};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(n,window.customShareInfo),"string"==typeof n.forbid_msg){let e=n.forbid_msg.replace("#op#","分享");return void(window.weui||window).alert(e)}n.link=dd(n.link,2,i),Ue.invoke("shareTimeline",n,(function(t){ud(_d,fakeid,2,i,e.shareScene),E.commit("mp-related-article/setSources",["share"]),n.vid&&(rd=Object.assign(rd,{vid:n.vid,share_type:1}),Ae.reportKanData(rd))}))}})),Ue.on("menu:share:weiboApp",(function(e){let t=Date.now();Ue.invoke("shareWeiboApp",{img_url:cd,link:dd(_d,3,t),title:ld},(function(e){ud(_d,fakeid,3,t)}))})),Ue.on("menu:share:facebook",(function(e){let t=Date.now();ud(_d,fakeid,7,t),Ue.invoke("shareFB",{img_url:pd,img_width:"640",img_height:"640",link:dd(_d,43,t),desc:md,title:ld},(function(e){}))})),Ue.on("menu:share:QZone",(function(e){let t=wd(cd,"6"),i=Date.now();ud(_d,fakeid,5,i),Ue.invoke("shareQZone",{img_url:t,img_width:"640",img_height:"640",link:dd(_d,22,i),desc:md,title:ld},(function(e){}))})),Ue.on("menu:share:qq",(function(e){let t=wd(cd,"7"),i=Date.now();ud(_d,fakeid,5,i),Ue.invoke("shareQQ",{img_url:t,img_width:"640",img_height:"640",link:dd(_d,23,i),desc:md,title:ld},(function(e){}))})),Ue.on("menu:share:email",(function(e){let t=Date.now();ud(_d,fakeid,5,t),Ue.invoke("sendEmail",{content:dd(_d,5,t),title:ld},(function(e){}))})),Ue.on("sys:record",(function(e){Ue.invoke("recordHistory",{link:_d,title:ld,source:nickname,img_url:cd},(function(e){}))})),$e.on(window,"load",(function(){if(""==networkType&&window.isInWeixinApp()){let e={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};JSAPI.invoke("getNetworkType",{},(function(t){networkType=e[t.err_msg],"network_type:edge"!=t.err_msg&&"network_type:wwan"!=t.err_msg||(t.detailtype&&"4g"==t.detailtype||t.subtype&&"4g"==t.subtype)&&(networkType="4g"),gd()}))}else gd()}),!1),window.page_endtime=+new Date,window.Vue=u;try{De.os.ios&&De.os.getNumVersion()>=16&&(Me.setSum(110809,78,1),De.isLockdownMode()&&Me.setSum(110809,79,1)),window.customElements?Me.setSum(110809,70,1):Me.setSum(110809,71,1),document.head.createShadowRoot||document.head.attachShadow?Me.setSum(110809,72,1):Me.setSum(110809,73,1)}catch(xd){console.log(xd)}v({platform:"wechat"}),x({platform:"wechat"}),k({platform:"wechat"}),S.setGvar({payType:0,pageType:0,albumId:window.appmsg_album_info.id||""}),u.config.errorHandler=function(e,t,i){e._info=i,window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.onError(e),console.error("Vue errorHandler",i,e.stack)},console.info("[图文信息] 三元组:",window.biz,window.mid,window.idx),console.info("[用户信息] 设备信息: 是否安卓",De.os.android,"是否IOS",De.os.ios,"是否秒开场景",window.__second_open__,"系统版本",De.os.version,"用户uin",window.user_uin,"是否小程序内打开",He.isInMiniProgram),mt.set({bottom:[ut["BG-0"],wt["BG-0"]]}),Q.initHtmlMinHeight();let fd=-1,yd=!1;if(window.logs.pagetime.jsapi_ready_time=+new Date,window.logs.idkeys={},Le.log("[Appmsg] start run index.js init"),function(){let e=(new Date).getHours(),t=function(e,t){t=t||"",window.isSg?(t=["uin:sougou","resp:"+t].join("|"),(new Image).src="/mp/jsreport?key="+e+"&content="+t+"&r="+Math.random()+"&from=sougou"):(t=["uin:"+window.user_uin,"resp:"+t].join("|"),(new Image).src="/mp/jsreport?key="+e+"&content="+t+"&r="+Math.random())},i=e>=11&&e<=17&&Math.random()<1;window.__report=t,window.__commonVideoReport=function(e,n){i&&t(e,n)},window.__addIdKeyReport=function(e,t,i){let n=e+"_"+t;i=i||1,window.logs.idkeys[n]||(window.logs.idkeys[n]={val:0}),window.logs.idkeys[n].val+=i}}(),Be.initWebCompt(["wxOpen"],(e=>{window.__is_support_wxOpen=e.err_msg.indexOf(":ok")>-1,(document.getElementsByTagName("mpsubscribe")&&document.getElementsByTagName("mpsubscribe").length||document.getElementsByTagName("mp-common-subscribe")&&document.getElementsByTagName("mp-common-subscribe").length)&&$r()})),function(){setTimeout((()=>{let e=document.getElementsByClassName("wx-edui-video_source_link");e=Array.prototype.slice.call(e),e.forEach((e=>{e&&e.addEventListener("click",(()=>{const t=e.dataset.hitUsername,i=e.dataset.hitBiz;tt.goProfile({biz:i},{username:t})}))}))}),500);try{Dt.init(document.getElementById("js_tags"))}catch(vd){console.log(vd)}let e=!1;if((()=>{try{const t=Be.getParam("anchor_list");let i=!1;if(t&&2!==window.copyright_stat){e=!0;const n=document.getElementById("js_content"),a=Z(n,{ignoreNotWriteableChildren:!0});let o=decodeURIComponent(t).split("#");for(let e=0;e<o.length;e++){let t=o[e].split(",");if(t&&3===t.length){let e=a[t[0]],n=1*t[1],o=1*t[2];window.__addIdKeyReport("306353","3");const s=fn(e,n,o);i||(window.__addIdKeyReport("306353","1"),window.scrollTo(0,s.getBoundingClientRect().top+Be.getScrollTop()-68),i=!0)}}}}catch(t){window.__addIdKeyReport("306353","2"),console.error(t)}})(),function(){if(window.is_teenager)return void Me.setSum(286024,0,1);const e=document.getElementsByTagName("mpcps");e.length>0&&ee.getCpsData(e)}(),window.is_new_msg&&-1!=navigator.userAgent.indexOf("MicroMessenger")){if(window.title&&(window.title=window.title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),window.msg_title&&(window.msg_title=window.msg_title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),hd_head_img||re.jsmonitor({id:115849,key:26,value:1}),He.isAndroid){let e={userName:window.user_name,bizNickName:window.nickname,bizNickNameBackup:window.title,cover:"",title:window.msg_title,headImg:window.hd_head_img,digest:window.msg_desc,reportData:{BizUin:window.biz,AppMsgID:1*window.mid,ItemIndex:1*window.idx,Scene:1*window.source,SubScene:1*window.subscene,EnterId:1*window.enterid,SessionId:window.sessionid,ItemShowType:1*window.item_show_type}};Re.init(e);let t=window.cdn_url_1_1||window.cdn_url_235_1||"",i=new Image;t&&(i.src=t,i.onload=()=>{i.width<2048&&i.height<2048&&(e.cover=t,Re.init(e)),window.topbarInited=!0},i.onerror=()=>{window.topbarInited=!0})}else Re.init({userName:window.user_name,bizNickName:window.nickname,bizNickNameBackup:window.title,title:window.msg_title,headImg:window.hd_head_img,cover:window.cdn_url_1_1||window.cdn_url_235_1||window.msg_cdn_url,digest:window.msg_desc,reportData:{BizUin:window.biz,AppMsgID:1*window.mid,ItemIndex:1*window.idx,Scene:1*window.source,SubScene:1*window.subscene,EnterId:1*window.enterid,SessionId:window.sessionid,ItemShowType:1*window.item_show_type}});$e.on(window,"scroll",(()=>{yd||He.isAndroid&&!window.topbarInited||(_t(0),yd=!0)})),Ue.invoke("createWebViewForFastLoad",{scene:1},(function(e){console.log(e)}))}let t=document.getElementsByTagName("body");if(!t||!t[0])return!1;t=t[0];(function(){let e=[],t=document.getElementById("js_content").getElementsByTagName("a");for(let s=0;s<t.length;s++)null!==t[s].getAttribute("data-itemshowtype")&&e.push(t[s]);let i=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("h5_image_link"),(function(e){e.parentNode.getAttribute("href")&&e.parentNode.getAttribute("href").length>0&&i.push(e)}));let n=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("weapp_image_link"),(function(e){n.push(e)}));let a=window.innerHeight||document.documentElement.clientHeight;function o(){!function(){if(e.length){let t=document.documentElement.scrollTop||document.body.scrollTop;for(let i=0;i<e.length;i++)if(1!=e[i].getAttribute("hasload")){let n=e[i].getBoundingClientRect();(n.top<a+t&&n.top>t||n.top+n.height>t&&n.top+n.height<a+t)&&e[i].getAttribute("href").length>0&&(e[i].setAttribute("hasload",1),Ue.invoke("downloadPageDataForFastLoad",{itemList:[{item_show_type:e[i].getAttribute("data-itemshowtype"),url:e[i].getAttribute("href")}]},(function(e){console.log(e)})),e.splice(i,1),i--)}}}(),function(){for(let e=0;e<i.length;e++){let t=i[e],n=t.getBoundingClientRect();(n.top<=0&&n.top+n.height>=0||n.top>0&&n.top<a)&&(i.splice(e,1),e--,ne.report([1,ne.getRedirectType(t.parentNode.getAttribute("href")),"",window.img_popup?1:0,window.source,ne.getUrlData(t.parentNode.getAttribute("href"))]))}for(let e=0;e<n.length;e++){let t=n[e],i=t.getBoundingClientRect();(i.top<=0&&i.top+i.height>=0||i.top>0&&i.top<a)&&(n.splice(e,1),e--,ne.report([1,1,"",window.img_popup?1:0,window.source,t.getAttribute("data-miniprogram-appid")]))}}()}$e.on(window,"scroll",o),o()})(),(()=>{try{if(anchor_tree_msg){const e=Date.now(),t=document.getElementById("js_content"),i=anchor_tree_msg?JSON.parse(anchor_tree_msg).anchor_tree:[],n=window.location.protocol;Gi.init(t,i),re.saveSpeeds({sample:1,uin:uin,pid:"https:"==n?462:417,speeds:{sid:38,time:Date.now()-e}}),re.send()}}catch(e){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.onError(e,{anchor_tree_msg:anchor_tree_msg})}})();let i=/^http(s)?:\/\/mp\.weixin\.qq\.com\//g;try{if(top!=window&&(!top||top&&location.href&&i.test(location.href))&&!window.isSg)throw new Error("in iframe")}catch(vd){let t="";(new Image).src=("http://mp.weixin.qq.com/mp/jsreport?key=4&content=biz:"+biz+",mid:"+mid+",uin:"+uin+"[key4]"+t+"&r="+Math.random()).substr(0,1024)}if(window.isInWeixinApp()&&/#rd$/.test(location.href)&&!window.isWeixinCached&&!window.__second_open__&&!He.isWxWork){let e=-1!=location.href.indexOf("?")?"&":"?";location.replace(location.href.replace(/#rd$/,e+"rd2werd=1#wechat_redirect"))}const n=!He.isWp&&-1==navigator.userAgent.indexOf("MicroMessenger"),a=n?null:new lt({is_https_res:is_https_res});if(function(e){const t=document.getElementById("js_content").getElementsByTagName("img");let i=!1;for(let n=0,a=t.length;n<a;n++){const e=t[n].getAttribute("data-src");if(e&&e.canHevc()){i=!0;break}}i?$((t=>{Bs(e,t,!1)})):Bs(e,!1,!1),H()}(a),a){const e=document.getElementById("js_cover");a.add({container:document.getElementById("js_content"),imgs:e?[e]:[]})}Es(),new u({store:E,render:e=>e(mo)}).$mount("#content_bottom_area"),new u({store:E,render:e=>e(Po)}).$mount("#page_bottom_area"),function(){const e=document.createElement("div");e.id="underline-app",document.body.appendChild(e),new xs({el:e,store:E})}(),function(){let e=document.getElementById("profileBt"),t=document.getElementById("copyright_info"),i=[];if(e){let t="57";"28"==window.source&&(t="96"),"31"===window.source&&(t="103"),"30"===window.source&&(t="102"),"29"==window.source&&(t="39"),"15"==window.source&&(t="121"),i.push({dom:e,username:user_name,profileReportInfo:window.profileReportInfo||"",scene:t})}t&&source_encode_biz&&i.push({dom:t,source_encode_biz:source_encode_biz,scene:"161"});for(let n=0,a=i.length;n<a;n++)!function(e){$e.on(e.dom,"click",(function(t){if("copyright_info"==e.dom.id&&source_encode_biz)rn.card_click_report({scene:"0"}),tt.goProfile({biz:e.source_encode_biz,scene:e.scene},{username:source_username,scene:e.scene+""});else{if(Le.log("[Appmsg] profile_click_before_loadprofile: username:"+e.username+", scene:"+e.scene),at.profileReport({hotspotjson:JSON.stringify({hotspotinfolist:window.hotspotInfoList})}),profileReportInfo){let e=String(profileReportInfo).split("_");3==e.length&&Ne({url:"/mp/ad_biz_info?action=report&__biz="+window.biz+"&report_type=2&aid="+e[1]+"&tid="+e[2],type:"GET",dataType:"json",async:!0,success:function(e){}})}1==isprofileblock?Ue.invoke("openUrlWithExtraWebview",{url:"https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect",openType:1},(function(e){-1==e.err_msg.indexOf("ok")&&(location.href="https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect")})):Ue.invoke("profile",{username:e.username,profileReportInfo:e.profileReportInfo||"",scene:e.scene+"",bizuin:1*window.atob(window.biz)||0},(function(t){window.__addIdKeyReport("28307","1"),Le.log("[Appmsg] profile_click_after_loadprofile: username:"+e.username+", scene:"+e.scene+", profileReportInfo:"+e.profileReportInfo+", res.err_msg:"+t.err_msg)}))}t.preventDefault()})),He.isWp&&e.dom.setAttribute("href","weixin://profile/"+e.username)}(i[n])}(),function(){function e(){let e=function(){if("hidden"in document)return"hidden";let e=["webkit","moz","ms","o"];for(let t=0;t<e.length;t++)return e[t]+"Hidden";return null}();return!!e&&document[e]}function t(t){if(e())for(let e=0;e<window.originalVideoAdFrames.length;e++)window.originalVideoAdFrames[e].contentWindow.postMessage({action:"pauseAd",value:""},"*");else window.originalVideoAdCurrentFrame&&window.originalVideoAdCurrentFrame.contentWindow.postMessage({action:"playAd"},"*")}document.webkitVisibilityState?document.addEventListener("webkitvisibilitychange",t,!1):document.msVisibilityState?document.addEventListener("msvisibilitychange",t,!1):document.visibilityState&&document.addEventListener("visibilitychange",t,!1)}();try{let e=document.getElementById("js_author_name");if(e){let t="";$e.on(e,"click",(function(i){return!!Fe.hasClass(e,"rich_media_meta_link")&&(window.is_temp_url?(window.weui.alert("预览状态下不能操作"),!1):!!e.getAttribute("data-rewardsn")&&(1==e.getAttribute("data-canreward")&&(t="https://mp.weixin.qq.com/mp/author?action=show&author_id="+author_id+"&rewardsn="+e.getAttribute("data-rewardsn")+"&timestamp="+e.getAttribute("data-timestamp")+"&__biz="+window.biz+"&appmsgid="+window.appmsgid+"&idx="+window.idx+"&scene=142&rscene=129&from_scene="+window.source+"&from_subscene="+window.subscene+"&from_enterid="+window.enterid+"&from_sessionid="+window.sessionid+"&is_fans="+window.isFans+"#wechat_redirect",!He.isInMiniProgram&&void(-1!=navigator.userAgent.indexOf("MicroMessenger")&&(He.isIOS||He.isAndroid||He.isWp)?(window.__addIdKeyReport("110809","1"),Ue.invoke("openUrlWithExtraWebview",{url:t,openType:1},(function(e){-1==e.err_msg.indexOf("ok")&&(location.href=t)}))):location.href=t))))}))}}catch(vd){}new ot({container:document.getElementById("js_content"),changeHref:function(e,t){if(!e||0!=e.indexOf("http://mp.weixin.qq.com/")&&0!=e.indexOf("https://mp.weixin.qq.com/")){if(18==ban_scene)return"/mp/ban?action=check&__biz="+biz+"&mid="+mid+"&idx="+idx+"&scene="+ban_scene+"#wechat_redirect";if(0!=e.indexOf("http://mp.weixinbridge.com/mp/wapredirect")&&0!=e.indexOf("https://support.weixin.qq.com/cgi-bin/mmsupport-bin/showredpacket"))return"http://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(e)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&type="+t+"&scene=0"}else{let t="&";-1==(e=(e=(e=e.replace(/#rd\s*$/,"")).replace(/#wechat_redirect\s*$/,"")).replace(/[\?&]scene=21/,"")).indexOf("?")&&(t="?"),e+=t+"scene=21#wechat_redirect"}return e}}),function(){if(!document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_section"),t=document.getElementsByClassName("js_product_a"),i=[];function n(e){let t=window.pageYOffset||document.documentElement.scrollTop;for(let n=0;n<i.length;++n){let e=i[n];if(!e.isReport){let i=e.offsetTop;t<=i&&t+Be.getInnerHeight()>=i&&(e.isReport=!0,(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=1&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+e.product_id+"&order="+e.order+"&r="+Math.random())}}}for(let a=0;a<e.length;++a){let t=e[a];t.dataset&&t.dataset.product_id&&t.dataset.order&&i.push({dom:t,offsetTop:t.offsetTop,product_id:t.dataset.product_id||"",order:t.dataset.order||"",isReport:!1})}i.length>0&&($e.on(window,"scroll",n),n());for(let a=0;a<t.length;++a)!function(e){$e.on(e,"click",(function(t){let i=e.dataset||{};return(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=2&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+(i.product_id||"")+"&order="+(i.order||"")+"&r="+Math.random(),!!i.href&&(setTimeout((function(){location.href="http://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(i.href)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&scene=0"}),300),!1)}),!0)}(t[a])}();const o=!isNaN(parseInt(qe("start")))&&!isNaN(parseInt(qe("end")));Q.init({hasSpAd:!0,disableScroll:window.isPaySubscribe&&!window.isPaid&&window.jump2pay||e||o}),window.originalVideoAdFrames=[],window.originalVideoAdCurrentFrame=null,window.originalVideoAdFramesUnsetList=[],window.addEventListener("message",(function(e){let t="",i=document.getElementsByTagName("iframe");if(e.data&&"originalVideoAdNeedData"==e.data.action&&e.data.vid)if(window.originalVideoAdFramesAdData){window.originalVideoAdFramesAdData&&window.originalVideoAdFramesAdData[e.data.vid]&&(t=window.originalVideoAdFramesAdData[e.data.vid]);for(let n=0;n<i.length;n++)i[n].dataset&&i[n].dataset.mpvid==e.data.vid&&i[n].contentWindow.postMessage({action:"receiveOriginalVideoData",vid:e.data.vid,adData:t},"*")}else console.log(e.data.vid," has no ad data yet"),window.originalVideoAdFramesUnsetList.push(e.data.vid)})),window.fromWeixinCached||Cs();ee.getAdData(window.reportVid);let s=[];voiceList&&voiceList.voice_in_appmsg&&voiceList.voice_in_appmsg.length>0&&(s=voiceList.voice_in_appmsg);Ws(s),Ms(),(()=>{const e=document.querySelectorAll(Vs.oldTagName);for(let i=0;i<e.length;i++){let t=e[i];const n=document.createElement("mp-common-search"),a=t.getAttribute("data-keywords");t.parentNode.appendChild(n),t.parentNode.removeChild(t),n.setAttribute("data-nickname",window.nickname),n.setAttribute("data-headImg",window.round_head_img),n.setAttribute("data-keywords",a)}const t=document.querySelectorAll(Vs.tagName);if(!(t.length<=0))for(let i=0,n=t.length;i<n;i++){let e=t[i];e.classList.add("js_wx_tap_highlight");let n=[];try{n=JSON.parse(window.decodeURIComponent(e.getAttribute("data-keywords")))}catch(vd){Me.setSum(110809,50,1)}if(n.length){let t={nickname:window.nickname,avatar:window.round_head_img,keywords:n};Vs.keywords=n;let i=e.parentNode.querySelector('[data-preloadingid="mp-common-search"]');i&&i.parentNode.removeChild(i),Js({dom:e,keywords:t.keywords})}}})(),(()=>{const e=document.querySelectorAll($s.tagName);for(let i=0,n=e.length;i<n;i++){let t=e[i];const n={id:decodeURIComponent(t.getAttribute("data-id")||""),name:decodeURIComponent(t.getAttribute("data-name")||""),address:decodeURIComponent(t.getAttribute("data-address")||""),img:decodeURIComponent(t.getAttribute("data-img")||""),longitude:decodeURIComponent(t.getAttribute("data-longitude")||""),latitude:decodeURIComponent(t.getAttribute("data-latitude")||""),type:decodeURIComponent(t.getAttribute("data-type")||"")};Fs({data:n,node:t})}const t=document.getElementsByClassName("js_poi_entry");for(let i=0;i<t.length;i++)(e=>{const i=t[e];$s.poiDom.push(i),$e.on(i,"tap",(e=>{e.stopPropagation(),e.preventDefault(),Fe.addClass(i,"wx_tap_link"),G.highlightEle(i);const t={id:decodeURIComponent(i.getAttribute("data-id")||""),name:decodeURIComponent(i.getAttribute("data-name")||""),address:decodeURIComponent(i.getAttribute("data-address")||""),img:decodeURIComponent(i.getAttribute("data-img")||""),longitude:decodeURIComponent(i.getAttribute("data-longitude")||""),latitude:decodeURIComponent(i.getAttribute("data-latitude")||""),type:decodeURIComponent(i.getAttribute("data-type")||"")};return t.longitude&&t.latitude&&t.name&&t.address&&(Je.report(19937,Object.assign({},$s.commonReportData,{type:1,actiontype:2})),Me.setSum(110809,57,1),Hs(t)),!1}),!0),$e.on(i,"click",(e=>{e.preventDefault(),e.stopPropagation()}),!0)})(i);Us(),$e.on(window,"scroll",Us)})(),un(),1===window.show_msg_voice&&(Ns(),console.log("load voicemsg"));!window.__appmsgCgiData||1!=window.__appmsgCgiData.wxa_product&&1!=window.__appmsgCgiData.wxa_cps||Nr();te.init(),document.getElementsByTagName("mp-qa").length&&Pi.renderQaCard({mid:window.mid,idx:window.idx,isLogin:!!window.is_login,userUin:window.user_uin,biz:window.biz,itemShowType:window.item_show_type,sessionId:window.sessionid,enterId:window.enterid,scene:window.source,subScene:window.subscene});document.getElementsByTagName("mpvideosnap")&&document.getElementsByTagName("mpvideosnap").length&&jr();const r=document.getElementsByTagName("mp-common-profile");(document.getElementsByTagName("mpprofile")&&document.getElementsByTagName("mpprofile").length||r&&r.length)&&Qr();if(document.getElementsByTagName("mp-wxaproduct").length){const e=window.__appmsgCgiData.minishopCardData?JSON.parse(decodeURIComponent(window.__appmsgCgiData.minishopCardData)):"";Ut({biz:window.biz,mid:window.mid,idx:window.idx,source:1*window.source,subscene:1*window.subscene,enterid:1*window.enterid,minishopCards:e})}function d(){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e.timing){let t=e.timing;Le.log("[Appmsg] dns:"+(t.domainLookupEnd-t.domainLookupStart)+"^^^ ssl:"+(0==t.secureConnectionStart?0:t.connectEnd-t.secureConnectionStart)+"^^^ tcp:"+(t.connectEnd-t.connectStart)+"^^^ request:"+(t.responseStart-t.requestStart)+"^^^ getPackageTime:"+(t.responseEnd-t.responseStart)+"^^^ domCententLoaded:"+(t.domContentLoadedEventStart-t.domLoading)+"^^^ domComplete:"+(t.domComplete-t.domLoading)+"^^^ firstViewTime:"+(real_show_page_time-t.navigationStart)+"^^^ interactiveTime:"+(window.page_endtime-t.navigationStart)),window.navigator.userAgent,setTimeout((function(){t.loadEventEnd&&Le.log("[Appmsg] onload:"+(t.loadEventEnd-t.loadEventStart))}),100)}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),""==document.getElementById("js_content").innerHTML.trim()&&Me.setSum(24729,94,1);Math.random()<.001&&document.getElementById("js_read_area3")&&document.getElementById("js_read_area3").innerText&&document.getElementById("js_read_area3").innerText.indexOf("Pageview")>-1&&Me.setSum(24729,95,1),window.__wxjs_is_wkwebview&&Me.setSum(28307,67,1)}Ue.invoke("getNetworkType",{},(function(e){networkType=Ur[e.err_msg],"network_type:edge"!=e.err_msg&&"network_type:wwan"!=e.err_msg||(e.detailtype&&"4g"==e.detailtype||e.subtype&&"4g"==e.subtype)&&(networkType="4g"),Hr()})),void $e.on(window,"load",Hr,!1),new Qi({biz:window.biz,isPaySubscribe:window.isPaySubscribe,container:document.getElementById("js_content"),logid:18504,baseData:["",window.biz,window.mid,window.idx,window.location.href,window.msg_title]}),setTimeout((function(){$e.tap(document.getElementById("copyright_logo"),(function(){const e="http://kf.qq.com/touch/sappfaq/150211YfyMVj150326iquI3e.html";window.__second_open__?Ue.invoke("openUrlWithExtraWebview",{url:e,openType:1},(function(t){-1==t.err_msg.indexOf("ok")&&(location.href=e)})):location.href=e})),Lt(),ie.init({dom:document.getElementById("js_report_article3"),title:window.msg_title.htmlDecode(),link:window.msg_link}),function(){if(n){document.title=window.msg_title.htmlDecode(),Fe.addClass(t,"not_in_mm");let e=document.getElementById("js_pc_qr_code_img");if(e){let t=10000004,i=document.referrer;if(0==i.indexOf("http://weixin.sogou.com")?t=10000001:0==i.indexOf("https://wx.qq.com")&&(t=10000003),window.isSg)e.setAttribute("src",sg_qr_code.htmlDecode());else{e.setAttribute("src","/mp/qrcode?scene="+t+"&size=102&__biz="+biz+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&send_time="+send_time),(new Image).src="/mp/report?action=pcclick&__biz="+biz+"&uin="+uin+"&scene="+t+"&r="+Math.random()}document.getElementById("js_pc_qr_code").style.display="block"}let i=document.getElementById("js_profile_qrcode"),n=document.getElementById("js_profile_arrow_wrp"),a=document.getElementById("profileBt");if(i&&a&&n){let e=function(){let e=10000005,t=document.referrer;0==t.indexOf("http://weixin.sogou.com")?e=10000006:0==t.indexOf("https://wx.qq.com")&&(e=10000007);let o=document.getElementById("js_profile_qrcode_img");if(o)if(window.isSg)o.setAttribute("src",sg_qr_code.htmlDecode());else{o.setAttribute("src","/mp/qrcode?scene="+e+"&size=102&__biz="+biz+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&send_time="+send_time),(new Image).src="/mp/report?action=pcclick&__biz="+biz+"&uin="+uin+"&scene="+e+"&r="+Math.random()}return i.style.display="block",n.style.left=a.offsetWidth/2-8+"px",!1};$e.on(a,"click",e),$e.on(i,"click",e),$e.on(document,"click",(function(e){let t=e.target||e.srcElement;t!=a&&t!=i&&(i.style.display="none")}))}}else{const e=document.getElementById("js_report_article3");e&&(e.style.display="")}}();const e=document.getElementsByTagName("map");for(let t=0,n=e.length;t<n;++t)e[t].parentNode.removeChild(e[t]);if(rn.card_pv_report(),Math.random()<.01)try{let e="https://js.aq.qq.com/js/aq_common.js",t=document.createElement("script");t.src=e,document.getElementsByTagName("head")[0].appendChild(t)}catch(vd){}const i=document.getElementById("js_close_temp");$e.on(i,"click",(function(){i.parentNode.parentNode.removeChild(i.parentNode),Fe.removeClass(document.getElementById("js_article"),"preview_appmsg")}))}),1e3),function(){if(!De.os.ios||!("onorientationchange"in window))return;const e=[],t="onorientationchange"in window?"orientationchange":"resize";let i=!1,n=function(){return 90===Math.abs(window.orientation)?1:2};1!==n()||i||(S.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report",`biz: ${"function"==typeof window.atob?window.atob(window.biz):window.biz} | mid: ${window.mid} | idx: ${window.idx} | url: ${location.href}`,{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),i=!0),e.push({ori:n(),scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1});const a=(new Date).getHours();$e.on(window,t,(function(){const t=e.length-2,o=n();if(fd=+new Date,t>=0){const i=e[t];e[e.length-1].istouchmove||(a>=11&&a<=17&&window.__report(63),setTimeout((function(){window.scrollTo(0,i.scroll)}),100))}e.push({ori:o,scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1}),1!==o||i||(S.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report",`biz: ${"function"==typeof window.atob?window.atob(window.biz):window.biz} | mid: ${window.mid} | idx: ${window.idx} | url: ${location.href}`,{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),i=!0)})),$e.on(window,"scroll",(function(){const t=e.length-1,i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,a=Date.now();if(-1!=fd){if(console.log("[横屏滚动检测]",a-fd),a-fd<500)return void(fd=-1)}else fd=-1;e[t].ori==n()&&(e[t].scroll=i,e[t].istouchmove=!0)}))}(),Le.log("[Appmsg] href:"+location.href+"^^^ ua:"+window.navigator.userAgent),window.addEventListener?window.addEventListener("load",d,!1):window.attachEvent&&window.attachEvent("onload",d);void(window.addEventListener&&document.getElementsByTagName("body")[0].addEventListener("copy",(function(){Me.setSum(28307,18,1),He.isIOS&&Me.setSum(28307,19,1),He.isAndroid&&Me.setSum(28307,20,1)}),!1)),window.__observer&&window.__observer_data&&Zr();"undefined"!=typeof isSg&&function(){if(document.getElementById("js_report_article3")&&(document.getElementById("js_report_article3").style.display="none"),document.getElementById("js_toobar3")&&(document.getElementById("js_toobar3").style.display="none"),function(){let e=document.createElement("div");e&&(e.innerHTML=Ve.tmpl('\x3c!-- 发表留言 --\x3e\n<#if(window.new_appmsg){#>\n  <div id="js_cmt_mine" class="discuss_container_wrp" style="display:none;">\n    <div class="discuss_container editing access">\n        <div class="discuss_container_inner">\n          <div class="discuss_container_hd">\n            <h2 class="rich_media_title">\n                <#if(window.item_show_type == 10){#>\n                    <#=textPageTitle#>\n                <#}else{#>\n                    <#=window.msg_title.html(1)#>\n                <#}#>\n            </h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言对朋友可见，被公众号筛选后，将对所有人可见。"></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                            <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n                            <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n                        </span>\n                    </div>\n                </span>\n            </div>\n            <div class="emotion_panel" id="js_emotion_panel">\n                <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                    <i class="emotion_panel_arrow arrow_out"></i>\n                    <i class="emotion_panel_arrow arrow_in"></i>\n                </span>\n                <div class="emotion_list_wrp" id="js_slide_wrapper">\n                    \x3c!--<ul class="emotion_list"></ul>--\x3e\n                    \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                </div>\n                <ul class="emotion_navs" id="js_navbar">\n                    \x3c!--<li class="emotion_nav"></li>--\x3e\n                </ul>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">留言</a></div>\n          </div>\n          <div class="discuss_container_bd">\n            <div class="" style="display:none">\n                <div class="mod_title_context">\n                    <strong class="mod_title">我的留言</strong>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="weui-loadmore" id="js_mycmt_loading">\n                <i class="weui-loading"></i>\n                <span class="weui-loadmore__tips">正在加载</span>\n            </div>\n            <div id="js_cmt_toast" style="display: none;">\n                <div class="weui-mask_transparent"></div>\n                <div class="weui-toast">\n                    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n                    <p class="weui-toast__content">已留言</p>\n                </div>\n            </div>\n            <div class="weui-dialog__wrp weui-transition_opacity-hide" id="js_delete_panel_mobile">\n                <div class="weui-mask"></div>\n                <div class="weui-dialog">\n                    <div class="weui-dialog__bd">确定删除留言吗？</div>\n                    <div class="weui-dialog__ft">\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_delete_cancel_mobile">取消</a>\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_delete_confirm_mobile">删除</a>\n                    </div>\n                </div>\n            </div>\n          </div>\n        </div>\n    </div>\n  </div>\n<#}else{#>\n    <div id="js_cmt_mine" class="discuss_container editing access" style="display:none;">\n        <div class="discuss_container_inner">\n            <h2 class="rich_media_title"><#=window.msg_title.html(1)#></h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言对朋友可见，被公众号筛选后，将对所有人可见。"></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                        </span>\n                        <div class="emotion_panel" id="js_emotion_panel">\n                            <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                                <i class="emotion_panel_arrow arrow_out"></i>\n                                <i class="emotion_panel_arrow arrow_in"></i>\n                            </span>\n                            <div class="emotion_list_wrp" id="js_slide_wrapper">\n                                \x3c!--<ul class="emotion_list"></ul>--\x3e\n                                \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                            </div>\n                            <ul class="emotion_navs" id="js_navbar">\n                                \x3c!--<li class="emotion_nav"></li>--\x3e\n                            </ul>\n                        </div>\n                    </div>\n                </span>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">留言</a></div>\n            <div class="discuss_list_wrp" style="display:none">\n                <div class="rich_tips with_line title_tips discuss_title_line">\n                    <span class="tips">我的留言</span>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="rich_tips tips_global loading_tips" id="js_mycmt_loading">\n                <img src="<#=window.icon_loading_white#>" class="rich_icon icon_loading_white" alt="">\n                <span class="tips">加载中</span>\n            </div>\n            <div class="wx_poptips" id="js_cmt_toast" style="display:none;">\n                <img alt="" class="icon_toast" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABqCAYAAABUIcSXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyMTUxMzkxZS1jYWVhLTRmZTMtYTY2NS0xNTRkNDJiOGQyMWIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTA3QzM2RTg3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTA3QzM2RTc3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NWMyOGVjZTMtNzllZS00ODlhLWIxZTYtYzNmM2RjNzg2YjI2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjIxNTEzOTFlLWNhZWEtNGZlMy1hNjY1LTE1NGQ0MmI4ZDIxYiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pmvxj1gAAAVrSURBVHja7J15rF1TFMbXk74q1ZKHGlMkJVIhIgg1FH+YEpEQJCKmGBpThRoSs5jVVNrSQUvEEENIhGiiNf9BiERICCFIRbUiDa2qvudbOetF3Tzv7XWGffa55/uS7593977n3vO7e5+199p7v56BgQGh0tcmvAUERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERVAUQVEERVAUQbVYk+HdvZVG8b5F0xj4RvhouB+eCy8KrdzDJc1RtAX8ILxvx98V1GyCSkN98Cx4z/95/Wn4fj6j6tUEeN4wkFSnw1MJqj5NhBfAuwaUHREUg4lqNMmePVsHll/HFhVfe1t3FwpJI8DXCCquDrCWNN4B6Tb4M3Z98aTPmTvh0YHl18PXw29yZiKejoPvcUD6E74yFBJbVDk6Bb7K8aP/Hb4c/tRzEYIqprPhSxzlf4Uvhb/0Xoig8qnHAJ3lqPMzfDH8XZ4LEpRf2sVdA5/sqPO9Qfop70UJyn+/boaPddT5yrq7VUUvTIVJI7q74MMddXR8NB1eXcYvhBpZm0s2w72/o86HFoKvLau/pYaXzjLMdUJ6y0LwtWV9CIIaXtvA8+G9HHV03u5q+K+yH47U0NoRngPv7KjzHDwTLj0bS1BDazfJJlcnOOostC6ysnCT+q80G/sIvFVgeW09D8FPVT0uoP7VfvAD8NjA8pqmuAN+OcYAjso0RbIZ8DGB5TVNcRO8JMaHY9SXSdfa3eeANJimWBLrA7JFiZwIXye+NMUV8CcxP2SRFjXefok7NRjSGZJlWUPvw2/wtNiQirSoXWyMsR28wR7AzzYM0oXw+Y7yK+CLJGeaoqjyrJSdZJD6Ov4+z5y6NJc0Az7NUecHydIUy+v60KNyQHoM3nKI1y7YCFiq0i7uBvgER52vDdKqWn9djhY1Dn4G3n6Ecqm2rF74dvgoR53S0hQxW9RJAZAGW5bSn58QJA27dQ7uIEedjywEX5NKVxCqsY6y+qA+LxFI4+yZ6oH0trWkNan80jygtIUsc5SflgAsDXgehfdx1KkkTRE76tN+Xue2jnTU0Ru1oIbvpt30bBtKhOp5yaaRkts0lic8V1i6dPcIRx2d/l8Y8XtNNEg7OOo8bl1kmmOKnDsO88CaYzejau0hWZqiL7C83oCH4SeTHvwV2BqqsHRVztSEYOmWF80NeXZT6Hd4KflResE9vCnBOlCyGfDNAstHTVPUDWoQ1t3iW+9WNizvlhfd4aerXd+ThqiMfNR6+9LvOOro5OY5JX2H4+F7HZD+kGzlamMgldWiirQsjcwWFbjmqZJteekJLK9pisvgL6RhKvuciZiwzrWWGapfrPy30kBVcSBIrw0aD3PU0XB6cehntq7rTMf7/2iQlktDVdXJLXlg6VjmiYBn6rWSTRCH6hvJ0hQrpcGq8oidsmHpTP8t8DGO9/vcWt9qabiqPgup1yKyQwvC2tSefZ73SSpNkUJ4PlLorlHZ+446nc8f3fIyywlJhwrTuwVSjBa1ccvSxN0hjjoK5xVrYZMd9V6XbFfgBukixTwGLg8sDam3dZR/wZ6L/dJlin1en8LS+bgpFbz3Ygvzu1J1HKxYNqxGpCmaCEo12rrBorD6LRp8UbpcdR5VWhTW35KlKd6QFqjuM2XzwlpnMxTvSkuUwuG/Xlg6NtPjbT6WFimF/VG6LEvXgn8QGDjMbBukVECFwhpoS+CQatfX2Q1q6H7wENHdrfCr0lKleEB9JyxNneus+VJpsVL9TwI6W65LovWIGl3KtVJaLv7LBwYTFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFFWq/hFgADUMN4RzT6/OAAAAAElFTkSuQmCC">\n                <p class="toast_content">已留言</p>\n            </div>\n        </div>\n    </div>\n<#}#>\n<div class="weui-webview-nav" style="display:none;" id="js_fake_bar">\n    <button class="weui-webview-nav__btn_goback" id="js_cmt_goback">goback</button>\n    <button class="weui-webview-nav__btn_forward weui-webview-nav__btn_disabled" disabled="disabled">forward</button>\n</div>',{}),document.body.appendChild(e))}(),new se.Emotion({emotionPanel:de("#js_emotion_panel"),inputArea:de("#js_cmt_input"),emotionPanelArrowWrp:de("#js_emotion_panel_arrow_wrp"),emotionSwitcher:de("#js_emotion_switch"),emotionSlideWrapper:de("#js_slide_wrapper"),emotionNavBar:de("#js_navbar"),submitBtn:de("#js_cmt_submit")}),navigator.userAgent.toLowerCase().match(/ios/)){let t=navigator.userAgent.toLowerCase().match(/(?:sogousearch\/ios\/)(.*)/);if(t&&t[1]){let i=t[1].replace(/\./g,"");parseInt(i)>422&&e("ios")}}else e("android");function e(e){let t=document.getElementById("js_cover"),i=[];t&&i.push(t);let n=document.getElementById("js_content");if(n){let e=n.getElementsByTagName("img")||[];for(let t=0,n=e.length;t<n;t++)i.push(e.item(t))}let a=[];for(let o=0,s=i.length;o<s;o++){let t=i[o],n=t.getAttribute("data-src")||t.getAttribute("src");n&&(a.push(n),function(i){$e.on(t,"click",(function(t){return"ios"==e?window.JSInvoker&&window.JSInvoker.openImageList&&window.JSInvoker.openImageList(JSON.stringify({index:i,array:a})):window.JSInvoker&&JSInvoker.weixin_openImageList&&window.JSInvoker.weixin_openImageList(JSON.stringify({index:i,array:a})),!1}))}(o))}}window.onerror=function(e){(new Image).src="/mp/jsreport?key=86&content="+e+"&r="+Math.random()}}();setTimeout((function(){const e=function(){Me.setLogs({id:28307,key:49,value:1,lc:1,log0:"[28307_49_appmsg_fe_filter]"+encodeURIComponent(location.href)})},t=(window.appmsg_fe_filter||"").split(","),i=function(t,i){try{if(!t)return;if(t.querySelectorAll){const n=t.querySelectorAll("*["+i+"]");if(n&&n.length>0){e();for(let e=0;e<n.length;++e)n[e]&&n[e].removeAttribute&&n[e].removeAttribute(i)}return}const n=t.childNodes;if(t.hasAttribute&&t.hasAttribute(i)&&e(),t.removeAttribute&&t.removeAttribute(i),n&&n.length)for(let e=0;e<n.length;++e)filterContenteditable(n[e])}catch(vd){}};let n=document.getElementById("js_content");for(let a=0;a<t.length;++a)t[a]&&i(n,t[a])}),0),setTimeout((function(){const e="//mmbiz.qpic.cn/mmbiz_png/7lG1x2vpicdic0p5bBthpD9lsJcINicsSzd6uKQQJyoj5oTl8lFIs9K0fIibgxCzms0enDLTRxTHLpDPCLpSvIExiag/640",t=(new Date).getHours();if(t<11||t>16||Math.random()<.99)return;const i=new Image;i.onload=function(){const e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;640===e&&407===t||window.__addIdKeyReport("28307","wifi"===window.networkType?120:123),window.__addIdKeyReport("28307","wifi"===window.networkType?121:124)},i.src="http:"+e;const n=new Image;n.onload=function(){const e=n.naturalWidth||n.width,t=n.naturalHeight||n.height;640===e&&407===t||window.__addIdKeyReport("28307",126),window.__addIdKeyReport("28307",127)},n.src="https:"+e}),3e3);if(Math.random()<2e-4)try{const e=document.getElementsByTagName("img"),t=window.screen.height,i=window.screen.width,n=window.devicePixelRatio;let a="";for(let o=0,s=e.length;o<s;o++){const s=e[o].getAttribute("data-src");if(s){let r=e[o].getBoundingClientRect();a+=i+"|"+t+"|"+r.left.toFixed(2)+"|"+(i-r.right).toFixed(2)+"|"+r.width.toFixed(2)+"|"+n.toFixed(2)+"|"+s+";"}}Ne({url:"/mp/wapreport?action=img_display_report",data:{key:a},type:"POST",dataType:"json",async:!0})}catch(vd){}setTimeout((function(){en&&en("updatePageHeight")}),2e3),He.isIOS&&location.href.match(/fontScale=\d+/)&&je.isIPadOS13&&setTimeout((function(){if(window.ipados13_font_scale)return;const e=location.href.match(/fontScale=(\d+)/);window.ipados13_font_scale=parseFloat(e[1]),je.setFontSize(document.getElementsByTagName("html").item(0),window.ipados13_font_scale/100)}),500)}(),!window.__second_open__){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e&&e.timing){const t=window.location.protocol;re.saveSpeeds({uin:uin,pid:"https:"==t?462:417,speeds:{sid:34,time:Date.now()-e.timing.navigationStart}}),re.send()}bd={isPaySubscribe:window.isPaySubscribe},window.getWXLongPressImageEventConfig=()=>bd.isPaySubscribe?{forbidForward:1}:{forbidForward:0}}var bd;
